/*!CK:2884842673!*//*1408337184,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["PZp4+"]); }

__d("BroadcastRequestParam",[],function(a,b,c,d,e,f){e.exports={ANSWER_IDS:"answer_ids",BROADCAST_REQUEST_ID:"broadcast_request_id",CHECKED_IDS:"checked_ids",COMMENT_FBID:"comment_fbid",COMMENT_TOKEN:"comment_token",COMPOSER_TOKEN_IDS:"composer_token_ids",DESCRIPTION_DOM_ID:"description_dom_id",DOM_ID:"dom_id",ENTITY_TITLE:"entity_title",ENTITY_TOKEN:"entity_token",ERROR_CODE:"error_code",HAS_VIEWER_VOTED:"has_viewer_voted",QUERIED_RECIPIENTS:"queried_recipients",QUERY:"q",RECIPIENT_IDS:"recipient_ids",SEND_REQUEST:"send_request",SOURCE:"source",SOURCE_OBJ_ID:"source_obj_id",SUGGESTION_CARD_ID:"suggestion_card_id",SUGGESTION_ID:"suggestion_id",SUGGESTION_IDS:"add_suggestions_ids",SUGGESTION_ROW_ID:"suggestion_row_id",TARGET_ID:"target_id",VOTE_ACTION:"vote_action",EXISTING_IDS:"existing_ids",VALUE:"value",BROADCAST_REQUEST_TYPE:"broadcast_request_type",COMPOSER_TEXT:"composer_text"};},null);
__d("ClickPointIdentifiersDEPRECATED",[],function(a,b,c,d,e,f){var g={types:{TIMELINE_SEE_LIKERS:'timeline:seelikes'},getUserActionID:function(h){return '{"ua_id":"'+h+'"}';}};e.exports=g;},null);
__d("NumberFormat",["NumberFormatConfig"],function(a,b,c,d,e,f,g){var h=/(\d{3})(?=\d)/g;function i(l){return (''+l).split('').reverse().join('');}function j(l,m){if(Math.abs(l).toString().length<g.minDigitsForThousandsSeparator)return l.toString();var n=i(l);return i(n.replace(h,'$1'+m));}var k={formatIntegerWithDelimiter:j,formatInteger:function(l){return j(l,g.numberDelimiter);}};e.exports=k;},null);
__d("UFIBlingItem.react",["React","NumberFormat","cx","fbt","joinClasses"],function(a,b,c,d,e,f,g,h,i,j,k){var l=g.createClass({displayName:'UFIBlingItem',propTypes:{contextArgs:g.PropTypes.object.isRequired,count:g.PropTypes.number.isRequired,allowText:g.PropTypes.bool,className:g.PropTypes.string,iconClassName:g.PropTypes.string,itemKey:g.PropTypes.string},render:function(){var m=k(this.props.className,this.props.iconClassName,"UFIBlingBoxSprite"),n=h.formatIntegerWithDelimiter(this.props.count,this.props.contextArgs.numberdelimiter||','),o='';if(this.props.allowText)switch(this.props.itemKey){case 'reshare':if(this.props.contextArgs.reshareedu)o=this.props.count===1?' Share':' Shares';break;}return (g.createElement(g.DOM.span,null,g.createElement(g.DOM.i,{className:m}),g.createElement(g.DOM.span,{className:"UFIBlingBoxText"},j._({"":"{count}"," Share":"{count} Share"," Shares":"{count} Shares"},[j.param("count",n),j['enum'](o,{"":""," Share":" Share"," Shares":" Shares"})]))));}});e.exports=l;},null);
__d("UFIBlingBox.react",["React","UFIBlingItem.react","UFIConstants","cx","fbt","tx","FeedNFBConstants"],function(a,b,c,d,e,f,g,h,i,j,k,l){var m=b('FeedNFBConstants').data,n=g.createClass({displayName:'UFIBlingBox',propTypes:{contextArgs:g.PropTypes.object.isRequired,'data-ft':g.PropTypes.string,comments:g.PropTypes.number,likes:g.PropTypes.number,nfb:g.PropTypes.number,onClick:g.PropTypes.func,permalink:g.PropTypes.string,reshares:g.PropTypes.number},render:function(){var o=[],p='';if(this.props.likes){o.push(g.createElement(h,{className:((o.length>0?"mls":'')),contextArgs:this.props.contextArgs,count:this.props.likes,iconClassName:"UFIBlingBoxLikeIcon",itemKey:"like",key:"like"}));p+=(this.props.likes==1)?"1 like":l._("{count} likes",{count:this.props.likes});p+=' ';}if(this.props.comments){o.push(g.createElement(h,{className:((o.length>0?"mls":'')),contextArgs:this.props.contextArgs,count:this.props.comments,iconClassName:"UFIBlingBoxCommentIcon",itemKey:"comment",key:"comment"}));p+=(this.props.comments==1)?"1 comment":l._("{count} comments",{count:this.props.comments});p+=' ';}if(this.props.reshares){o.push(g.createElement(h,{className:((o.length>0?"mls":'')),contextArgs:this.props.contextArgs,count:this.props.reshares,iconClassName:"UFIBlingBoxReshareIcon",itemKey:"reshare",key:"reshare"}));p+=(this.props.reshares==1)?"1 share":l._("{count} shares",{count:this.props.reshares});}if(this.props.nfb&&m){o.push(g.createElement(h,{className:((o.length>0?"mls":'')),contextArgs:this.props.contextArgs,count:this.props.nfb,iconClassName:"_1ufb",itemKey:"nfb",key:"nfb"}));p+=(this.props.nfb==1)?k._("{nfb text}",[k.param("nfb text",m.ONE_NFB)]):k._("{nfb count}{nfb text}",[k.param("nfb count",this.props.nfb),k.param("nfb text",m.MULT_NFB)]);p+=' ';}var q=g.createElement(g.DOM.a,{className:"UFIBlingBox uiBlingBox feedbackBling",href:this.props.permalink,'data-ft':this.props['data-ft'],'aria-label':p},o);if(this.props.comments>i.defaultPageSize)return q;q.props.onClick=this.props.onClick;q.props.rel='ignore';return q;}});e.exports=n;},null);
__d("UFILikeLink.react",["AccessibilityLogger","React","TrackingNodes","tx"],function(a,b,c,d,e,f,g,h,i,j){var k=h.createClass({displayName:'UFILikeLink',propTypes:{likeAction:h.PropTypes.bool,onClick:h.PropTypes.func},_handleClick:function(event){g.logLikeEnterPress();if(this.props.onClick)this.props.onClick(event);},render:function(){var l=this.props.likeAction?"Like":"Unlike",m=i.getTrackingInfo(this.props.likeAction?i.types.LIKE_LINK:i.types.UNLIKE_LINK),n=this.props.likeAction?"Like this":"Unlike this";return (h.createElement(h.DOM.span,null,h.createElement(h.DOM.a,{className:"UFILikeLink accessible_elem",href:"#",role:"button",'aria-live':"polite",title:n,onClick:this._handleClick},l),h.createElement(h.DOM.a,{className:"UFILikeLink",href:"#",role:"button",'aria-live':"polite",title:n,onClick:this.props.onClick,'data-ft':m},l)));}});e.exports=k;},null);
__d("UFIShareLink.react",["React","TrackingNodes","fbt"],function(a,b,c,d,e,f,g,h,i){var j=g.createClass({displayName:'UFIShareLink',propTypes:{href:g.PropTypes.oneOfType([g.PropTypes.object,g.PropTypes.string]).isRequired},render:function(){var k="Send this to friends or post it on your timeline.",l='{ "tn": "'+h.encodeTN(h.types.SHARE_LINK)+'", "type": 25 }';return (g.createElement(g.DOM.a,{className:"share_action_link",'data-ft':l,href:this.props.href,rel:"dialog",title:k},"Share"));}});e.exports=j;},null);
__d("UFISubscribeLink.react",["React","fbt"],function(a,b,c,d,e,f,g,h){var i=g.createClass({displayName:'UFISubscribeLink',propTypes:{subscribeAction:g.PropTypes.bool,onClick:g.PropTypes.func},render:function(){var j=this.props.subscribeAction?"Get Notifications":"Stop Notifications",k=this.props.subscribeAction?"Get a notification whenever someone comments.":"Stop getting notifications when someone comments.";return (g.createElement(g.DOM.a,{className:"UFISubscribeLink",href:"#",role:"button",'aria-live':"polite",title:k,onClick:this.props.onClick},j));}});e.exports=i;},null);
__d("ProfileBrowserLink",["URI"],function(a,b,c,d,e,f,g){var h='/ajax/browser/dialog/',i='/browse/',j=function(l,m,n){return new g(l+m).setQueryData(n);},k={constructPageURI:function(l,m){return j(i,l,m);},constructDialogURI:function(l,m){return j(h,l,m);}};e.exports=k;},null);
__d("ProfileBrowserTypes",[],function(a,b,c,d,e,f){var g={LIKES:'likes',GROUP_MESSAGE_VIEWERS:'group_message_viewers',MUTUAL_FRIENDS:'mutual_friends',TODO_LIST_ASSIGNEES:'todo_list_assignees'};e.exports=g;},null);
__d("UFITimelineBlingBox.react",["ProfileBrowserLink","ProfileBrowserTypes","React","UFIBlingItem.react","URI","cx","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){var n=i.createClass({displayName:'UFITimelineBlingBox',propTypes:{contextArgs:i.PropTypes.object.isRequired,'data-ft':i.PropTypes.string,'data-gt':i.PropTypes.string,actorid:i.PropTypes.any,commentOnClick:i.PropTypes.func,comments:i.PropTypes.number,enableShowComments:i.PropTypes.bool,enableShowLikes:i.PropTypes.bool,feedbackFBID:i.PropTypes.any,likes:i.PropTypes.number,reshares:i.PropTypes.number},render:function(){var o=[];if(this.props.likes&&this.props.enableShowLikes){var p=this._getProfileBrowserURI(),q="See who likes this",r=i.createElement(i.DOM.a,{ajaxify:p.dialog,className:this._getItemClassName(o),'data-ft':this.props['data-ft'],'data-gt':this.props['data-gt'],'data-hover':"tooltip",'data-tooltip-alignh':"right",'data-tooltip-uri':this._getLikeToolTipURI(),href:p.page,key:"like",rel:"dialog",role:"button",title:q},i.createElement(j,{contextArgs:this.props.contextArgs,count:this.props.likes,iconClassName:"UFIBlingBoxTimelineLikeIcon",itemKey:"like"}));o.push(r);}if(this.props.comments&&this.props.enableShowComments){var s="Show comments",t=i.createElement(i.DOM.a,{'aria-label':s,className:this._getItemClassName(o),'data-ft':this.props['data-ft'],'data-hover':"tooltip",'data-tooltip-alignh':"right",href:"#",key:"comment",onClick:this.props.commentOnClick},i.createElement(j,{contextArgs:this.props.contextArgs,count:this.props.comments,iconClassName:"UFIBlingBoxTimelineCommentIcon",itemKey:"comment"}));o.push(t);}if(this.props.reshares){var u="Show shares",v=this._getShareViewURI(),w=i.createElement(i.DOM.a,{ajaxify:v.dialog,'aria-label':u,className:this._getItemClassName(o),'data-ft':this.props['data-ft'],'data-hover':"tooltip",'data-tooltip-alignh':"right",href:v.page,key:"reshare",rel:"async"},i.createElement(j,{allowText:true,contextArgs:this.props.contextArgs,count:this.props.reshares,iconClassName:"UFIBlingBoxTimelineReshareIcon",itemKey:"reshare"}));o.push(w);}return (i.createElement(i.DOM.span,null,o));},_getItemClassName:function(o){return ((o.length>0?"mls":'')+(' '+"UFIBlingBoxTimelineItem"));},_getLikeToolTipURI:function(){if(this.props.feedbackFBID){var o=new k('/ajax/like/tooltip.php').setQueryData({comment_fbid:this.props.feedbackFBID});return o.toString();}else return null;},_getProfileBrowserURI:function(){if(this.props.feedbackFBID){var o=h.LIKES,p={id:this.props.feedbackFBID,actorid:this.props.actorid},q=g.constructDialogURI(o,p),r=g.constructPageURI(o,p),s={dialog:q.toString(),page:r.toString()};return s;}},_getShareViewURI:function(){if(this.props.feedbackFBID){var o=new k('/ajax/shares/view').setQueryData({target_fbid:this.props.feedbackFBID}),p=new k('/shares/view').setSubdomain('www').setQueryData({id:this.props.feedbackFBID}),q={dialog:o.toString(),page:p.toString()};return q;}}});e.exports=n;},null);
__d("UFICommentList",["ClientIDs","KeyedCallbackManager","UFICentralUpdates","UFIConstants","UFIFeedbackTargets","keyMirror"],function(a,b,c,d,e,f,g,h,i,j,k,l){"use strict";var m=l({actorID:true});function n(o){this.count=0;this.deletedComments={};this.deletedCount=0;this.dataSource=new h();this.feedbackTargetID=o;this.lastRequestedOffset=0;this.lastRequestedLength=0;this.basePermalink="";this.commentPermalinks={};this.orderReversed=false;k.getFeedbackTarget(this.feedbackTargetID,function(p){this.actorID=p.actorforpost;this.basePermalink=p.permalink;this.orderReversed=p.isranked;}.bind(this));}n.prototype.addComment=function(o,p,q){var r=p&&g.isExistingClientID(p),s=this.dataSource.getAllResources(),t={};for(var u in s){var v=s[u];t[v]=u;}if(r&&p in t){t[o]=t[p];var w=t[p];this.dataSource.setResource(w,o);}else if(!t[o]){var x=this.count;this.count++;t[o]=x;this.dataSource.setResource(x,o);}if(q)this.commentPermalinks[o]=this.buildCommentPermalink(o,q,t[o]);i.didUpdateFeedback(this.feedbackTargetID);};n.prototype.addCommentIDs=function(o,p,q){var r={};for(var s=0;s<p;s++)r[o+s]=q[s]||j.unavailableCommentKey;this.dataSource.addResourcesAndExecute(r);i.didUpdateFeedback(this.feedbackTargetID);return this;};n.prototype.getComments=function(o,p,q,r){var s=[];for(var t=0;t<p;t++)s.push(o+t);var u=this.dataSource.getUnavailableResourcesFromRequest(s);if(u.length){var v=Math.min.apply(Math,u),w=Math.max.apply(Math,u),x=v,y=w-v+1;if(x<this.lastRequestedOffset||(x+y)>(this.lastRequestedOffset+this.lastRequestedLength)){this.lastRequestedOffset=x;this.lastRequestedLength=y;this.fetchComments(x,y,q);}}else this.dataSource.deferredExecuteOrEnqueue(s).addCallback(this.deferredCallback.bind(this,o,p,r));};n.prototype.fetchComments=function(o,p,q){};n.prototype.deferredCallback=function(o,p,q,r){};n.prototype.reset=function(){var o=this.dataSource.getAllResources();this.dataSource.reset();this.count=0;this.deletedCount=0;this.deletedComments={};this.lastRequestedOffset=0;this.lastRequestedLength=0;return o;};n.prototype.deleteComment=function(o){if(!(o in this.deletedComments)){this.deletedComments[o]=true;this.deletedCount++;}};n.prototype.updateCommentCount=function(o){this.count=o;this.deletedCount=0;return this;};n.prototype.getFeedbackTargetID=function(){return this.feedbackTargetID;};n.prototype.getCommentCount=function(){return this.count;};n.prototype.getDeletedCount=function(){return this.deletedCount;};n.prototype.getDisplayedCommentCount=function(){return this.count-this.deletedCount;};n.prototype.getBasePermalink=function(){return this.basePermalink;};n.prototype.buildCommentPermalink=function(o,p,q){};n.prototype.getPermalinkForComment=function(o){return this.commentPermalinks[o];};n.isValidContextPropertyForReset=function(o){return o in m;};e.exports=n;},null);
__d("UFIInstanceState",["UFICentralUpdates"],function(a,b,c,d,e,f,g){var h={};function i(k){if(!h[k])h[k]={};}var j={getKeyForInstance:function(k,l){i(k);return h[k][l];},updateState:function(k,l,m){i(k);h[k][l]=m;g.didUpdateInstanceState(k,l);},updateStateField:function(k,l,m,n){var o=this.getKeyForInstance(k,l)||{};o[m]=n;this.updateState(k,l,o);}};e.exports=j;},null);
__d("UFIComments",["ClientIDs","ImmutableObject","UFICentralUpdates","UFIConstants","UFIInstanceState","invariant","merge","randomInt"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){"use strict";var o={},p={};function q(fa){return fa in p?p[fa]:fa;}function r(fa,ga){fa.forEach(function(ha){var ia=ha.ftentidentifier,ja=j.UFIPayloadSourceType,ka=ha.clientid,la=false,ma=m({},ha);if(ka){delete ma.clientid;la=g.isExistingClientID(ka);if(la&&p[ka])return;}if((ga===ja.LIVE_SEND)||(ga===ja.USER_ACTION)||(ga===ja.ENDPOINT_ADD_COMMENT)||(ga===ja.ENDPOINT_EDIT_COMMENT))ma.isunseen=true;if(ga===ja.ENDPOINT_COMMENT_FETCH||ga===ja.ENDPOINT_ID_COMMENT_FETCH)ma.fromfetch=true;if(la){if(o[ka].ufiinstanceid)k.updateStateField(o[ka].ufiinstanceid,'locallycomposed',ha.id,true);ma.ufiinstanceid=o[ka].ufiinstanceid;p[ka]=ha.id;o[ha.id]=o[ka];delete o[ka];i.didUpdateComment(ka);}ea.setComment(ha.id,new h(ma));i.didUpdateComment(ha.id);i.didUpdateFeedback(ia);});}function s(fa){for(var ga=0;ga<fa.length;ga++){var ha=fa[ga];switch(ha.actiontype){case j.UFIActionType.COMMENT_LIKE:t(ha);break;case j.UFIActionType.DELETE_COMMENT:x(ha);break;case j.UFIActionType.LIVE_DELETE_COMMENT:y(ha);break;case j.UFIActionType.REMOVE_PREVIEW:z(ha);break;case j.UFIActionType.COMMENT_SET_SPAM:aa(ha);break;case j.UFIActionType.CONFIRM_COMMENT_REMOVAL:ba(ha);break;case j.UFIActionType.TRANSLATE_COMMENT:v(ha);break;case j.UFIActionType.COMMENT_LIKECOUNT_UPDATE:u(ha);break;}}}function t(fa){var ga=ea.getComment(fa.commentid);if(ga){var ha={},ia=fa.clientid&&g.isExistingClientID(fa.clientid);if(!ia){ha.hasviewerliked=fa.viewerliked;ha.likecount=fa.likecount;}ha.likeconfirmhash=n(0,1024);da(fa.commentid,ha);}}function u(fa){var ga=ea.getComment(fa.commentid);if(ga&&fa.hasviewerliked===ga.hasviewerliked){var ha={likecount:fa.likecount,likeconfirmhash:n(0,1024)};da(fa.commentid,ha);}}function v(fa){var ga=fa.commentid,ha=ea.getComment(fa.commentid);if(ha)da(ga,{translatedtext:fa.translatedtext});}function w(fa){var ga={reportLink:fa.reportLink,commenterIsFOF:fa.commenterIsFOF,userIsMinor:fa.userIsMinor,giveFeedbackLink:fa.giveFeedbackLink};return ga;}function x(fa){var ga=ea.getComment(fa.commentid);ca(ga,j.UFIStatus.DELETED);}function y(fa){var ga=ea.getComment(fa.commentid);if(ga&&ga.status!==j.UFIStatus.DELETED)ca(ga,j.UFIStatus.LIVE_DELETED);}function z(fa){da(fa.commentid,{attachment:null});}function aa(fa){var ga=ea.getComment(fa.commentid),ha=fa.shouldHideAsSpam?j.UFIStatus.SPAM_DISPLAY:null;ca(ga,ha);}function ba(fa){da(fa.commentid,w(fa));}function ca(fa,ga){da(fa.id,{priorstatus:fa.status,status:ga});}function da(fa,ga){var ha=ea.getComment(fa)||new h({});ea.setComment(fa,h.set(ha,ga));i.didUpdateComment(ha.id);i.didUpdateFeedback(ha.ftentidentifier);}var ea={getComment:function(fa){if(fa===j.unavailableCommentKey)return null;return o[q(fa)];},setComment:function(fa,ga){l(ga instanceof h);o[q(fa)]=ga;},resetComments:function(fa){for(var ga in fa)delete o[q(ga)];}};i.subscribe('update-comments',function(fa,ga){if(ga.comments&&ga.comments.length)r(ga.comments,ga.payloadsource);});i.subscribe('update-actions',function(fa,ga){if(ga.actions&&ga.actions.length)s(ga.actions);});e.exports=ea;},null);
__d("UFIToplevelCommentList",["ActorURI","MercuryServerDispatcher","UFICentralUpdates","UFICommentList","UFIComments","UFIConstants","UFIReplyCommentList","URI"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){"use strict";var o={};for(var p in j)if(j.hasOwnProperty(p))r[p]=j[p];var q=j===null?null:j.prototype;r.prototype=Object.create(q);r.prototype.constructor=r;r.__superConstructor__=j;r.getCommentList=function(t,u){if(!o[t])o[t]={};if(!o[t][u]){var v=new r(t,u),w=r.getCommentListsForFeedbackTargetID(t);if(w.length)v.updateCommentCount(w[0].getCommentCount());o[t][u]=v;}return o[t][u];};r.getCommentListsForFeedbackTargetID=function(t){var u=[],v=o[t]||{};for(var w in v)u.push(v[w]);return u;};r.getCommentListForFeedbackTargetID_UNSAFE=function(t){var u=r.getCommentListsForFeedbackTargetID(t);return u.length?u[0]:null;};r.resetCommentListsForFeedbackTargetID=function(t){if(!o[t])return;var u={};for(var v in o[t]){var w=o[t][v],x=w.reset();for(var y in x){var z=x[y];u[z]=true;}}k.resetComments(u);};r.resetCommentListsWithContext=function(t,u){if(!o[t])return;var v={};for(var w in o[t]){var x=o[t][w];for(var y in u)if(this.isValidContextPropertyForReset(y))x[y]=u[y];var z=x.reset();for(var aa in z){var ba=z[aa];v[ba]=true;m.resetWithContext(t,ba,u);}}k.resetComments(v);};function r(t,u){j.call(this,t);this.orderingMode=u;}r.prototype.fetchComments=function(t,u,v){var w={ft_ent_identifier:this.feedbackTargetID,viewas:v,source:null,offset:t,length:u,orderingmode:this.orderingMode};if(!v)w[g.PARAMETER_ACTOR]=this.actorID;h.trySend('/ajax/ufi/comment_fetch.php',w);};r.prototype.deferredCallback=function(t,u,v,w){var x={},y=t,z=t+u-1;for(var aa=0;aa<u;aa++){var ba=this.orderReversed?z-aa:y+aa,ca=k.getComment(w[ba]);if(ca)x[t+aa]=ca;}v(x);};r.prototype.getOrderingMode=function(){return this.orderingMode;};r.prototype.buildCommentPermalink=function(t,u,v){if(!this.basePermalink)return null;var w=Math.floor((this.count-v-1)/l.defaultPageSize)*l.defaultPageSize;return (n(this.basePermalink).addQueryData({comment_id:u,offset:w,total_comments:this.count}).toString());};h.registerEndpoints({'/ajax/ufi/comment_fetch.php':{mode:h.IMMEDIATE}});function s(t){var u=k.getComment(t.commentid),v=u.id,w=u.ftentidentifier,x=u.parentcommentid;if(x)return;if(u.status!==l.UFIStatus.DELETED&&u.status!==l.UFIStatus.FAILED_ADD)r.getCommentListsForFeedbackTargetID(w).forEach(function(y){y.deleteComment(v);});}i.subscribe('update-actions',function(t,u){if(u.actions&&u.actions.length)for(var v=0;v<u.actions.length;v++){var w=u.actions[v];switch(w.actiontype){case l.UFIActionType.DELETE_COMMENT:s(w);break;}}});i.subscribe('update-comment-lists',function(t,u){var v=u.commentlists;if(v&&v.comments&&Object.keys(v).length)for(var w in v.comments)for(var x in v.comments[w]){var y=v.comments[w][x];r.getCommentList(w,x).addCommentIDs(y.range.offset,y.range.length,y.values);}});i.subscribe('update-comments',function(t,u){if(u.comments&&u.comments.length)u.comments.forEach(function(v){if(v.parentcommentid)return;var w=v.ftentidentifier;r.getCommentListsForFeedbackTargetID(w).forEach(function(x){x.addComment(v.id,v.clientid,v.legacyid);});});});i.subscribe('update-feedback',function(t,u){if(u.feedbacktargets&&u.feedbacktargets.length)u.feedbacktargets.forEach(function(v){var w=v.entidentifier,x=v.defaultcommentorderingmode,y={};if(x)y[x]=true;if(v.orderingmodes)v.orderingmodes.forEach(function(aa){y[aa.value]=true;});for(var z in y)r.getCommentList(w,z).updateCommentCount(v.commentcount);});});e.exports=r;},null);
__d("XBroadcastRequestAddComposerTokenAsyncControllerURIBuilder",["XControllerURIBuilder"],function(a,b,c,d,e,f){e.exports=b("XControllerURIBuilder").create("\/profile\/broadcast_request\/async\/add_composer_token\/",{comment_token:{type:"String"},source_obj_id:{type:"Int"}});},null);
__d("UFIUserActions",["ActorURI","AsyncResponse","BroadcastRequestParam","CLoggerX","ClientIDs","ImmutableObject","Nectar","UFICentralUpdates","UFIToplevelCommentList","UFIComments","UFIConstants","UFIFeedbackTargets","MercuryServerDispatcher","XBroadcastRequestAddComposerTokenAsyncControllerURIBuilder","collectDataAttributes","copyProperties","tx","UnicodeBidi","Arbiter"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y){var z={BAN:'ban',UNDO_BAN:'undo_ban'},aa={changeActor:function(na,oa){r.getFeedbackTarget(na,function(pa){o.resetCommentListsWithContext(na,{actorID:oa});var qa={from_actor_id:pa.actorforpost,ft_ent_identifier:na};qa[g.PARAMETER_ACTOR]=oa;s.trySend('/ajax/ufi/actor_change.php',qa);});},changeCommentLike:function(na,oa,pa){var qa=p.getComment(na);if(qa.hasviewerliked!=oa){var ra=ba(pa.target),sa=oa?1:-1,ta={commentid:na,actiontype:q.UFIActionType.COMMENT_LIKE,viewerliked:oa,likecount:qa.likecount+sa};n.handleUpdate(q.UFIPayloadSourceType.USER_ACTION,{actions:[ta]});r.getFeedbackTarget(qa.ftentidentifier,function(ua){var va={};va[g.PARAMETER_ACTOR]=ua.actorforpost;s.trySend('/ajax/ufi/comment_like.php',v({comment_id:na,legacy_id:qa.legacyid,like_action:oa,ft_ent_identifier:qa.ftentidentifier,source:pa.source,client_id:k.getNewClientID()},ra,va));});}},changeAlsoRecommend:function(na,oa){var pa=p.getComment(na.id);if(pa.hasviewerrecommended!==oa){var qa={};qa[i.COMMENT_TOKEN]=na.id;qa[i.SOURCE_OBJ_ID]=na.ftentidentifier;s.trySend(new t().getURI(),qa);}},addComment:function(na,oa,pa,qa){r.getFeedbackTarget(na,function(ra){var sa=ba(qa.target),ta=k.getNewClientID();if(!ra.actorforpost)return;var ua=x.isDirectionLTR(oa)?'ltr':'rtl',va={ftentidentifier:na,body:{text:oa,dir:ua},author:ra.actorforpost,id:ta,islocal:true,ufiinstanceid:qa.ufiinstanceid,likecount:0,hasviewerliked:false,parentcommentid:qa.replyid,attachment:qa.attachedsticker,photo_comment:qa.attachedphoto,timestamp:{time:Date.now(),text:"a few seconds ago"}},wa={actiontype:q.UFIActionType.SUBSCRIBE_ACTION,actorid:ra.actorforpost,hasviewersubscribed:true,entidentifier:na};n.handleUpdate(q.UFIPayloadSourceType.USER_ACTION,{comments:[va],actions:[wa]});var xa=null;if(qa.replyid)xa=(p.getComment(qa.replyid)).fbid;var ya=j.getCLParamsForTarget(qa.target,xa),za={};y.inform('fbFeedToggleFollowMenu',ra.targetfbid);za[g.PARAMETER_ACTOR]=ra.actorforpost;s.trySend('/ajax/ufi/add_comment.php',v({ft_ent_identifier:ra.entidentifier,comment_text:pa,source:qa.source,client_id:ta,reply_fbid:xa,parent_comment_id:qa.replyid,timeline_log_data:qa.timelinelogdata,rootid:qa.rootid,clp:ya,attached_sticker_fbid:qa.attachedsticker?qa.attachedsticker.fbid:0,attached_photo_fbid:qa.attachedphoto?qa.attachedphoto.fbid:0,giftoccasion:qa.giftoccasion,recommendation_ids:qa.recommendationIDs?qa.recommendationIDs:[]},sa,za));});},_hasCommentTextChanged:function(na,oa){return na.body&&na.body.text!=oa;},_hasCommentPhotoChanged:function(na,oa){return ((na||oa)&&!(na&&oa))||(na&&oa&&(na.fbid!=oa.fbid));},_hasCommentStickerChanged:function(na,oa){return ((na||oa)&&!(na&&oa))||(na&&(na.type=="sticker")&&oa&&(na.fbid!=oa.fbid));},editComment:function(na,oa,pa,qa){var ra=ba(qa.target),sa=p.getComment(na),ta=this._hasCommentTextChanged(sa,oa)||this._hasCommentPhotoChanged(sa.photo_comment,qa.attachedPhoto)||this._hasCommentStickerChanged(sa.attachment,qa.attachedSticker);sa=l.set(sa,{status:q.UFIStatus.PENDING_EDIT,body:{text:oa},editnux:null,attachment:qa.attachedSticker,photo_comment:qa.attachedPhoto});if(ta)sa=l.set(sa,{originalTimestamp:sa.timestamp.time,timestamp:{time:Date.now(),text:"a few seconds ago"}});n.handleUpdate(q.UFIPayloadSourceType.USER_ACTION,{comments:[sa]});r.getFeedbackTarget(sa.ftentidentifier,function(ua){var va={};va[g.PARAMETER_ACTOR]=ua.actorforpost;s.trySend('/ajax/ufi/edit_comment.php',v({ft_ent_identifier:sa.ftentidentifier,comment_text:pa,source:qa.source,comment_id:sa.id,parent_comment_id:sa.parentcommentid,attached_sticker_fbid:qa.attachedSticker?qa.attachedSticker.fbid:0,attached_photo_fbid:qa.attachedPhoto?qa.attachedPhoto.fbid:0},ra,va));});},translateComment:function(na,oa){s.trySend('/ajax/ufi/translate_comment.php',{ft_ent_identifier:na.ftentidentifier,comment_ids:[na.id],source:oa.source});},setHideAsSpam:function(na,oa,pa){var qa=ba(pa.target),ra=p.getComment(na),sa={commentid:na,actiontype:q.UFIActionType.COMMENT_SET_SPAM,shouldHideAsSpam:oa};n.handleUpdate(q.UFIPayloadSourceType.USER_ACTION,{actions:[sa]});s.trySend('/ajax/ufi/comment_spam.php',v({comment_id:na,spam_action:oa,ft_ent_identifier:ra.ftentidentifier,source:pa.source},qa));},removeComment:function(na,oa){var pa=ba(oa.target),qa=p.getComment(na),ra={actiontype:q.UFIActionType.DELETE_COMMENT,commentid:na,oneclick:oa.oneclick};n.handleUpdate(q.UFIPayloadSourceType.USER_ACTION,{actions:[ra]});r.getFeedbackTarget(qa.ftentidentifier,function(sa){var ta={};ta[g.PARAMETER_ACTOR]=sa.actorforpost;s.trySend('/ajax/ufi/delete_comment.php',v({comment_id:qa.id,comment_legacyid:qa.legacyid,ft_ent_identifier:qa.ftentidentifier,one_click:oa.oneclick,source:oa.source,client_id:k.getNewClientID(),timeline_log_data:oa.timelinelogdata},pa,ta));});},banUser:function(na,oa,pa,qa){var ra=pa?z.BAN:z.UNDO_BAN;s.trySend('/ajax/ufi/ban_user.php',{page_id:oa,commenter_id:na.author,action:ra,comment_id:na.id,client_side:true});},changeLike:function(na,oa,pa){r.getFeedbackTarget(na,function(qa){var ra=ba(pa.target);if(qa.hasviewerliked!==oa){var sa=oa?1:-1,ta={actiontype:q.UFIActionType.LIKE_ACTION,actorid:qa.actorforpost,hasviewerliked:oa,likecount:qa.likecount+sa,entidentifier:na,likesentences:{current:qa.likesentences.alternate,alternate:qa.likesentences.current}};n.handleUpdate(q.UFIPayloadSourceType.USER_ACTION,{actions:[ta]});var ua={};ua[g.PARAMETER_ACTOR]=qa.actorforpost;s.trySend('/ajax/ufi/like.php',v({like_action:oa,ft_ent_identifier:na,source:pa.source,client_id:k.getNewClientID(),rootid:pa.rootid,giftoccasion:pa.giftoccasion},ra,ua));}});},changeSubscribe:function(na,oa,pa){r.getFeedbackTarget(na,function(qa){var ra=ba(pa.target);if(qa.hasviewersubscribed!==oa){var sa={actiontype:q.UFIActionType.SUBSCRIBE_ACTION,actorid:qa.actorforpost,hasviewersubscribed:oa,entidentifier:na};n.handleUpdate(q.UFIPayloadSourceType.USER_ACTION,{actions:[sa]});var ta={};ta[g.PARAMETER_ACTOR]=qa.actorforpost;s.trySend('/ajax/ufi/subscribe.php',v({subscribe_action:oa,ft_ent_identifier:na,source:pa.source,client_id:k.getNewClientID(),rootid:pa.rootid,comment_expand_mode:pa.commentexpandmode},ra,ta));}});},fetchSpamComments:function(na,oa,pa,qa){s.trySend('/ajax/ufi/id_comment_fetch.php',{ft_ent_identifier:na,viewas:qa,comment_ids:oa,parent_comment_id:pa,source:null});},removePreview:function(na,oa){var pa=ba(oa.target),qa={commentid:na.id,actiontype:q.UFIActionType.REMOVE_PREVIEW};n.handleUpdate(q.UFIPayloadSourceType.USER_ACTION,{actions:[qa]});s.trySend('/ajax/ufi/remove_preview.php',v({comment_id:na.id,ft_ent_identifier:na.ftentidentifier,source:oa.source},pa));}};function ba(na){if(!na)return {ft:{}};var oa={ft:u(na,['ft']).ft};m.addModuleData(oa,na);return oa;}function ca(na){var oa=na.request.data;if(!na.isBlockedAction())h.defaultErrorHandler(na);var pa=oa.client_id||oa.comment_id,qa=p.getComment(pa),ra=(qa.status===q.UFIStatus.PENDING_EDIT)?q.UFIStatus.FAILED_EDIT:q.UFIStatus.FAILED_ADD;qa=l.setDeep(qa,{status:ra,allowRetry:da(na),body:{mentionstext:oa.comment_text,mentionsphoto:qa.photo_comment}});n.handleUpdate(q.UFIPayloadSourceType.USER_ACTION,{comments:[qa]});}function da(na){var oa=na.getError();if(na.isBlockedAction())return false;if(na.silentError)return true;if(oa===1357012||oa===1357006)return false;return true;}function ea(na){var oa=na.request.data,pa=oa.comment_id,qa=p.getComment(pa);qa=l.set(qa,{status:qa.priorstatus||null,priorstatus:undefined});n.handleUpdate(q.UFIPayloadSourceType.USER_ACTION,{comments:[qa]});}function fa(na){var oa=na.request.data,pa=oa.comment_id,qa=p.getComment(pa);if(oa.like_action===qa.hasviewerliked){var ra=qa.hasviewerliked?-1:1,sa={commentid:pa,actiontype:q.UFIActionType.COMMENT_LIKE,viewerliked:!qa.hasviewerliked,likecount:qa.likecount+ra};n.handleUpdate(q.UFIPayloadSourceType.USER_ACTION,{actions:[sa]});}h.defaultErrorHandler(na);}function ga(na){var oa=na.request.data,pa=oa.ft_ent_identifier;r.getFeedbackTarget(pa,function(qa){if(qa.hasviewerliked===oa.like_action){var ra=qa.hasviewerliked?-1:1,sa={actiontype:q.UFIActionType.LIKE_ACTION,actorid:qa.actorforpost,hasviewerliked:!qa.hasviewerliked,likecount:qa.likecount+ra,entidentifier:pa,likesentences:{current:qa.likesentences.alternate,alternate:qa.likesentences.current}};n.handleUpdate(q.UFIPayloadSourceType.USER_ACTION,{actions:[sa]});}});h.defaultErrorHandler(na);}function ha(na){var oa=na.request.data,pa=oa.ft_ent_identifier;r.getFeedbackTarget(pa,function(qa){if(qa.hasviewersubscribed===oa.subscribe_action){var ra={actiontype:q.UFIActionType.SUBSCRIBE_ACTION,actorid:qa.actorforpost,hasviewersubscribed:!qa.hasviewersubscribed,entidentifier:pa};n.handleUpdate(q.UFIPayloadSourceType.USER_ACTION,{actions:[ra]});}});h.defaultErrorHandler(na);}var ia={'/ajax/ufi/actor_change.php':{mode:s.IMMEDIATE},'/ajax/ufi/comment_like.php':{mode:s.BATCH_CONDITIONAL,error_handler:fa,batch_if:ja,batch_function:ma},'/ajax/ufi/comment_spam.php':{mode:s.IMMEDIATE,error_handler:ea},'/ajax/ufi/add_comment.php':{mode:s.IMMEDIATE,error_handler:ca},'/ajax/ufi/delete_comment.php':{mode:s.IMMEDIATE,error_handler:ea},'/ajax/ufi/ban_user.php':{mode:s.IMMEDIATE},'/ajax/ufi/edit_comment.php':{mode:s.IMMEDIATE,error_handler:ca},'/ajax/ufi/like.php':{mode:s.BATCH_CONDITIONAL,error_handler:ga,batch_if:ka,batch_function:ma},'/ajax/ufi/subscribe.php':{mode:s.BATCH_CONDITIONAL,error_handler:ha,batch_if:la,batch_function:ma},'/ajax/ufi/id_comment_fetch.php':{mode:s.IMMEDIATE},'/ajax/ufi/remove_preview.php':{mode:s.IMMEDIATE},'/ajax/ufi/translate_comment.php':{mode:s.IMMEDIATE},'/profile/broadcast_request/async/add_composer_token/':{mode:s.IMMEDIATE}};ia[(new t()).getURI()]={mode:s.IMMEDIATE};s.registerEndpoints(ia);function ja(na,oa){return na&&na.ft_ent_identifier==oa.ft_ent_identifier&&na.comment_id==oa.comment_id;}function ka(na,oa){return na&&na.ft_ent_identifier==oa.ft_ent_identifier;}function la(na,oa){return na&&na.ft_ent_identifier==oa.ft_ent_identifier;}function ma(na,oa){return oa;}e.exports=aa;},null);
__d("UFIUIEvents",[],function(a,b,c,d,e,f){var g='UFIUIEvents/ufiActionLinkLike',h='UFIUIEvents/ufiActionLinkUnlike',i={UFIActionLinkLike:g,UFIActionLinkUnlike:h};e.exports=i;},null);
__d("UFIActionLinkController",["ActorURI","Arbiter","ClickPointIdentifiersDEPRECATED","CSS","DOMQuery","Parent","React","TrackingNodes","UFIBlingBox.react","UFICentralUpdates","UFIConstants","UFIFeedbackTargets","UFILikeLink.react","UFIShareLink.react","UFISubscribeLink.react","UFITimelineBlingBox.react","UFIToplevelCommentList","UFIUserActions","UFIUIEvents","copyProperties"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z){function aa(ca,da,ea){if(this._root)throw new Error('UFIActionLinkController attempted to initialize when a root was'+' already present');var fa=k.scry(ca,da)[0];if(fa){var ga=document.createElement('span');fa.parentNode.replaceChild(ga,fa);ga.appendChild(fa);if(typeof ea==="function")ea(ga);}else var ha=h.subscribe('PhotoSnowlift.DATA_CHANGE',function(){h.unsubscribe(ha);aa(ca,da,ea);},h.SUBSCRIBE_NEW);}var ba=function(ca,da,ea){this._id=da.ftentidentifier;this._ftFBID=ea.targetfbid;this._source=da.source;this._contextArgs=da;this._ufiRoot=ca;this._isOnTimeline=this._isRenderingOnTimeline();if(this._isOnTimeline){this._attemptInitializeTimelineBling();}else this._attemptInitializeBling();if(ea.viewercanlike||ea.hasviewerliked)this._attemptInitializeLike();if(ea.viewercansubscribetopost)this._attemptInitializeSubscribe();this._attemptInitializeShare();p.subscribe('feedback-updated',function(fa,ga){var ha=ga.updates;if(this._id in ha)this.render();}.bind(this));p.subscribe('feedback-id-changed',function(fa,ga){var ha=ga.updates;if(this._id in ha)this._id=ha[this._id];}.bind(this));};z(ba.prototype,{_attemptInitializeBling:function(){aa(this._ufiRoot,'^form .uiBlingBox',function(ca){this._blingRoot=ca;if(this._dataReady)this._renderBling();}.bind(this));},_attemptInitializeTimelineBling:function(){if(this._root)throw new Error('UFIActionLinkController attempted to initialize when a root was'+' already present');var ca=k.scry(this._ufiRoot,'^form .fbTimelineFeedbackActions .UFIBlingBoxTimeline')[0];if(ca){var da=k.scry(ca,'.fbTimelineFeedbackLikes')[0];this._enableShowLikes=da?true:false;var ea=k.scry(ca,'.fbTimelineFeedbackComments')[0];this._enableShowComments=ea?true:false;}this._blingTimelineRoot=ca;if(this._dataReady)this._renderTimelineBling();},_attemptInitializeLike:function(){aa(this._ufiRoot,'^form .like_link',function(ca){this._likeRoot=ca;if(this._dataReady)this._renderLike();}.bind(this));},_attemptInitializeSubscribe:function(){aa(this._ufiRoot,'^form .unsub_link',function(ca){this._subscribeRoot=ca;if(this._dataReady)this._renderSubscribe();}.bind(this));},_attemptInitializeShare:function(){aa(this._ufiRoot,'^form .share_action_link',function(ca){this._shareRoot=ca;var da=k.scry(this._shareRoot,'.share_action_link')[0];this._shareURI=da?da.getAttribute('href'):null;if(this._dataReady)this._renderShare();}.bind(this));},render:function(){this._dataReady=true;if(this._isOnTimeline){this._renderTimelineBling();}else this._renderBling();this._renderLike();this._renderSubscribe();this._renderShare();},_renderBling:function(){if(this._blingRoot)r.getFeedbackTarget(this._id,function(ca){var da=function(event){if(this._contextArgs.blingtogglescomments){var ha=l.byTag(event.target,"form");j.toggleClass(ha,"collapsed_comments");j.toggleClass(ha,"hidden_add_comment");}event.preventDefault();}.bind(this),ea=n.getTrackingInfo(n.types.BLINGBOX),fa=w.getCommentListForFeedbackTargetID_UNSAFE(this._id).getDisplayedCommentCount(),ga=m.createElement(o,{likes:ca.likecount,comments:fa,reshares:ca.sharecount,nfb:ca.nfbcount,permalink:ca.permalink,contextArgs:this._contextArgs,onClick:da,'data-ft':ea});this._blingBox=m.renderComponent(ga,this._blingRoot);}.bind(this));},_renderTimelineBling:function(){if(this._blingTimelineRoot)r.getFeedbackTarget(this._id,function(ca){var da=n.getTrackingInfo(n.types.BLINGBOX),ea=i.getUserActionID(i.types.TIMELINE_SEE_LIKERS),fa=function(event){var ia=l.byTag(event.target,"form");j.removeClass(ia,"collapsed_comments");var ja=k.scry(ia,'a.UFIPagerLink');if(ja.length)ja[0].click();event.preventDefault();}.bind(this),ga=w.getCommentListForFeedbackTargetID_UNSAFE(this._id).getDisplayedCommentCount(),ha=m.createElement(v,{comments:ga,commentOnClick:fa,contextArgs:this._contextArgs,'data-ft':da,'data-gt':ea,enableShowComments:this._enableShowComments,enableShowLikes:this._enableShowLikes,feedbackFBID:this._ftFBID,likes:ca.likecount,reshares:ca.sharecount,actorid:ca.actorid});m.renderComponent(ha,this._blingTimelineRoot);}.bind(this));},_renderLike:function(){if(this._likeRoot)r.getFeedbackTarget(this._id,function(ca){var da=!ca.hasviewerliked,ea=function(event){var ga=da?y.UFIActionLinkLike:y.UFIActionLinkUnlike;h.inform(ga,{ft_id:this._id,like_action:da,target:event.target});x.changeLike(this._id,da,{source:this._source,target:event.target,rootid:this._contextArgs.rootid,giftoccasion:this._contextArgs.giftoccasion});event.preventDefault();}.bind(this),fa=m.createElement(s,{onClick:ea,likeAction:da});this._likeLink=m.renderComponent(fa,this._likeRoot);}.bind(this));},_renderSubscribe:function(){if(this._subscribeRoot)r.getFeedbackTarget(this._id,function(ca){var da=!ca.hasviewersubscribed,ea=function(event){x.changeSubscribe(this._id,da,{source:this._source,target:event.target,rootid:this._contextArgs.rootid,commentexpandmode:ca.commentexpandmode});event.preventDefault();}.bind(this),fa=m.createElement(u,{onClick:ea,subscribeAction:da});this._subscribeLink=m.renderComponent(fa,this._subscribeRoot);}.bind(this));},_renderShare:function(){if(this._shareRoot&&this._shareURI)r.getFeedbackTarget(this._id,function(ca){var da=ca.actorforpost,ea=m.createElement(t,{href:g.create(this._shareURI,da)});this._shareLink=m.renderComponent(ea,this._shareRoot);}.bind(this));},_isRenderingOnTimeline:function(){if(this._source===q.UFIFeedbackSourceType.PROFILE){var ca=k.scry(this._ufiRoot,'^form .fbTimelineFeedbackActions .UFIBlingBoxTimeline');return (ca.length>0);}return false;}});e.exports=ba;},null);
__d("MentionsInputUtils",[],function(a,b,c,d,e,f){var g={generateDataFromTextWithEntities:function(h){var i=h.text,j=[];(h.ranges||[]).forEach(function(l){var m=l.entity;if(!m.external)j.push({uid:m.id,text:i.substr(l.offset,l.length),offset:l.offset,length:l.length,weakreference:!!m.weakreference});});var k={value:i,mentions:j};return k;}};e.exports=g;},null);
__d("ClipboardPhotoUploader",["ArbiterMixin","AsyncRequest","mixin"],function(a,b,c,d,e,f,g,h,i){var j=i(g);for(var k in j)if(j.hasOwnProperty(k))m[k]=j[k];var l=j===null?null:j.prototype;m.prototype=Object.create(l);m.prototype.constructor=m;m.__superConstructor__=j;function m(n,o){"use strict";this.uploadURIString=n;this.data=o;}m.prototype.handlePaste=function(event){"use strict";if(!event.clipboardData)return;var n=event.clipboardData.items;if(!n)return;for(var o=0;o<n.length;++o){var p=n[o];if(p.kind==='file'&&p.type.indexOf('image/')!==-1){var q=new FormData();q.append('pasted_file',p.getAsFile());var r=new h();r.setURI(this.uploadURIString).setData(this.data).setRawData(q).setHandler(function(s){this.inform('upload_success',s);}.bind(this)).setErrorHandler(function(s){this.inform('upload_error',s);}.bind(this));this.inform('upload_start');r.send();break;}}};e.exports=m;},null);
__d("LegacyMentionsInput.react",["Bootloader","CLogConfig","TypeaheadMetricsConfig","Event","Keys","React","ReactPropTypes","cx","PlaceholderListener"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){b('PlaceholderListener');var o=l.createClass({displayName:'ReactLegacyMentionsInput',propTypes:{initialData:m.object,placeholder:m.string,datasource:m.object,ref:m.string,viewOptionsTypeObjects:m.object,viewOptionsTypeObjectsOrder:m.array,hashtags:m.bool,autoflip:m.bool,onEnterSubmit:m.func,onFocus:m.func,onBlur:m.func,onTypingStateChange:m.func,onPaste:m.func},componentDidMount:function(){this.props.initialData&&this._initializeTextarea(this.getDOMNode());},hasEnteredText:function(){return !!(this._mentionsInput&&this._mentionsInput.getValue().trim());},submitComment:function(event){var p;if(event){p=event.target.value&&event.target.value.trim();}else{var q=this.refs.textarea.getDOMNode();if(q.value&&q.value!==q.placeholder)p=q.value;}p=p||'';var r={visibleValue:p,encodedValue:p};if(this._mentionsInput)r.encodedValue=this._mentionsInput.getRawValue().trim();var s=this.props.onEnterSubmit(r,event);if(s&&this._mentionsInput){this._mentionsInput.reset();event&&event.preventDefault();}},_handleKeydown:function(event){var p=event.nativeEvent,q=j.getKeyCode(p)==k.RETURN&&!j.$E(p).getModifiers().any,r=this._mentionsInput&&this._mentionsInput.getTypeahead().getView().getSelection();if(this.props.onEnterSubmit&&q&&!r)this.submitComment(event);},_handleFocus:function(){this.props.onFocus&&this.props.onFocus();this._initializeTextarea(this.refs.root.getDOMNode());},_handleBlur:function(){this.props.onBlur&&this.props.onBlur();},_initializeTextarea:function(p){if(this._mentionsInput||this._bootloadingMentions)return;this._bootloadingMentions=true;g.loadModules(["CompactTypeaheadRenderer","ContextualTypeaheadView","CLoggerX","InputSelection","MentionsInput","TextAreaControl","Typeahead","TypeaheadAreaCore","TypeaheadBestName","TypeaheadHoistFriends","TypeaheadMetrics","TypeaheadMetricsX","TypingDetector","UFIComments"],function(q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da){var ea=this.refs.textarea.getDOMNode();new v(ea);if(h.gkResults){var fa=da.getComment(this.props.replyCommentID),ga=fa?fa.fbid:null;s.trackMentionsInput(ea,ga);}if(this.props.onTypingStateChange){var ha=new ca(ea);ha.init();ha.subscribe('change',this.props.onTypingStateChange);}var ia={autoSelect:true,renderer:q,causalElement:ea,autoflip:this.props.autoflip};if(this.props.viewOptionsTypeObjects)ia.typeObjects=this.props.viewOptionsTypeObjects;if(this.props.viewOptionsTypeObjectsOrder)ia.typeObjectsOrder=this.props.viewOptionsTypeObjectsOrder;var ja=new w(this.props.datasource,{ctor:r,options:ia},{ctor:x},this.refs.typeahead.getDOMNode()),ka=[y,z];if(i.gkResults){var la=new ba({extraData:{event_name:'mention_metric_x'}});la.init(ja);}var ma=new aa({extraData:{event_name:'mentions',from_location:'comments'}});w.initNow(ja,ka,ma);this._mentionsInput=new u(p,ja,ea,{hashtags:this.props.hashtags});this._mentionsInput.init({},this.props.initialData);if(this.props.initialData)t.set(ea,ea.value.length);if(this.props.onPaste)j.listen(ea,'paste',this.props.onPaste);this._bootloadingMentions=false;}.bind(this));},focus:function(){try{this.refs.textarea.getDOMNode().focus();}catch(p){}},render:function(){var p=(("textInput")+(' '+"mentionsTextarea")+(' '+"uiTextareaAutogrow")+(' '+"uiTextareaNoResize")+(' '+"UFIAddCommentInput")+(' '+"DOMControl_placeholder"));return (l.createElement(l.DOM.div,{ref:"root",className:"uiMentionsInput textBoxContainer ReactLegacyMentionsInput"},l.createElement(l.DOM.div,{className:"highlighter"},l.createElement(l.DOM.div,null,l.createElement(l.DOM.span,{className:"highlighterContent hidden_elem"}))),l.createElement(l.DOM.div,{ref:"typeahead",className:"uiTypeahead mentionsTypeahead"},l.createElement(l.DOM.div,{className:"wrap"},l.createElement(l.DOM.input,{type:"hidden",autoComplete:"off",className:"hiddenInput"}),l.createElement(l.DOM.div,{className:"innerWrap"},l.createElement(l.DOM.textarea,{ref:"textarea",name:"add_comment_text",className:p,title:this.props.placeholder,placeholder:this.props.placeholder,onFocus:this._handleFocus,onBlur:this._handleBlur,onKeyDown:this._handleKeydown,defaultValue:this.props.placeholder})))),l.createElement(l.DOM.input,{type:"hidden",autoComplete:"off",className:"mentionsHidden",defaultValue:""})));}});e.exports=o;},null);
__d("UFIClassNames",["cx"],function(a,b,c,d,e,f,g){e.exports={ACTOR_IMAGE:"img UFIActorImage _54ru",ROW:"UFIRow",UNSEEN_ITEM:"UFIUnseenItem"};},null);
__d("UFIStickerButton.react",["Bootloader","ContextualLayerAutoFlip","React","ReactLayeredComponentMixin","StickerConstants","UFIConfig","cx","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){var o=i.createClass({displayName:'UFIStickerButton',propTypes:{onStickerSelected:i.PropTypes.func.isRequired},mixins:[j],getInitialState:function(){var p=l.stickerSearch?k.SEARCH_PACK_ID:k.MRU_STICKER_PACK;return {renderFlyout:null,flyoutShown:false,packID:String(p)};},render:function(){var p="Send a Sticker";return (i.createElement(i.DOM.div,{'aria-label':p,className:"UFICommentStickerButton",'data-hover':"tooltip",'data-tooltip-alignh':"center",onClick:this._onLinkClicked,onMouseDown:this._prepareForClick,ref:"link"},i.createElement(i.DOM.div,{className:"UFICommentStickerIcon"})));},renderLayers:function(){return !this.state.renderFlyout?{}:this.state.renderFlyout();},_hideFlyout:function(){this.setState({flyoutShown:false});},_prepareForClick:function(){this._clickGuard=this.state.flyoutShown;},_onLinkClicked:function(){if(this.state.renderFlyout!==null){!this._clickGuard&&this.setState({flyoutShown:true});return;}g.loadModules(["XUIContextualDialog.react","StickersFlyout.react"],function(p,q){this.setState({flyoutShown:true,renderFlyout:function(){return {contextualDialog:i.createElement(p,{alignment:"right",behaviors:{flip:h},className:"_5e-r",contextRef:"link",onBlur:this._hideFlyout,position:"above",shown:this.state.flyoutShown,hasActionableContext:true,width:278},i.createElement(i.DOM.div,null,i.createElement(q,{onPackSelect:function(r){this.setState({packID:r});}.bind(this),onStickerSelect:this._onStickerSelected,onEmoticonSelect:this._onEmoticonSelected,isComments:true,packID:this.state.packID,shown:this.state.flyoutShown})))};}.bind(this)});}.bind(this));},_onStickerSelected:function(p,event){this.props.onStickerSelected(p,event);},_onEmoticonSelected:function(p){this.props.onEmoticonSelected(p);}});e.exports=o;},null);
__d("XFeedNUXSaveSeenStateControllerURIBuilder",["XControllerURIBuilder"],function(a,b,c,d,e,f){e.exports=b("XControllerURIBuilder").create("\/feed\/nux\/seen\/save\/",{link_id:{type:"String"},key:{type:"String",required:true},seen:{type:"Bool"}});},null);
__d("UFIAddComment.react",["ActorURI","AsyncRequest","Bootloader","ClipboardPhotoUploader","CloseButton.react","DOM","DOMContainer.react","getActiveElement","Event","Focus","HTML","Keys","LegacyMentionsInput.react","Link.react","LitestandStoryInsertionStatus","LoadingIndicator.react","React","ReactLayeredComponentMixin","Run","SnowflakePermalinkUtils","Sticker.react","TrackingNodes","UFIClassNames","UFIConfig","UFIImageBlock.react","UFIStickerButton.react","URI","XFeedNUXSaveSeenStateControllerURIBuilder","cx","fbt","joinClasses","tx"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la){var ma="Write a comment...",na="Write a reply...",oa="fcg fss UFICommentTip",pa=19,qa='/ajax/ufi/upload/',ra=80,sa='/ajax/ufi/sticker_preview/',ta=w.createClass({displayName:'UFIAddComment',mixins:[x],propTypes:{contextArgs:w.PropTypes.object.isRequired,viewerActor:w.PropTypes.object.isRequired,allowPhotoAttachments:w.PropTypes.bool,allowStickerAttachments:w.PropTypes.bool,attachedPhoto:w.PropTypes.object,attachedSticker:w.PropTypes.object,hide:w.PropTypes.bool,initialData:w.PropTypes.object,isEditing:w.PropTypes.bool,isFirstComponent:w.PropTypes.bool,isLastComponent:w.PropTypes.bool,isQAndA:w.PropTypes.bool,mentionsDataSource:w.PropTypes.object,onCancel:w.PropTypes.func,onCommentSubmit:w.PropTypes.func,onTypingStateChange:w.PropTypes.func,replyCommentID:w.PropTypes.string,showSendOnEnterTip:w.PropTypes.bool,subtitle:w.PropTypes.any,targetID:w.PropTypes.string,withoutSeparator:w.PropTypes.bool},getInitialState:function(){if(this.props.attachedPhoto)this.props.contextArgs.attachedphoto=this.props.attachedPhoto;if(this.props.attachedSticker)this.props.contextArgs.attachedsticker=this.props.attachedSticker;return {attachedPhoto:this.props.attachedPhoto?this.props.attachedPhoto:null,attachedSticker:this.props.attachedSticker?this.props.attachedSticker:null,broadcastRequestTokenizer:null,fileInput:null,fileUploader:null,isCommenting:false,isLoadingPhoto:false,isRecommending:false,recommendationEntries:[],renderStickerNUX:null,searchSource:null,stickerNUXVisible:false};},_onKeyDown:function(event){if(this.props.isEditing&&o.getKeyCode(event.nativeEvent)===r.ESC)this.props.onCancel();if(this.isMounted()&&!this._isOnBeforeUnloadListenerAdded){y.onBeforeUnload(this._handleUnsavedChanges);this._isOnBeforeUnloadListenerAdded=true;}var ua=n();if(o.getKeyCode(event.nativeEvent)===r.ESC)ua.blur();},_handleUnsavedChanges:function(){var ua=a.PageTransitions;if(ua){var va=ga.getNextURI(),wa=ua.getMostRecentURI();if(va.getQueryData().hasOwnProperty('theater')||wa.getQueryData().hasOwnProperty('theater')||z.isPermalinkURI(va)||z.isPermalinkURI(wa))return;var xa=a.DialogNavigationStack;if(xa&&xa.isActiveURI(va))return;}if(this.refs&&this.refs.mentionsinput&&this.refs.mentionsinput.hasEnteredText())return "You haven't finished your comment yet. Do you want to leave without finishing?";},_blur:function(){this.setState({stickerNUXVisible:false});if(this.refs.mentionsinput&&this.refs.mentionsinput.hasEnteredText())return;this.setState({isCommenting:false});},_onPaste:function(event){var ua=new j(qa,this._getPhotoUploadData());this._cancelCurrentSubscriptions();this._subscriptions=[ua.subscribe('upload_start',this._prepareForAttachedPhotoPreview),ua.subscribe('upload_error',this._onRemoveAttachedPhotoPreviewClicked),ua.subscribe('upload_success',function(va,wa){this._onPhotoUploadComplete(wa);}.bind(this))];ua.handlePaste(event);},_onEnterSubmit:function(ua,event){var va=this.state.attachedPhoto||this.state.attachedSticker||this.state.recommendationEntries.length,wa=this.props.isEditing||va;if(this.state.isLoadingPhoto){return false;}else if(!ua.encodedValue.trim()&&!wa)return false;if(va){if(this.state.recommendationEntries.length){var xa=[],ya=[];this.state.recommendationEntries.forEach(function(za){xa.push(za.getUniqueID());ya.push(za.getTitle());});ua.recommendationIDs=xa;if(ya.length)ua.visibleValue+=' \u2014 '+ya.join(', ');}this.setState({isLoadingPhoto:false,isRecommending:false,attachedPhoto:null,attachedSticker:null,recommendationEntries:[]});ua.attachedPhoto=this.props.contextArgs.attachedphoto;ua.attachedSticker=this.props.contextArgs.attachedsticker;}else{ua.attachedPhoto=null;ua.attachedSticker=null;}this.props.onCommentSubmit(ua,event);return true;},_cancelCurrentSubscriptions:function(){if(this._subscriptions)this._subscriptions.forEach(function(ua){ua.unsubscribe();});},componentWillMount:function(){this._isOnBeforeUnloadListenerAdded=false;this._storyInsertionBlocker=u.registerBlocker(function(){return this.state.isCommenting;}.bind(this));if(this.props.contextArgs.canaddrecommendation)i.loadModules(["BroadcastRequestTokenizer.react","BroadcastRequestParam","WebAsyncSearchSource","XBroadcastRequestSearchSourceControllerURIBuilder"],function(ua,va,wa,xa){var ya=new xa().setString(va.SOURCE_OBJ_ID,this.props.contextArgs.ftentidentifier).getURI(),za=new wa({bootstrapRequests:[{uri:ya}],getAllForEmptyQuery:true,queryRequests:[{uri:ya}]});this.setState({broadcastRequestTokenizer:ua,searchSource:za});}.bind(this));},componentWillUnmount:function(){this._cancelCurrentSubscriptions();this._storyInsertionBlocker&&this._storyInsertionBlocker.unsubscribe();this._storyInsertionBlocker=null;},focus:function(){var ua={isCommenting:true};if(this.props.allowStickerAttachments&&da.shouldShowStickerNUX){var va=new ha().setString('key','sticker_comments').setBool('seen',true).getURI();new h(va).send();if(this.state.renderStickerNUX===null)i.loadModules(["XUIAmbientNUX.react"],function(wa){ua.renderStickerNUX=function(){return {ambientNUX:w.createElement(wa,{contextRef:"sticker_button",shown:this.state.stickerNUXVisible,position:"above",width:"auto",alignment:"right",onCloseButtonClick:this._hideStickerNUX},"Express yourself with stickers!")};}.bind(this);}.bind(this));da.shouldShowStickerNUX=false;ua.stickerNUXVisible=true;}this.setState(ua);},renderLayers:function(){return !this.state.renderStickerNUX?{}:this.state.renderStickerNUX();},render:function(){var ua=!this.props.contextArgs.collapseaddcomment||this.state.isCommenting,va=null;if(this.props.isEditing){va=w.createElement(w.DOM.span,{className:oa},ja._("Press Esc to {cancel}.",[ja.param("cancel",w.createElement(t,{onClick:this.props.onCancel},"cancel"))]));}else if(this.props.showSendOnEnterTip){va=w.createElement(w.DOM.span,{className:oa},"Press Enter to post.");}else if(this.props.subtitle)va=w.createElement(w.DOM.span,{className:oa},this.props.subtitle);var wa=null,xa=null,ya=this.state.attachedPhoto||this.state.attachedSticker,za=null;if(this.props.allowStickerAttachments&&!ya){var ab=this.props.isEditing?this._prepareForAttachedStickerPreview:this.onStickerSelected;xa=w.createElement(fa,{ref:"sticker_button",onStickerSelected:ab,onEmoticonSelected:this._insertEmoticonIntoCommentText});}if(this.props.allowPhotoAttachments){za=this._onPaste;var bb=ya?"UFICommentPhotoAttachedIcon":"UFICommentPhotoIcon",cb="UFIPhotoAttachLinkWrapper _m";wa=w.createElement(w.DOM.div,{ref:"PhotoInputContainer",className:cb,'data-hover':"tooltip",'data-tooltip-alignh':"center",'aria-label':"Attach a Photo"},w.createElement(w.DOM.i,{ref:"PhotoInputControl",className:bb}));}var db=ba.getTrackingInfo(ba.types.ADD_COMMENT_BOX),eb=ka(ca.ACTOR_IMAGE,((!ua?"hidden_elem":''))),fb=w.createElement(w.DOM.div,{className:"UFIReplyActorPhotoWrapper",onClick:this.focus},w.createElement(w.DOM.img,{className:eb,src:this.props.viewerActor.thumbSrc,alt:this.props.viewerActor.name})),gb=ka(ca.ROW,((this.props.hide?"noDisplay":'')+(' '+"UFIComponent")+(' '+"UFIAddComment")+(this.props.allowPhotoAttachments?' '+"UFIAddCommentWithPhotoAttacher":'')+(this.props.withoutSeparator?' '+"UFIAddCommentWithoutSeparator":'')+(this.props.isFirstComponent?' '+"UFIFirstComponent":'')+(this.props.isLastComponent?' '+"UFILastComponent":''))),hb;if(!!this.props.replyCommentID){hb=na;}else if(this.props.isQAndA){hb="Ask a question...";}else hb=ma;var ib=this.props.contextArgs.viewoptionstypeobjects,jb=this.props.contextArgs.viewoptionstypeobjectsorder,kb=null;if(this.state.attachedSticker){var lb=this._getScaledDimensions(ya.metadata.height,ya.metadata.width);kb=w.createElement(aa,{animationTrigger:"load_and_hover",frameCount:ya.metadata.frameCount,framesPerCol:ya.metadata.framesPerCol,framesPerRow:ya.metadata.framesPerRow,spriteURI:ya.metadata.sprite_uri,sourceHeight:lb.height,sourceURI:ya.metadata.source_uri,sourceWidth:lb.width});}else if(this.state.attachedPhoto){var mb=ya.markupPreview;if(q.isHTML(mb.markup))mb=q.replaceJSONWrapper(mb.markup).getRootNode();kb=w.createElement(m,null,mb);va=null;}else if(this.state.isLoadingPhoto)kb=w.createElement(v,{color:"white",className:"UFICommentPhotoAttachedPreviewLoadingIndicator",size:"medium"});var nb,ob=this.state.attachedPhoto?this._onRemoveAttachedPhotoPreviewClicked:this._onRemoveAttachedStickerPreviewClicked;if(kb!=null){var pb=null;if(this.state.attachedSticker){pb="Remove Sticker";}else if(this.state.attachedPhoto)pb="Remove Photo";nb=w.createElement(w.DOM.div,{className:"UFICommentPhotoAttachedPreview pas"},kb,w.createElement(k,{tooltip:pb,onClick:ob}));}var qb=this.props.allowStickerAttachments?ka("UFIMentionsInputWrap","UFIStickersEnabledInput"):"UFIMentionsInputWrap",rb,sb,tb;if(this.props.contextArgs.mentionsinput){var ub=this.props.contextArgs.mentionsinput;if(ub.hasOwnProperty('inputComponent')){rb=ub.inputComponent;sb=ub.viewComponent;tb=ub.viewProps;}else rb=ub;}else rb=s;var vb=null;if(this.props.contextArgs.canaddrecommendation)if(this.state.broadcastRequestTokenizer){var wb=this.state.broadcastRequestTokenizer;vb=(w.createElement(wb,{active:this.state.isRecommending,entries:this.state.recommendationEntries,onBlur:this._onRecommendationInputBlur,onSubmitAttempt:this._onRecommendationTokenizerSubmit,onTokenChange:this._onRecommendationTokenizerUpdate,onTriggerClick:this._onRecommendationTriggerClick,placeHolder:this.props.contextArgs.broadcastrequestplaceholder,searchSource:this.state.searchSource,sourceID:this.props.contextArgs.ftentidentifier}));}return (w.createElement(w.DOM.li,{className:gb,onKeyDown:this._onKeyDown,'data-ft':db},w.createElement(ea,{className:qb},fb,w.createElement(w.DOM.div,{className:"UFICommentContainer"},w.createElement(w.DOM.div,{className:"UFIInputContainer"},w.createElement(rb,{replyCommentID:this.props.replyCommentID,initialData:this.props.initialData,placeholder:hb,datasource:this.props.mentionsDataSource,ref:"mentionsinput",viewComponent:sb,viewProps:tb,viewOptionsTypeObjects:ib,viewOptionsTypeObjectsOrder:jb,hashtags:this.props.contextArgs.sht,autoflip:this.props.contextArgs.addcommentautoflip,onEnterSubmit:this._onEnterSubmit,onFocus:this.focus,onBlur:this._blur,onTypingStateChange:this.props.onTypingStateChange,onPaste:za}),w.createElement(w.DOM.div,{className:"UFICommentAttachmentButtons clearfix"},wa,xa)),nb,vb,va))));},_onRecommendationInputBlur:function(){if(!this.state.recommendationEntries.length)this.setState({isRecommending:false});},_onRecommendationTokenizerSubmit:function(event){this.refs.mentionsinput.submitComment(event);},_onRecommendationTokenizerUpdate:function(ua){this.setState({recommendationEntries:ua});},_onRecommendationTriggerClick:function(){this.setState({isRecommending:true});},componentDidUpdate:function(ua,va,wa){if(!va.attachedPhoto&&this.state.attachedPhoto||!va.attachedSticker&&this.state.attachedSticker)this.refs.mentionsinput.focus();if(ua.viewerActor.id!==this.props.viewerActor.id){if(this.state.fileInput)this.state.fileInput.clear();if(this.state.fileUploader)this.state.fileUploader.setData(this._getPhotoUploadData());this._onRemoveAttachedPhotoPreviewClicked();}},componentDidMount:function(){if(!this.props.allowPhotoAttachments)return;var ua=this.refs.PhotoInputContainer.getDOMNode(),va=this.refs.PhotoInputControl.getDOMNode(),wa="Choose a file to upload",xa=l.create('input',{accept:'image/*',className:"_n",name:'file',type:'file',title:wa,'aria-label':wa});l.appendContent(va,xa);var ya=o.listen(ua,'click',function(event){i.loadModules(["FileInput","FileInputUploader","Input"],function(za,ab,bb){var cb=new za(ua,va,xa),db=new ab(undefined,ua).setURI(qa).setData(this._getPhotoUploadData());cb.subscribe('change',function(event){if(cb.getValue()){this._prepareForAttachedPhotoPreview();db.setInput(cb.getInput()).send();}}.bind(this));db.subscribe('success',function(eb,fb){cb.clear();this._onPhotoUploadComplete(fb.response);}.bind(this));db.subscribe('failure',function(eb,fb){cb.clear();this._onPhotoUploadComplete(fb.response);}.bind(this));p.setWithoutOutline(va);this.setState({fileInput:cb,fileUploader:db});}.bind(this));ya.remove();}.bind(this));},_getScaledDimensions:function(ua,va){var wa,xa,ya;if(va>ua){ya=ra/va;wa=ua*ya;xa=va*ya;}else{ya=ra/ua;wa=ua*ya;xa=va*ya;}return {height:Math.round(wa),width:Math.round(xa)};},_getPhotoUploadData:function(){var ua=this.props.viewerActor.id,va={profile_id:ua,target_id:this.props.targetID,source:pa};va[g.PARAMETER_ACTOR]=ua;return va;},_onPhotoUploadComplete:function(ua){if(!this.state.isLoadingPhoto)return;var va=ua.getPayload();if(va&&va.fbid){this.props.contextArgs.attachedphoto=va;this.setState({attachedPhoto:va,isLoadingPhoto:false});}else this._onRemoveAttachedPhotoPreviewClicked(null);},_onRemoveAttachedPhotoPreviewClicked:function(event){this.props.contextArgs.attachedphoto=null;this.setState({attachedPhoto:null,isLoadingPhoto:false});},_prepareForAttachedPhotoPreview:function(){this.props.contextArgs.attachedphoto=null;this.setState({attachedPhoto:null,isLoadingPhoto:true});},_onStickerUploadComplete:function(ua){if(!this.state.isLoadingPhoto)return;var va=ua.getPayload();if(va&&va.fbid){this.props.contextArgs.attachedsticker=va;this.setState({attachedSticker:va,isLoadingPhoto:false});}else{i.loadModules(["Dialog"],function(wa){var xa="Sticker Failed",ya="There was a problem attaching the sticker.";new wa().setTitle(xa).setBody(ya).setButtons(wa.OK).show();});this._onRemoveAttachedStickerPreviewClicked(null);}},_onRemoveAttachedStickerPreviewClicked:function(event){this.props.contextArgs.attachedsticker=null;this.setState({attachedSticker:null,isLoadingPhoto:false});},_prepareForAttachedStickerPreview:function(ua){this.props.contextArgs.attachedsticker=null;this.setState({attachedSticker:null,isLoadingPhoto:true});new h(sa).setData({sticker_id:ua}).setErrorHandler(this._onRemoveAttachedStickerPreviewClicked).setHandler(this._onStickerUploadComplete).send();},onStickerSelected:function(ua,event){var va={encodedValue:'',visibleValue:''};this.props.contextArgs.attachedsticker={fbid:ua};this.props.onCommentSubmit(va,event);},_insertEmoticonIntoCommentText:function(ua){i.loadModules(["EmoticonsList","EmoticonUtils","TextAreaControl","SelectionPosition"],function(va,wa,xa,ya){if(!this._selectionPosition)this._selectionPosition=new ya(this.refs.mentionsinput.refs.textarea.getDOMNode());var za=va.symbols[ua];if(!za)return;var ab=this.refs.mentionsinput.refs.textarea.getDOMNode(),bb=xa.getInstance(ab),cb=bb.getValue(),db=wa.insertEmoticon(za,cb,this._selectionPosition.getPos());bb.setValue(db.result);this._selectionPosition.setPos(db.start,db.end);}.bind(this));},_hideStickerNUX:function(){this.setState({stickerNUXVisible:false});}});e.exports=ta;},null);
__d("UFIAddCommentController",["Arbiter","copyProperties","MentionsInputUtils","Parent","UFIAddComment.react","React","ShortProfiles","UFICentralUpdates","UFIComments","UFIFeedbackTargets","UFIInstanceState","UFIUserActions"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){function s(t,u,v,w){this.id=u;this._ufiInstanceID=w.instanceid;this._contextArgs=w;this._replyCommentID=v;if(t){this.root=t;if(!this._contextArgs.rootid)this._contextArgs.rootid=t.id;this.render();n.subscribe('instance-updated',function(x,y){var z=y.updates;if(this._ufiInstanceID in z)this.render();}.bind(this));n.subscribe('feedback-updated',function(x,y){var z=y.updates;if(this.id in z)this.render();}.bind(this));}n.subscribe('feedback-id-changed',function(x,y){var z=y.updates;if(this.id in z)this.id=z[this.id];}.bind(this));}h(s.prototype,{_onCommentSubmit:function(t,event){r.addComment(this.id,t.visibleValue,t.encodedValue,{source:this._contextArgs.source,ufiinstanceid:this._ufiInstanceID,target:event.target,replyid:this._replyCommentID,timelinelogdata:this._contextArgs.timelinelogdata,rootid:this._contextArgs.rootid,attachedphoto:this._contextArgs.attachedphoto,attachedsticker:this._contextArgs.attachedsticker,giftoccasion:this._contextArgs.giftoccasion,recommendationIDs:t.recommendationIDs});this._contextArgs.attachedphoto=null;this._contextArgs.attachedsticker=null;p.getFeedbackTarget(this.id,function(u){var v=j.byTag(this.root,'form');if(v)g.inform('ufi/comment',{form:v,isranked:u.isranked});}.bind(this));return false;},_onTypingStateChange:function(t,u){},renderAddComment:function(t,u,v,w,x,y,z,aa,ba,ca){var da=this._contextArgs.logtyping?this._onTypingStateChange.bind(this):null,ea=null,fa=q.getKeyForInstance(this._ufiInstanceID,'isediting')&&!this._replyCommentID;return (l.createElement(k,{hide:fa,replyCommentID:this._replyCommentID,viewerActor:t,targetID:u,initialData:ea,ref:x,withoutSeparator:y,onCommentSubmit:this._onCommentSubmit.bind(this),mentionsDataSource:v,onTypingStateChange:da,showSendOnEnterTip:w,allowPhotoAttachments:aa,allowStickerAttachments:ba,source:this._contextArgs.source,contextArgs:this._contextArgs,subtitle:z,isQAndA:ca}));},renderEditComment:function(t,u,v,w,x,y,z,aa,ba){var ca=o.getComment(v),da;if(ca.attachment)da=ca.attachment.type=='sticker'?ca.attachment:null;var ea=i.generateDataFromTextWithEntities(ca.body);return (l.createElement(k,{viewerActor:t,targetID:u,initialData:ea,onCommentSubmit:x,onCancel:y,mentionsDataSource:w,source:this._contextArgs.source,contextArgs:this._contextArgs,isEditing:true,editingCommentID:v,attachedPhoto:ca.photo_comment,attachedSticker:da,allowPhotoAttachments:z,allowStickerAttachments:aa,isQAndA:ba}));},render:function(){if(!this.root)throw new Error('render called on UFIAddCommentController with no root');p.getFeedbackTarget(this.id,function(t){if(t.cancomment&&t.actorforpost)m.get(t.actorforpost,function(u){var v=this.renderAddComment(u,t.ownerid,t.mentionsdatasource,t.showsendonentertip,null,null,t.subtitle,t.allowphotoattachments,t.allowstickerattachments,t.isqanda);this._addComment=l.renderComponent(v,this.root);}.bind(this));}.bind(this));}});e.exports=s;},null);
__d("UFIAddCommentLink.react",["React","UFIClassNames","cx","fbt","joinClasses","tx"],function(a,b,c,d,e,f,g,h,i,j,k,l){var m=g.createClass({displayName:'UFIAddCommentLink',propTypes:{'data-ft':g.PropTypes.string,isFirstCommentComponent:g.PropTypes.bool,isFirstComponent:g.PropTypes.bool,isLastCommentComponent:g.PropTypes.bool,isLastComponent:g.PropTypes.bool,isQAndA:g.PropTypes.bool,onClick:g.PropTypes.func},render:function(){var n=k(h.ROW,(("UFIAddCommentLink")+(this.props.isFirstCommentComponent?' '+"UFIFirstCommentComponent":'')+(this.props.isLastCommentComponent?' '+"UFILastCommentComponent":'')+(this.props.isFirstComponent?' '+"UFIFirstComponent":'')+(this.props.isLastComponent?' '+"UFILastComponent":''))),o;if(this.props.isQAndA){o="Ask a question...";}else o="Write a comment...";return (g.createElement(g.DOM.li,{className:n,'data-ft':this.props['data-ft']},g.createElement(g.DOM.a,{className:"UFICommentLink",onClick:this.props.onClick,href:"#",role:"button"},o)));}});e.exports=m;},null);
__d("URITruncator",["URI","tx"],function(a,b,c,d,e,f,g,h){var i=3;function j(k,l){var m="...",n=m.length;if(!k||l===undefined||k.length<=l||l<=n||k.toString().length<=n)return k;if(!g.isValidURI(k))return k.substring(0,l-n)+m;var o=new g(k),p=o.getOrigin();if(p.length>l-n)return p.substring(0,l-n)+m;var q=false;if(!!o.getFragment()){q=true;o.setFragment('');if(o.toString().length<=l-n)return o.toString()+m;}var r=o.getQueryData();if(r){var s=Object.keys(r);if(s.length>0){q=true;for(var t=s.length-1;t>=0;t--){o.removeQueryData(s[t]);if(o.toString().length<=l-n)return o.toString()+m;}}}var u=o.getPath()+(q?m:''),v=u.split('/'),w=(p.length+u.length)-l,x=0;while(w>0&&v.length>x+1){var y=x+1,z=v[y];if(w+n+i<=z.length){var aa=z.length-1,ba=z.length-w-n,ca=/[a-zA-Z0-9]/;w+=n;while(w>0){while(aa>0&&ca.test(z[aa])){aa--;w--;}while(aa>0&&!ca.test(z[aa])){aa--;w--;}}if(aa===0)aa=ba-1;v[y]=z.substring(0,aa+1)+m;}else{x++;w-=z.length;if(x===1){w+=n;}else w--;}}if(x>0){if(v[v.length-1].length===0&&v.length===x+2)x++;v.splice(1,x,m);}var da=p+v.join('/');if(da.length>l)da=da.substring(0,l-n)+m;return da;}e.exports=j;},null);
__d("HovercardLinkInterpolator",["HovercardLink","Link.react","React","RTLConfig","URI","URITruncator","cx","isRTL"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){function o(p,q,r,s,t,u){var v=q.entity,w=r||(v.external?'_blank':null),x,y=((!v.external?"profileLink":'')+(v.weakreference?' '+"weakReference":'')),z;if(j.gkCheckSuccess){var aa=v.hashtag?p.substring(1):p;z=n(aa)?'rtl':'ltr';}if(v.hashtag){var ba=new k(v.url).setSubdomain('www');x=i.createElement(i.DOM.a,{className:"_58cn",dir:z,href:ba.toString()},i.createElement(i.DOM.span,{className:"_58cl"},p.substring(0,1)),i.createElement(i.DOM.span,{className:"_58cm"},p.substring(1)));}else if(v.weakreference){x=i.createElement(h,{className:y,dir:z,href:v,target:w},i.createElement(i.DOM.i,{className:"UFIWeakReferenceIcon"}),p);}else{if(u&&v.external)p=l(p,u);x=i.createElement(h,{className:y,dir:z,href:v,target:w},p);}if(!v.external&&!v.hashtag&&!v.photo)x.props['data-hovercard']=g.constructEndpointWithGroupAndLocation(v,s,t).toString();return x;}e.exports=o;},null);
__d("SeeMore.react",["React","cx","tx"],function(a,b,c,d,e,f,g,h,i){var j=g.createClass({displayName:'SeeMore',getInitialState:function(){return {isCollapsed:true};},handleClick:function(){this.setState({isCollapsed:false});},render:function(){var k=this.state.isCollapsed,l=k?g.createElement(g.DOM.span,{className:"_5uzb"},"..."):null,m=this.props.children[0],n=k?null:g.createElement(g.DOM.span,null,this.props.children[1]),o=!k?null:g.createElement(g.DOM.a,{className:"_5v47 fss",onClick:this.handleClick,href:"#",role:"button"},"See More");return (g.createElement(g.DOM.span,{className:this.props.className},m,l,o,n));}});e.exports=j;},null);
__d("findSplitPointForText",[],function(a,b,c,d,e,f){function g(h,i,j){var k=null,l=h.split('\n');if(i&&h.length>i)k=i;if(j&&l.length>j){var m=l.slice(0,j).join('\n').length;if(k!==null){k=Math.min(m,k);}else k=m;}return k;}e.exports=g;},null);
__d("TruncatedTextWithEntities.react",["React","TextWithEntities.react","SeeMore.react","findSplitPointForText","partitionTextAndRanges"],function(a,b,c,d,e,f,g,h,i,j,k){var l=g.createClass({displayName:'TruncatedTextWithEntities',render:function(){var m=this.props.text||'',n=this.props.ranges||[];m=m.replace(/\s*$/,'');var o=this.props.maxLines,p=this.props.maxLength;if(p&&m.length>p){var q=this.props.truncationPercent||.6;p=Math.floor(q*p);}var r=j(m,p,o);if(r!==null){while(m[r-1]==='\n')r--;var s=k(m,n,r);return (g.createElement(g.DOM.span,{'data-ft':this.props['data-ft'],dir:this.props.dir},g.createElement(i,{className:this.props.className},g.createElement(h,{interpolator:this.props.interpolator,ranges:s.before.ranges,aggregatedRanges:this.props.aggregatedRanges,text:s.before.text,renderEmoticons:this.props.renderEmoticons,renderEmoji:this.props.renderEmoji}),g.createElement(h,{interpolator:this.props.interpolator,ranges:s.after.ranges,aggregatedRanges:this.props.aggregatedRanges,text:s.after.text,renderEmoticons:this.props.renderEmoticons,renderEmoji:this.props.renderEmoji}))));}else return (g.createElement(g.DOM.span,{'data-ft':this.props['data-ft'],dir:this.props.dir},g.createElement(h,{className:this.props.className,interpolator:this.props.interpolator,ranges:n,imageRanges:this.props.imageRanges,aggregatedRanges:this.props.aggregatedRanges,text:m,renderEmoticons:this.props.renderEmoticons,renderEmoji:this.props.renderEmoji})));}});e.exports=l;},null);
__d("UFIActor.react",["Badge.react","Focus","HovercardLink","Locale","React","cx"],function(a,b,c,d,e,f,g,h,i,j,k,l){var m=" \u00b7 ",n=k.createClass({displayName:'UFIActor',propTypes:{author:k.PropTypes.object.isRequired,'data-ft':k.PropTypes.string,focusOnMount:k.PropTypes.bool,showHovercard:k.PropTypes.bool},componentDidMount:function(){if(this.props.focusOnMount)h.setWithoutOutline(this.refs.authorName.getDOMNode());},render:function(){var o=this.props.author,p=j.isRTL()?'rtl':'ltr',q=o.uri?k.createElement(k.DOM.a,{className:"UFICommentActorName",'data-hovercard':this.props.showHovercard?i.constructEndpointWithLocation(o,'ufi').toString():null,'data-ft':this.props['data-ft'],dir:p,href:o.uri,ref:"authorName"},o.name):k.createElement(k.DOM.span,{className:"UFICommentActorName",dir:p,ref:"authorName"},o.name);return (k.createElement(k.DOM.span,null,q,k.Children.map(this.props.children,function(r){return r?[r.type==g.type?"":m,r]:null;})));}});e.exports=n;},null);
__d("UFICommentLikeCount.react",["NumberFormat","ProfileBrowserLink","ProfileBrowserTypes","React","URI","cx"],function(a,b,c,d,e,f,g,h,i,j,k,l){"use strict";var m=function(o,p){var q=new k('/ajax/like/tooltip.php').setQueryData({comment_fbid:o.fbid,comment_from:o.author,comment_likecount:o.likecount||0,comment_id:o.id,cache_buster:o.likeconfirmhash||0});if(p)q.addQueryData({viewas:p});return q;},n=j.createClass({displayName:'UFICommentLikeCount',propTypes:{comment:j.PropTypes.object.isRequired,contextArgs:j.PropTypes.object.isRequired},render:function(){var o=this.props.comment,p=g.formatIntegerWithDelimiter(o.likecount||0,this.props.contextArgs.numberdelimiter),q=i.LIKES,r={id:o.fbid},s=m(this.props.comment,this.props.contextArgs.viewas),t=j.createElement(j.DOM.i,{className:"UFICommentLikeIcon"}),u=j.createElement(j.DOM.span,null,p),v=(("UFICommentLikeButton")+(this.props.comment.hasviewerliked?' '+"UFICommentLikedButton":''));return (j.createElement(j.DOM.a,{ajaxify:h.constructDialogURI(q,r).toString(),className:v,'data-hover':"tooltip",'data-tooltip-alignh':"center",'data-tooltip-uri':s.toString(),href:h.constructPageURI(q,r).toString(),rel:"dialog",role:"button"},t,u));}});e.exports=n;},null);
__d("HelpLink.react",["React","joinClasses","TooltipLink.react"],function(a,b,c,d,e,f,g,h,i){var j=g.createClass({displayName:'HelpLink',render:function(){return (g.createElement(i,Object.assign({},this.props,{className:h(this.props.className,"uiHelpLink mls")}),undefined));}});e.exports=j;},null);
__d("UFICreatorInfo.react",["HelpLink.react","React","URI","cx","fbt"],function(a,b,c,d,e,f,g,h,i,j,k){"use strict";var l=h.createClass({displayName:'UFICreatorInfo',propTypes:{creatorID:h.PropTypes.number.isRequired,creatorType:h.PropTypes.string.isRequired,creatorName:h.PropTypes.string.isRequired,labelType:h.PropTypes.string.isRequired,pageID:h.PropTypes.number.isRequired,profileURI:h.PropTypes.string},render:function(){var m,n=this.getCreatorLink();switch(this.props.labelType){case 'commented':m=k._("Commented on by {creator}",[k.param("creator",n)]);break;case 'edited_comment':m=k._("Edited by {creator}",[k.param("creator",n)]);break;case 'sent_message':m=k._("Sent by {creator}",[k.param("creator",n)]);break;default:return;}return (h.createElement(h.DOM.span,null,m,h.createElement(g,{tooltip:this.getHelpText()})));},getCreatorLink:function(){switch(this.props.creatorType){case 'application':case 'gray_account':case 'indirect_admin':return (h.createElement(h.DOM.a,{className:"uiLinkSubtle",'aria-label':this.getTooltipText(),'data-hover':"tooltip"},this.props.creatorName));case 'direct_admin':return this.getProfileLinkWithHovercard();case 'former_admin':return (h.createElement(h.DOM.span,{className:"uiLinkSubtle"},h.createElement(h.DOM.img,{src:"/images/privacy/cant-see.png",width:9,height:9,className:"_3-8_"}),this.getProfileLinkWithHovercard()));default:return (h.createElement(h.DOM.span,{className:"uiLinkSubtle"},this.props.creatorName));}},getTooltipText:function(){switch(this.props.creatorType){case 'application':return this.getApplicationText();case 'gray_account':return this.getGrayAccountText();case 'indirect_admin':return this.getIndirectAdminText();}},getProfileLinkWithHovercard:function(){if(!this.props.profileURI)return h.createElement(h.DOM.span,null,this.props.creatorName);var m=new i('/ajax/hovercard/user.php').setQueryData({id:this.props.creatorID}).addQueryData({extragetparams:JSON.stringify({directed_target_id:this.props.pageID})});return (h.createElement(h.DOM.a,{className:"uiLinkSubtle",'data-hovercard':m,href:this.props.profileURI},this.props.creatorName));},getApplicationText:function(){switch(this.props.labelType){case 'commented':return (k._("This was commented on by someone using {application}.",[k.param("application",this.props.creatorName)]));case 'edited_comment':return (k._("This was edited by someone using {application}.",[k.param("application",this.props.creatorName)]));case 'sent_message':return (k._("This was sent by someone using {application}.",[k.param("application",this.props.creatorName)]));}},getIndirectAdminText:function(){switch(this.props.labelType){case 'commented':return (k._("This was commented on by someone from {page}.",[k.param("page",this.props.creatorName)]));case 'edited_comment':return (k._("This was edited by someone from {page}.",[k.param("page",this.props.creatorName)]));case 'sent_message':return (k._("This was sent by someone from {page}.",[k.param("page",this.props.creatorName)]));}},getGrayAccountText:function(){switch(this.props.labelType){case 'commented':return ("This was commented on by someone who doesn't have a personal Facebook account.");case 'edited_comment':return ("This was edited by someone who doesn't have a personal Facebook account.");case 'sent_message':return ("This was sent by someone who doesn't have a personal Facebook account.");}},getHelpText:function(){switch(this.props.labelType){case 'commented':return ("Only people who manage this Page can see who posted a comment");case 'edited_comment':return ("Only people who manage this Page can see who edited a comment");case 'sent_message':return ("Only people who manage this Page can see who sent a message");}}});e.exports=l;},null);
__d("UFICommentMetadata.react",["Bootloader","React","Timestamp.react","TrackingNodes","UFIConstants","URI","UFICreatorInfo.react","cx","tx"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){"use strict";var p=k.UFIStatus,q=' \u00b7 ',r="UFIFailureMessageIcon",s="UFIFailureMessage",t="uiLinkSubtle",u=function(w){var x=w.status;return x===p.FAILED_ADD||x===p.FAILED_EDIT;},v=h.createClass({displayName:'UFICommentMetadata',propTypes:{comment:h.PropTypes.object.isRequired,onRetrySubmit:h.PropTypes.func,permalink:h.PropTypes.string,shortenTimestamp:h.PropTypes.bool,showPermalink:h.PropTypes.bool},render:function(){var w=this.props.comment,x=this.props.permalink,y=this.props.onRetrySubmit,z,aa;if(u(w)){z=[h.createElement(h.DOM.span,{key:"failure",className:s},h.createElement(h.DOM.i,{className:r}),"Unable to post comment."),w.allowRetry&&y?[' ',h.createElement(h.DOM.a,{key:"rety-submit",onClick:y,href:"#",role:"button"},"Try Again")]:null];}else{var ba=this.props.showPermalink?x:null,ca=j.getTrackingInfo(j.types.SOURCE);aa=h.createElement(h.DOM.a,{key:"timestamp-message",className:t,href:ba,'data-ft':ca},h.createElement(i,{shorten:this.props.shortenTimestamp,time:w.timestamp.time,text:w.timestamp.text,verbose:w.timestamp.verbose}));}var da=null;if(w.originalTimestamp){var ea=new l('/ajax/edits/browser/comment').addQueryData({comment_token:w.id}).toString();da=[q,h.createElement(h.DOM.a,{ajaxify:ea,'aria-label':"Show edit history",className:"uiLinkSubtle",'data-hover':"tooltip",href:"#",key:"edit-link",ref:"EditLink",rel:"dialog",role:"button",title:"Show edit history"},"Edited")];}var fa=null;if(w.creator_data)fa=[h.createElement(m,{creatorID:w.creator_data.creatorID,creatorType:w.creator_data.creatorType,creatorName:w.creator_data.creatorName,labelType:w.creator_data.labelType,pageID:w.creator_data.pageID,profileURI:w.creator_data.profileURI}),q];return (h.createElement(h.DOM.span,null,fa,aa,z,da));},componentWillUpdate:function(w){var x=this.props.comment,y=w.comment;if(!x.editnux&&!!y.editnux)g.loadModules(["LegacyContextualDialog"],function(z){var aa=new z();aa.init(y.editnux).setContext(this.refs.EditLink.getDOMNode()).setWidth(300).setPosition('below').show();}.bind(this));}});e.exports=v;},null);
__d("UFIReplyLink.react",["React","tx"],function(a,b,c,d,e,f,g,h){var i=g.createClass({displayName:'UFIReplyLink',propTypes:{onClick:g.PropTypes.func},render:function(){return (g.createElement(g.DOM.a,{className:"UFIReplyLink",href:"#",onClick:this.props.onClick},"Reply"));}});e.exports=i;},null);
__d("UFISpamCount",["UFISpamCountImpl"],function(a,b,c,d,e,f){e.exports=b('UFISpamCountImpl').module||{enabled:false};},null);
__d("UFICommentActions.react",["React","TrackingNodes","UFICommentLikeCount.react","UFICommentMetadata.react","UFIConstants","UFIReplyLink.react","UFISpamCount","cx","fbt","tx"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){"use strict";var q=k.UFIStatus,r=' \u00b7 ',s="fsm fwn fcg UFICommentActions",t="UFIDeletedMessageIcon",u="UFIDeletedMessage",v=g.createClass({displayName:'UFICommentActions',propTypes:{comment:g.PropTypes.object.isRequired,contextArgs:g.PropTypes.object.isRequired,feedback:g.PropTypes.object.isRequired,hideAsSpamForPageAdmin:g.PropTypes.bool,markedAsSpamHere:g.PropTypes.bool,onAlsoRecommendToggle:g.PropTypes.func,onCommentLikeToggle:g.PropTypes.func,onCommentReply:g.PropTypes.func,onMarkAsNotSpam:g.PropTypes.func,onPreviewRemove:g.PropTypes.func,onRetrySubmit:g.PropTypes.func,permalink:g.PropTypes.string,shortenTimestamp:g.PropTypes.bool,showPermalink:g.PropTypes.bool,showReplyLink:g.PropTypes.bool,viewerCanMarkNotSpam:g.PropTypes.bool},render:function(){var w=this.props,x=w.comment,y=w.permalink,z=w.feedback,aa=w.markedAsSpamHere,ba=x.status===q.SPAM_DISPLAY,ca=w.showReplyLink,da=w.hideAsSpamForPageAdmin,ea,fa,ga,ha,ia,ja,ka,la=!x.islocal&&x.status!==q.LIVE_DELETED;if(la){if(ba&&!aa){if(w.viewerCanMarkNotSpam)ea=g.createElement(g.DOM.a,{onClick:w.onMarkAsNotSpam,className:"UFICommentNotSpamLink",href:"#",role:"button"},"Unhide");if(da&&z.isthreaded&&x.cancomment&&ca)ia=g.createElement(l,{comment:x,onClick:w.onCommentReply,contextArgs:w.contextArgs});}else{if(x.viewercanlike){var ma=h.getTrackingInfo(x.hasviewerliked?h.types.UNLIKE_LINK:h.types.LIKE_LINK),na=x.hasviewerliked?"Unlike this comment":"Like this comment";fa=g.createElement(g.DOM.a,{className:"UFILikeLink",'data-ft':ma,href:"#",onClick:w.onCommentLikeToggle,role:"button",title:na},x.hasviewerliked?"Unlike":"Like");}if(z.isthreaded&&x.cancomment&&ca)ia=g.createElement(l,{comment:x,contextArgs:w.contextArgs,onClick:w.onCommentReply});if(x.likecount>0)ga=g.createElement(i,{comment:x,contextArgs:w.contextArgs});if(x.spamcount&&m.enabled)ha=g.createElement(m,{count:x.spamcount});}if(w.contextArgs.canaddrecommendation&&x.hasrecommendation){var oa=("Also recommend the recommendations in this comment");if(x.hasviewerrecommended){ka=g.createElement(g.DOM.span,null,"Recommended");}else ka=g.createElement(g.DOM.a,{className:"UFIRecommendLink",href:"#",onClick:w.onAlsoRecommendToggle,role:"button",title:oa},"Recommend");}if(x.attachment&&x.attachment.type=="share"&&x.canremove)ja=g.createElement(g.DOM.a,{href:"#",onClick:w.onPreviewRemove,role:"button"},"Remove Preview");}var pa=g.createElement(j,{comment:x,onRetrySubmit:w.onRetrySubmit,permalink:y,shortenTimestamp:w.shortenTimestamp,showPermalink:w.showPermalink}),qa;if(z.isqanda){qa={likeCount:ga,spamCount:ha,likeToggle:fa,commentReply:ia,spamToggle:ea,metadata:pa,removePreview:ja};}else if(w.contextArgs.entstream){qa={metadata:pa,likeToggle:fa,likeCount:ga,alsoRecommend:ka,commentReply:ia,spamCount:ha,spamToggle:ea,removePreview:ja};}else if(z.isthreaded){qa={likeToggle:fa,commentReply:ia,spamToggle:ea,removePreview:ja,likeCount:ga,spamCount:ha,metadata:pa};}else qa={metadata:pa,likeToggle:fa,likeCount:ga,alsoRecommend:ka,spamCount:ha,commentReply:ia,spamToggle:ea,removePreview:ja};if(x.status===q.LIVE_DELETED){var ra=g.createElement(g.DOM.span,{className:u},g.createElement(g.DOM.i,{className:t,'data-hover':"tooltip",'aria-label':"Comment deleted"}));qa.deletionWarning=ra;}var sa=true,ta={};for(var ua in qa){var va=qa[ua];if(va){ta[ua]=sa?va:{MIDDOT:r,action:va};sa=false;}}return (g.createElement(g.DOM.div,{className:s},ta));}});e.exports=v;},null);
__d("UFICommentAttachment.react",["DOM","HTML","React","Sticker.react"],function(a,b,c,d,e,f,g,h,i,j){var k=80,l=i.createClass({displayName:'UFICommentAttachment',propTypes:{comment:i.PropTypes.object.isRequired},_attachmentFromCommentData:function(m){return m.photo_comment||m.attachment;},_getScaledDimensions:function(m,n){var o,p,q;if(n>m){q=k/n;o=m*q;p=n*q;}else{q=k/m;o=m*q;p=n*q;}return {height:Math.round(o),width:Math.round(p)};},componentDidMount:function(){var m=this._attachmentFromCommentData(this.props.comment);if(m)this.renderAttachment(m);},shouldComponentUpdate:function(m,n){var o=this._attachmentFromCommentData(this.props.comment),p=this._attachmentFromCommentData(m.comment);if(!o&&!p)return false;if(!o||!p||o.markup!=p.markup){return true;}else return false;},componentDidUpdate:function(m){var n=this._attachmentFromCommentData(this.props.comment);if(n.type!=='sticker')this.renderAttachment(n);},renderAttachment:function(m){if(m&&this.refs&&this.refs.contents&&m.markup){var n=m.markup;if(h.isHTML(n.markup))n=h.replaceJSONWrapper(n.markup).getRootNode();var o=n.parentNode,p=this.refs.contents.getDOMNode();if(o&&o!==p)n=n.cloneNode(true);g.setContent(p,n);}},renderSticker:function(m){var n=this._getScaledDimensions(m.metadata.height,m.metadata.width);return (i.createElement(j,{animationTrigger:"load_and_hover",frameCount:m.metadata.frameCount,framesPerCol:m.metadata.framesPerCol,framesPerRow:m.metadata.framesPerRow,spriteURI:m.metadata.sprite_uri,sourceHeight:n.height,sourceURI:m.metadata.source_uri,sourceWidth:n.width}));},render:function(){var m=this._attachmentFromCommentData(this.props.comment);if(m)if(m&&m.type==='sticker'){return this.renderSticker(m);}else return i.createElement(i.DOM.div,{ref:"contents"});return i.createElement(i.DOM.span,null);}});e.exports=l;},null);
__d("XUIEditButton.react",["XUIAbstractGlyphButton.react","React","cx","tx","joinClasses"],function(a,b,c,d,e,f,g,h,i,j,k){var l=h.createClass({displayName:'XUIEditButton',render:function(){var m=this.props.label,n=this.props.title;if(!this.props.title&&!this.props.tooltip){if(!m)m="Edit";n=m;}return (h.createElement(g,Object.assign({},this.props,{label:m,title:n,'aria-label':this.props.tooltip,'data-hover':this.props.tooltip&&'tooltip','data-tooltip-alignh':this.props.tooltip&&'center',className:k(this.props.className,"_5upq _5upr")})));}});e.exports=l;},null);
__d("UFICommentMenu.react",["Bootloader","React","XUICloseButton.react","XUIEditButton.react","keyMirror"],function(a,b,c,d,e,f,g,h,i,j,k){"use strict";var l,m,n,o,p=k({EDIT:true,CLOSE:true}),q=h.createClass({displayName:'UFICommentMenu',propTypes:{menuData:h.PropTypes.array,menuType:h.PropTypes.oneOf(Object.keys(p)).isRequired,onAction:h.PropTypes.func,onClick:h.PropTypes.func},getInitialState:function(){return {bootloading:false,bootloaded:false,needsExpand:false};},onClickGuard:function(event){if(this.state.bootloading){return;}else if(!this.state.bootloaded&&this.props.menuData){this.setState({bootloading:true});g.loadModules(["ContextualDialogArrow","PopoverMenu.react","ReactXUIMenu"],function(r,s,t){l=r,m=s;n=t;o=n.Item;this.setState({bootloading:false,bootloaded:true,needsExpand:true});}.bind(this));}else if(this.props.onClick)this.props.onClick(event);},shouldComponentUpdate:function(r,s,t){if(this.state.needsExpand&&!s.needsExpand)return false;return true;},render:function(){var r=null;if(this.props.menuType===p.EDIT){r=j;}else r=i;if(this.props.menuData&&this.state.bootloaded){var s=this.props.menuData.map(function(u){return (h.createElement(o,{value:u.value},u.label));}),t=h.createElement(n,{onItemClick:this.props.onAction},s);return (h.createElement(m,Object.assign({},this.props,{alignh:"right",layerBehaviors:[l],menu:t,ref:"menu"}),h.createElement(r,{href:"#",onClick:this.onClickGuard})));}return h.createElement(r,Object.assign({},this.props,{href:"#",onClick:this.onClickGuard}));},componentDidUpdate:function(){if(this.state.needsExpand){this.refs.menu.showPopover();this.setState({needsExpand:false});}}});q.MenuType=p;e.exports=q;},null);
__d("UFISocialContext.react",["HovercardLink","ProfileBrowserLink","ProfileBrowserTypes","React","URI","tx"],function(a,b,c,d,e,f,g,h,i,j,k,l){"use strict";var m=27,n=j.createClass({displayName:'UFISocialContext',propTypes:{commentAuthor:j.PropTypes.object.isRequired,otherMutualCount:j.PropTypes.number.isRequired,topMutualFriend:j.PropTypes.object.isRequired},render:function(){var o=this.props.topMutualFriend,p=this.props.otherMutualCount,q=this.props.commentAuthor,r=g.constructEndpoint(o).toString(),s=j.createElement(j.DOM.a,{href:o.uri,'data-hovercard':r,key:"top"},o.name),t=q.name.length+o.name.length,u;if(p===0){u=l._("Friends with {name}",{name:s});}else if(t<m){var v;if(p==1){v="1 other";}else v=l._("{count} others",{count:p});u=l._("Friends with {name} and {others}",{name:s,others:this.getOthersLink(v,q,o)});}else{var w=l._("{count} mutual friends",{count:p+1});u=this.getOthersLink(w,q);}return (j.createElement(j.DOM.span,{className:"UFICommentSocialContext"},u));},getOthersLink:function(o,p,q){var r=i.MUTUAL_FRIENDS,s={uid:p.id},t=new k('/ajax/mutual_friends/tooltip.php').setQueryData({friend_id:p.id});if(q)t.addQueryData({exclude_id:q.id});var u=h.constructDialogURI(r,s).toString();return (j.createElement(j.DOM.a,{ajaxify:u,'data-hover':"tooltip",'data-tooltip-alignh':"center",'data-tooltip-uri':t.toString(),href:h.constructPageURI(r,s).toString(),key:"others",rel:"dialog"},o));}});e.exports=n;},null);
__d("UFIComment.react",["Badge.react","Bootloader","HovercardLink","HovercardLinkInterpolator","InlineStoryInsert","Locale","React","TrackingNodes","TruncatedTextWithEntities.react","UFIActor.react","UFIClassNames","UFICommentActions.react","UFICommentAttachment.react","UFICommentMenu.react","UFIConfig","UFIConstants","UFIImageBlock.react","UFISocialContext.react","UnicodeBidi","URI","XUICloseButton.react","cx","joinClasses","keyMirror","tx"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea){"use strict";var fa=v.UFIStatus,ga=da({edit:true,hide:true,remove:true}),ha="UFITranslateLink",ia="UFITranslatedText",ja="pls",ka="fcg",la=null,ma=function(pa){var qa=pa.status;return qa===fa.FAILED_ADD||qa===fa.FAILED_EDIT;};function na(pa){return pa.commenterIsFOF!==undefined&&pa.userIsMinor!==undefined&&pa.reportLink!==undefined;}var oa=m.createClass({displayName:'UFIComment',propTypes:{authorProfiles:m.PropTypes.object.isRequired,comment:m.PropTypes.object.isRequired,contextArgs:m.PropTypes.object.isRequired,feedback:m.PropTypes.object.isRequired,'data-ft':m.PropTypes.string,focusOnMount:m.PropTypes.bool,hasPartialBorder:m.PropTypes.bool,hideAsSpamForPageAdmin:m.PropTypes.bool,isFeatured:m.PropTypes.bool,isFirst:m.PropTypes.bool,isFirstCommentComponent:m.PropTypes.bool,isFirstComponent:m.PropTypes.bool,isLast:m.PropTypes.bool,isLastCommentComponent:m.PropTypes.bool,isLastComponent:m.PropTypes.bool,isLocallyComposed:m.PropTypes.bool,isReply:m.PropTypes.bool,onAlsoRecommendToggle:m.PropTypes.func,onBlingBoxClick:m.PropTypes.func,onCommentLikeToggle:m.PropTypes.func,onCommentReply:m.PropTypes.func,onCommentTranslate:m.PropTypes.func,onEdit:m.PropTypes.func,onHideAsSpam:m.PropTypes.func,onInlineBan:m.PropTypes.func,onMarkAsNotSpam:m.PropTypes.func,onPreviewRemove:m.PropTypes.func,onRemove:m.PropTypes.func,onRetrySubmit:m.PropTypes.func,onUndoInlineBan:m.PropTypes.func,permalink:m.PropTypes.string,shortenTimestamp:m.PropTypes.bool,showPermalink:m.PropTypes.bool,showRemoveReportMenu:m.PropTypes.bool,showReplies:m.PropTypes.bool,showReplyLink:m.PropTypes.bool,viewerIsAuthor:m.PropTypes.bool},getInitialState:function(){return {isHighlighting:this.props.comment.highlightcomment,wasHighlighted:this.props.comment.highlightcomment,markedAsSpamHere:false,isInlinePageDeleted:false,isInlineBanned:false};},_onHideAsSpam:function(event){this.props.onHideAsSpam(event);this.setState({markedAsSpamHere:true});},_onMarkAsNotSpam:function(event){this.props.onMarkAsNotSpam(event);this.setState({markedAsSpamHere:false});},_onDeleteSpam:function(event){this.props.onRemove(event,this);},_onInlineBan:function(event){this.props.onInlineBan(event);this.setState({isInlineBanned:true});},_onUndoInlineBan:function(event){this.props.onUndoInlineBan(event);this.setState({isInlineBanned:false});},_onAction:function(event,pa){var qa=pa.item,ra=qa.getValue();setTimeout(function(){if(ra===ga.remove){this.props.onRemove(event);}else if(ra===ga.edit){this.props.onEdit(event);}else if(ra===ga.hide)this._onHideAsSpam(event);}.bind(this),0);},_createRemoveReportMenuData:function(){return [{value:ga.remove,label:"Delete Comment..."},{value:ga.hide,label:"Hide Comment"}];},_createEditDeleteMenuData:function(){return [{value:ga.edit,label:"Edit..."},{value:ga.remove,label:"Delete..."}];},_renderCloseButton:function(){var pa=this.props.comment,qa=this.props.feedback,ra=null,sa=null,ta=null,ua=false;if(pa.canremove&&!this.props.hideAsSpamForPageAdmin){if(this.props.viewerIsAuthor){if(pa.canedit){ta="Edit or Delete";sa=this._createEditDeleteMenuData();ua=true;}else{ta="Remove";ra=this.props.onRemove;}}else if(qa.canremoveall)if(this.props.showRemoveReportMenu){ta="Remove or Report";sa=this._createRemoveReportMenuData();}else{ta="Remove";ra=this.props.onRemove;}}else if(pa.canreport){ta="Hide";ra=this._onHideAsSpam;}var va=(("UFICommentCloseButton")+(ra===null&&sa===null?' '+"hdn":'')),wa=null,xa=null;if(this.props.contextArgs.viewas){wa="/ajax/profile/link_disabled_in_viewas.php";xa="dialog";ra=null;}var ya=ua?t.MenuType.EDIT:t.MenuType.CLOSE;return (m.createElement(t,{ajaxify:wa,className:va,onClick:ra,rel:xa,tooltip:ta,menuData:sa,menuType:ya,onAction:this._onAction}));},_renderFakeCloseButton:function(){return (m.createElement(aa,{className:"UFICommentCloseButtonFake",tabIndex:"-1"}));},componentDidMount:function(){if(this.state.isHighlighting){var pa=this.getDOMNode();if(this.props.storyInsert&&k._notifStoryUFI(pa)){h.loadModules(["UFIHighlight"],function(qa){setTimeout(qa.actOn.bind(null,pa),0);});}else h.loadModules(["UFIScrollHighlight"],function(qa){setTimeout(qa.actOn.bind(null,pa),0);});this.setState({isHighlighting:false});}},shouldComponentUpdate:function(pa,qa){var ra=this.props,sa=this.state;return (pa.comment!==ra.comment||pa.showReplyLink!==ra.showReplyLink||pa.showReplies!==ra.showReplies||pa.isFirst!==ra.isFirst||pa.isLast!==ra.isLast||pa.isFirstCommentComponent!==ra.isFirstCommentComponent||pa.isLastCommentComponent!==ra.isLastCommentComponent||pa.isFirstComponent!==ra.isFirstComponent||pa.isLastComponent!==ra.isLastComponent||pa.isFeatured!==ra.isFeatured||pa.hasPartialBorder!==ra.hasPartialBorder||qa.wasHighlighted!==sa.wasHighlighted||qa.isHighlighting!==sa.isHighlighting||qa.markedAsSpamHere!==sa.markedAsSpamHere||qa.isInlinePageDeleted!==sa.isInlinePageDeleted||qa.isInlineBanned!==sa.isInlineBanned);},render:function(){var pa=this.props.comment,qa=this.props.feedback,ra=pa.status===fa.DELETED,sa=pa.status===fa.LIVE_DELETED,ta=pa.status===fa.SPAM_DISPLAY,ua=this.state.markedAsSpamHere,va=this.state.isInlinePageDeleted,wa=this.props.hideAsSpamForPageAdmin,xa=this.state.isInlineBanned,ya=na(pa),za=!pa.status&&(pa.isunseen||pa.islocal);if(!pa.status&&qa.lastseentime){var ab=pa.originalTimestamp||pa.timestamp.time;za=za||ab>qa.lastseentime;}var bb=this.props.contextArgs.markedcomments;if(bb&&bb[pa.legacyid])za=true;var cb=((this.props.isFirst?"UFIFirstComment":'')+(this.props.isLast?' '+"UFILastComment":'')+(this.props.isFirstCommentComponent?' '+"UFIFirstCommentComponent":'')+(this.props.isLastCommentComponent?' '+"UFILastCommentComponent":'')+(this.props.isFirstComponent?' '+"UFIFirstComponent":'')+(this.props.isLastComponent?' '+"UFILastComponent":''));if(ya)if(la){var db,eb=null,fb=null,gb=null;if(wa){fb=xa?this._onUndoInlineBan:this._onInlineBan;if(va){db="You've deleted this comment so no one can see it.";}else if(ua){db="Now this is only visible to the person who wrote it and their friends.";gb=this._onDeleteSpam;eb=this._onMarkAsNotSpam;}}else if(ua){db="This comment has been hidden.";gb=this._onDeleteSpam;eb=this._onMarkAsNotSpam;}if(db)return (m.createElement(m.DOM.li,{className:ca(q.ROW,cb,"UFIHide")},m.createElement(la,{notice:db,comment:this.props.comment,authorProfiles:this.props.authorProfiles,onUndo:eb,onBanAction:fb,onDeleteAction:gb,isInlineBanned:xa,isInlinePageDeleted:va,hideAsSpamForPageAdmin:wa,pageID:this.props.feedback.ownerid})));}else h.loadModules(["UFICommentRemovalControls.react"],function(kb){la=kb;setTimeout(function(){this.forceUpdate();}.bind(this));}.bind(this));var hb=!ra,ib=ca(q.ROW,cb,(("UFIComment")+(ma(pa)?' '+"UFICommentFailed":'')+(ra||sa||ta?' '+"UFITranslucentComment":'')+(this.state.isHighlighting?' '+"highlightComment":'')+(!hb?' '+"noDisplay":'')+(hb?' '+"display":'')+(' '+"UFIComponent")+(this.props.isFeatured&&!this.props.contextArgs.showverified?' '+"UFIFeaturedComment":'')+(this.props.hasPartialBorder?' '+"UFIPartialBorder":''))),jb=this.renderComment();if(za)ib=ca(ib,q.UNSEEN_ITEM);return (m.createElement(m.DOM.li,{className:ib,'data-ft':this.props['data-ft']},jb));},renderComment:function(){var pa=this.props,qa=pa.comment,ra=pa.permalink,sa=pa.feedback,ta=pa.authorProfiles[qa.author],ua=qa.status===fa.SPAM_DISPLAY,va=qa.status===fa.LIVE_DELETED,wa=!(ua||va),xa=sa.canremoveall||qa.hiddenbyviewer,ya=null,za=null;if(!pa.isLocallyComposed&&!this.state.wasHighlighted&&!qa.fromfetch){za=v.commentTruncationLength;ya=v.commentTruncationMaxLines;}var ab=n.getTrackingInfo(n.types.SMALL_ACTOR_PHOTO),bb=n.getTrackingInfo(n.types.USER_NAME),cb=n.getTrackingInfo(n.types.USER_MESSAGE),db=null,eb=null;if(qa.istranslatable&&(qa.translatedtext===undefined))db=m.createElement(m.DOM.a,{href:"#",role:"button",title:"Translate this comment",className:ha,onClick:pa.onCommentTranslate},"See Translation");if(qa.translatedtext){var fb=new z('http://bing.com/translator').addQueryData({text:qa.body.text});eb=m.createElement(m.DOM.span,{className:ia},qa.translatedtext,m.createElement(m.DOM.span,{className:ja},' ',"(",m.createElement(m.DOM.a,{href:fb.toString(),target:"_blank",className:ka},"Translated by Bing"),")"));}var gb=y.isDirectionLTR(qa.body.text),hb=!gb,ib=gb&&l.isRTL()?'ltr':hb&&!l.isRTL()?'rtl':null,jb=function(rb,sb){return j(rb,sb,'_blank',sa.grouporeventid,'ufi',v.commentURLTruncationLength);},kb=m.createElement(o,{key:"comment-body",className:(("UFICommentBody")+(this.props.contextArgs.useWhitespacesRender?' '+"UFICommentBodyPreserveWhitespace":'')),interpolator:jb,ranges:qa.body.ranges,text:qa.body.text,truncationPercent:v.commentTruncationPercent,maxLength:za,maxLines:ya,renderEmoticons:u.renderEmoticons,renderEmoji:u.renderEmoji,'data-ft':cb,dir:ib});if(qa.socialcontext){kb=m.createElement(m.DOM.div,{key:"body"},kb);}else{var lb=((gb&&l.isRTL()?"_5wjy":'')+(gb&&l.isRTL()?' '+"_5wjz":'')+(hb&&!l.isRTL()?' '+"_5wj-":'')+(hb&&!l.isRTL()?' '+"_5wj_":''));kb=lb?m.createElement(m.DOM.div,{key:"body",className:lb},kb):[' ',kb];}var mb=pa.contextArgs.viewas?null:i.constructEndpointWithLocation(ta,'ufi').toString(),nb=m.createElement(p,{author:ta,showHovercard:!!mb,key:"author",focusOnMount:pa.focusOnMount,'data-ft':bb},pa.isFeatured&&pa.contextArgs.showverified?m.createElement(g,{key:"badge",size:"xsmall",type:"verified"}):null,qa.socialcontext?m.createElement(x,{topMutualFriend:pa.authorProfiles[qa.socialcontext.topmutualid],otherMutualCount:qa.socialcontext.othermutualcount,commentAuthor:ta}):null),ob=null;if(qa.photo_comment_status)ob=m.createElement(m.DOM.div,{className:"_50f8"},qa.photo_comment_status);var pb=null;if(qa.sticker_attachment_status)pb=m.createElement(m.DOM.div,{className:"_50f8"},qa.sticker_attachment_status);var qb=null;if(qa.status!==fa.DELETED)qb=m.createElement(s,{comment:pa.comment});return (m.createElement(w,{spacing:"medium"},m.createElement(m.DOM.a,{href:ta.uri,'data-hovercard':mb,'data-ft':ab},m.createElement(m.DOM.img,{src:ta.thumbSrc,className:q.ACTOR_IMAGE,alt:""})),m.createElement(m.DOM.div,{className:"UFICommentContentBlock"},m.createElement(m.DOM.div,{className:"UFICommentContent"},nb,kb,db,eb,qb),ob,pb,m.createElement(r,{comment:qa,feedback:sa,onBlingBoxClick:pa.onBlingBoxClick,onAlsoRecommendToggle:pa.onAlsoRecommendToggle,onCommentLikeToggle:pa.onCommentLikeToggle,onCommentReply:pa.onCommentReply,onPreviewRemove:pa.onPreviewRemove,onRetrySubmit:pa.onRetrySubmit,onMarkAsNotSpam:this._onMarkAsNotSpam,permalink:ra,viewerCanMarkNotSpam:xa,shortenTimestamp:pa.shortenTimestamp,showPermalink:pa.showPermalink,showReplyLink:pa.showReplyLink,showReplies:pa.showReplies,contextArgs:pa.contextArgs,markedAsSpamHere:this.state.markedAsSpamHere,hideAsSpamForPageAdmin:pa.hideAsSpamForPageAdmin}),wa?this._renderCloseButton():null),wa?this._renderFakeCloseButton():null));}});e.exports=oa;},null);
__d("UFIContainer.react",["React","cx"],function(a,b,c,d,e,f,g,h){var i=g.createClass({displayName:'UFIContainer',render:function(){var j=null;if(this.props.hasNub)j=g.createElement(g.DOM.li,{className:"UFIArrow"},g.createElement(g.DOM.i,null));var k=((!this.props.isReplyList?"UFIList":'')+(this.props.isReplyList?' '+"UFIReplyList":'')+(this.props.isParentLiveDeleted?' '+"UFITranslucentReplyList":'')+(this.props.isFirstCommentComponent?' '+"UFIFirstCommentComponent":'')+(this.props.isLastCommentComponent?' '+"UFILastCommentComponent":'')+(this.props.isFirstComponent?' '+"UFIFirstComponent":'')+(this.props.isLastComponent?' '+"UFILastComponent":''));return (g.createElement(g.DOM.ul,{className:k},j,this.props.children));}});e.exports=i;},null);
__d("UFILikeSentenceText.react",["ActorURI","HovercardLinkInterpolator","ProfileBrowserLink","ProfileBrowserTypes","React","TextWithEntities.react","URI"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){function n(p,q,r,s){if(s.count!=null){var t=j.LIKES,u={id:p.targetfbid,actorid:p.actorid},v=[],w;for(var x=0;x<q.length;x++)if(!q[x].count){w=q[x];var y=w.entity;v.push(y.id);}var z=new m('/ajax/like/tooltip.php').setQueryData({comment_fbid:p.targetfbid,comment_from:p.actorforpost,seen_user_fbids:v.length?v:true});z=g.create(z,p.actorforpost);return (k.createElement(k.DOM.a,{rel:"dialog",ajaxify:i.constructDialogURI(t,u).toString(),href:i.constructPageURI(t,u).toString(),'data-hover':"tooltip",'data-tooltip-alignh':"center",'data-tooltip-uri':z.toString(),role:"button"},r));}else return h(r,s,null,null,'ufi');}var o=k.createClass({displayName:'UFILikeSentenceText',propTypes:{contextArgs:k.PropTypes.object.isRequired,feedback:k.PropTypes.object.isRequired,likeSentenceData:k.PropTypes.object.isRequired},render:function(){var p=this.props.feedback,q=this.props.likeSentenceData,r;r=n;r=r.bind(null,p,q.ranges);return (k.createElement(l,{interpolator:r,ranges:q.ranges,aggregatedRanges:q.aggregatedranges,text:q.text}));}});e.exports=o;},null);
__d("UFILikeSentence.react",["Bootloader","LeftRight.react","ProfileBrowserLink","ProfileBrowserTypes","React","UFIClassNames","UFIImageBlock.react","UFILikeSentenceText.react","URI","cx","joinClasses","tx"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){var s=k.createClass({displayName:'UFILikeSentence',propTypes:{contextArgs:k.PropTypes.object.isRequired,feedback:k.PropTypes.object.isRequired,isFirstComponent:k.PropTypes.bool,isLastComponent:k.PropTypes.bool,onOrderingModeChange:k.PropTypes.func,onTargetLikeToggle:k.PropTypes.func,orderingMode:k.PropTypes.string,showOrderingModeSelector:k.PropTypes.bool},getInitialState:function(){return {selectorModule:null,bootloadedSelectorModule:false};},componentWillMount:function(){this._bootloadSelectorModule(this.props);},componentWillReceiveProps:function(t){this._bootloadSelectorModule(t);},_bootloadSelectorModule:function(t){if(t.showOrderingModeSelector&&!this.state.bootloadedSelectorModule){var u=function(v){this.setState({selectorModule:v});}.bind(this);if(t.contextArgs.entstream){g.loadModules(["UFIEntStreamOrderingModeSelector.react"],u);}else g.loadModules(["UFIOrderingModeSelector.react"],u);this.setState({bootloadedSelectorModule:true});}},render:function(){var t=this.props.feedback,u=t.likesentences.current,v=this.props.contextArgs.entstream,w=q(l.ROW,t.likesentences.isunseen?l.UNSEEN_ITEM:'',(("UFILikeSentence")+(this.props.isFirstComponent?' '+"UFIFirstComponent":'')+(this.props.isLastComponent?' '+"UFILastComponent":''))),x=null,y=null;if(u.text)y=k.createElement(k.DOM.div,{className:"UFILikeSentenceText"},k.createElement(n,{contextArgs:this.props.contextArgs,feedback:t,likeSentenceData:u}));if(y&&!v){x=k.createElement(k.DOM.i,{className:"UFILikeIcon"});if(t.viewercanlike&&!t.hasviewerliked)x=k.createElement(k.DOM.a,{className:"UFILikeThumb",href:"#",tabIndex:"-1",title:"Like this",onClick:this.props.onTargetLikeToggle,role:"button",'aria-label':"Like this"},x);}var z=y,aa=null;if(t.seencount>0&&!v){var ba=j.GROUP_MESSAGE_VIEWERS,ca={id:t.targetfbid},da=i.constructDialogURI(ba,ca),ea=i.constructPageURI(ba,ca),fa=new o('/ajax/ufi/seen_tooltip.php').setQueryData({ft_ent_identifier:t.entidentifier,displayed_count:t.seencount}),ga;if(t.seenbyall){ga="Seen by everyone";}else ga=t.seencount==1?"Seen by 1":r._("Seen by {count}",{count:t.seencount});aa=k.createElement(k.DOM.a,{rel:"dialog",ajaxify:da.toString(),href:ea.toString(),'data-hover':"tooltip",'data-tooltip-alignh':"left",'data-tooltip-uri':fa.toString(),className:(("UFISeenCount")+(!!u.text?' '+"UFISeenCountRight":''))},k.createElement(k.DOM.span,{className:"UFISeenCountIcon"}),ga);}else if(this.props.showOrderingModeSelector&&this.state.selectorModule){var ha=this.state.selectorModule;aa=k.createElement(ha,{currentOrderingMode:this.props.orderingMode,entstream:v,orderingmodes:t.orderingmodes,onOrderChanged:this.props.onOrderingModeChange});if(!z)z=k.createElement(k.DOM.div,null);}var ia=null;if(x&&y){ia=k.createElement(m,null,x,y,aa);}else if(z){ia=k.createElement(h,{direction:h.DIRECTION.right},z,aa);}else ia=aa;return (k.createElement(k.DOM.li,{className:w},ia));}});e.exports=s;},null);
__d("UFIPager.react",["LeftRight.react","React","UFIClassNames","UFIImageBlock.react","XUISpinner.react","cx","joinClasses"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){var n=h.createClass({displayName:'UFIPager',propTypes:{contextArgs:h.PropTypes.object.isRequired,pagerLabel:h.PropTypes.string.isRequired,'data-ft':h.PropTypes.string,countSentence:h.PropTypes.string,isFirstCommentComponent:h.PropTypes.bool,isFirstComponent:h.PropTypes.bool,isLastCommentComponent:h.PropTypes.bool,isLastComponent:h.PropTypes.bool,isLoading:h.PropTypes.bool,isUnseen:h.PropTypes.bool,onPagerClick:h.PropTypes.func},onPagerClick:function(o){!this.props.isLoading&&this.props.onPagerClick&&this.props.onPagerClick();o.nativeEvent.prevent();},render:function(){var o=this.onPagerClick,p=m(i.ROW,this.props.isUnseen?i.UNSEEN_ITEM:'',(("UFIPagerRow")+(' '+"UFIComponent")+(this.props.isFirstCommentComponent?' '+"UFIFirstCommentComponent":'')+(this.props.isLastCommentComponent?' '+"UFILastCommentComponent":'')+(this.props.isFirstComponent?' '+"UFIFirstComponent":'')+(this.props.isLastComponent?' '+"UFILastComponent":''))),q=null;if(this.props.isLoading)q=h.createElement(k,{className:"mls",background:"light",size:"small"});var r=h.createElement(h.DOM.a,{className:"UFIPagerLink",onClick:o,href:"#",role:"button"},this.props.pagerLabel,q),s=(("fcg")+(' '+"UFIPagerCount")),t=h.createElement(h.DOM.span,{className:s},this.props.countSentence),u;if(this.props.contextArgs.entstream){u=(h.createElement(g,{direction:g.DIRECTION.right},r,t));}else u=(h.createElement(j,null,h.createElement(h.DOM.a,{className:"UFIPagerIcon",onClick:o,href:"#",role:"button"}),r,t));return (h.createElement(h.DOM.li,{className:p,'data-ft':this.props['data-ft']},u));}});e.exports=n;},null);
__d("UFIPagerLabel",["fbt","tx"],function(a,b,c,d,e,f,g,h){var i={VIEW_ONE:'view_one',VIEW_ONE_MORE:'view_one_more',VIEW_ALL:'view_all',VIEW_MORE_EXPLICIT:'view_more_explicit',VIEW_MORE:'view_more',VIEW_PREVIOUS:'view_previous',getReplyLabel:function(j,k){switch(j){case i.VIEW_ONE:return "View 1 reply";case i.VIEW_ONE_MORE:return "View 1 more reply";case i.VIEW_ALL:return h._("View all {count} replies",{count:k.count});case i.VIEW_MORE_EXPLICIT:return h._("View {count} more replies",{count:k.count});case i.VIEW_MORE:return "View more replies";case i.VIEW_PREVIOUS:return "View previous replies";default:return null;}},getCommentLabel:function(j,k){switch(j){case i.VIEW_ONE:return "View 1 comment";case i.VIEW_ONE_MORE:return "View 1 more comment";case i.VIEW_ALL:return h._("View all {count} comments",{count:k.count});case i.VIEW_MORE_EXPLICIT:return h._("View {count} more comments",{count:k.count});case i.VIEW_MORE:return "View more comments";case i.VIEW_PREVIOUS:return "View previous comments";default:return null;}},getQuestionLabel:function(j,k){switch(j){case i.VIEW_ONE:return "View 1 question";case i.VIEW_ONE_MORE:return "View 1 more question";case i.VIEW_ALL:return g._("View all {count} questions",[g.param("count",k.count)]);case i.VIEW_MORE_EXPLICIT:return g._("View {count} more questions",[g.param("count",k.count)]);case i.VIEW_MORE:return "View more questions";case i.VIEW_PREVIOUS:return "View previous questions";default:return null;}},getLabel:function(j,k,l,m){if(k){return i.getReplyLabel(j,m);}else if(l){return i.getQuestionLabel(j,m);}else return i.getCommentLabel(j,m);}};e.exports=i;},null);
__d("UFIReplySocialSentence.react",["Badge.react","LiveTimer","React","Timestamp.react","UFIClassNames","UFIConstants","UFIImageBlock.react","cx","joinClasses","tx"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){var q=' \u00b7 ',r=43200,s=i.createClass({displayName:'UFIReplySocialSentence',propTypes:{authors:i.PropTypes.object.isRequired,'data-ft':i.PropTypes.string,isExpanded:i.PropTypes.bool,isFirstComponent:i.PropTypes.bool,isLastComponent:i.PropTypes.bool,isLoading:i.PropTypes.bool,onClick:i.PropTypes.func,orderingMode:i.PropTypes.string,replies:i.PropTypes.number,shortenTimestamp:i.PropTypes.bool,showVerified:i.PropTypes.bool,timestamp:i.PropTypes.object},render:function(){var t=((this.props.isLoading?"UFIReplySocialSentenceLoading":'')),u=o(k.ROW,(("UFIReplySocialSentenceRow")+(this.props.isFirstComponent?' '+"UFIFirstComponent":'')+(this.props.isLastComponent?' '+"UFILastComponent":''))),v,w;if(this.props.isExpanded){v=this.props.replies>1?p._("Hide {count} Replies",{count:this.props.replies}):"Hide 1 Reply";}else{v=this.props.replies>1?p._("{count} Replies",{count:this.props.replies}):"1 Reply";if(this.props.timestamp){var x=h.getApproximateServerTime()/1000-this.props.timestamp.time;if(x<r||this.props.orderingMode==l.UFICommentOrderingMode.RECENT_ACTIVITY)w=i.createElement(i.DOM.span,{className:"fcg"},q,i.createElement(j,{shorten:this.props.shortenTimestamp,time:this.props.timestamp.time,text:this.props.timestamp.text,verbose:this.props.timestamp.verbose}));}}var y=Object.keys(this.props.authors),z=y.length&&!this.props.isExpanded,aa=null,ba;if(z){var ca=this.props.authors[y[0]];aa=i.createElement(i.DOM.img,{alt:"",src:ca.thumbSrc,className:k.ACTOR_IMAGE});var da=ca.name;if(this.props.showVerified)da=[ca.name,i.createElement(g,{size:"xsmall",type:"verified"})];ba=[p._("{author} replied",{author:da}),q,v];}else ba=v;var ea=null,fa=false;if(!z||this.props.contextArgs.feedcarded){if(z)fa=true;ea=i.createElement(i.DOM.i,{className:((!this.props.isExpanded?"UFIPagerIcon":'')+(this.props.isExpanded?' '+"UFICollapseIcon":'')+(fa?' '+"UFIFeedCardedIconWithActor":''))});}return (i.createElement(i.DOM.li,{className:u,'data-ft':this.props['data-ft']},i.createElement(i.DOM.a,{className:"UFICommentLink",onClick:this.props.onClick,href:"#",role:"button"},i.createElement(m,null,i.createElement(i.DOM.div,{className:((z?"UFIReplyActorPhotoWrapper":'')+(fa?' '+"UFIFeedCardedReplyActor":''))},ea,aa),i.createElement(i.DOM.span,{className:t},i.createElement(i.DOM.span,{className:(("UFIReplySocialSentenceLinkText")+(this.props.showVerified?' '+"UFIReplySocialSentenceVerified":''))},ba),w)))));}});e.exports=s;},null);
__d("UFIShareRow.react",["NumberFormat","React","UFIClassNames","UFIImageBlock.react","URI","cx","joinClasses","tx"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){var o=h.createClass({displayName:'UFIShareRow',propTypes:{contextArgs:h.PropTypes.object.isRequired,shareCount:h.PropTypes.number.isRequired,targetID:h.PropTypes.any.isRequired,isFirstComponent:h.PropTypes.bool,isLastComponent:h.PropTypes.bool},render:function(){var p=new k('/ajax/shares/view').setQueryData({target_fbid:this.props.targetID}),q=new k('/shares/view').setSubdomain('www').setQueryData({id:this.props.targetID}),r;if(this.props.shareCount>1){var s=g.formatIntegerWithDelimiter(this.props.shareCount,this.props.contextArgs.numberdelimiter||',');r=n._("{count} shares",{count:s});}else r="1 share";var t=m(i.ROW,(("UFIShareRow")+(this.props.isFirstComponent?' '+"UFIFirstComponent":'')+(this.props.isLastComponent?' '+"UFILastComponent":'')));return (h.createElement(h.DOM.li,{className:t},h.createElement(j,null,h.createElement(h.DOM.a,{className:"UFIShareIcon",rel:"dialog",ajaxify:p.toString(),href:q.toString()}),h.createElement(h.DOM.a,{className:"UFIShareLink",rel:"dialog",ajaxify:p.toString(),href:q.toString()},r))));}});e.exports=o;},null);
__d("UFISpamPlaceholder.react",["React","UFIClassNames","XUISpinner.react","fbt","tx"],function(a,b,c,d,e,f,g,h,i,j,k){var l=g.createClass({displayName:'UFISpamPlaceholder',propTypes:{numHidden:g.PropTypes.number.isRequired,isLoading:g.PropTypes.bool,onClick:g.PropTypes.func},render:function(){if(this.props.isLoading)return (g.createElement(g.DOM.li,{className:h.ROW},g.createElement(g.DOM.span,{className:"UFISpamCommentWrapper"},g.createElement(i,{className:"mls",background:"light",size:"small"}))));return (g.createElement(g.DOM.li,{className:h.ROW},g.createElement(g.DOM.a,{href:"#",role:"button",className:"UFISpamCommentLink",onClick:this.props.onClick,'aria-label':"Show comments marked as spam"},g.createElement(g.DOM.span,{'data-hover':"tooltip",'data-tooltip-alignh':"center",'aria-label':k._("{count} hidden",{count:this.props.numHidden}),className:"UFISpamCommentWrapper"},g.createElement(g.DOM.i,{className:"placeholderIcon"})))));}});e.exports=l;},null);
__d("UFIFeaturedReplyCommentList",["UFIReplyCommentList"],function(a,b,c,d,e,f,g){"use strict";for(var h in g)if(g.hasOwnProperty(h))j[h]=g[h];var i=g===null?null:g.prototype;j.prototype=Object.create(i);j.prototype.constructor=j;j.__superConstructor__=g;j.getCommentList=function(k,l){};function j(k,l,m,n){g.call(this,k,l);var o=0,p=m.length;this.updateCommentCount(p);this.addCommentIDs(o,p,m);var q={};n.forEach(function(r){q[r.id]=r;});m.forEach(function(r){var s=q[r];this.addComment(s.id,s.clientid,s.legacyid);}.bind(this));}j.prototype.fetchComments=function(k,l,m){};e.exports=j;},null);
__d("UFIFeaturedToplevelCommentList",["UFIConstants","UFIToplevelCommentList"],function(a,b,c,d,e,f,g,h){"use strict";for(var i in h)if(h.hasOwnProperty(i))k[i]=h[i];var j=h===null?null:h.prototype;k.prototype=Object.create(j);k.prototype.constructor=k;k.__superConstructor__=h;k.getCommentList=function(l,m){};k.getCommentListsForFeedbackTargetID=function(l){};k.getCommentListForFeedbackTargetID_UNSAFE=function(l){};k.resetCommentListsForFeedbackTargetID=function(l){};function k(l,m,n){h.call(this,l,g.UFICommentOrderingMode.FEATURED);var o=0,p=m.length;this.updateCommentCount(p);this.addCommentIDs(o,p,m);var q={};n.forEach(function(r){q[r.id]=r;});m.forEach(function(r){var s=q[r];this.addComment(s.id,s.clientid,s.legacyid);}.bind(this));}k.prototype.fetchComments=function(l,m,n){};e.exports=k;},null);
__d("UFIRange",[],function(a,b,c,d,e,f){"use strict";function g(h,i){this.offset=h||0;this.length=i||0;this.requestedOffset=this.offset;this.requestedLength=this.length;}g.prototype.getOffset=function(){return this.offset;};g.prototype.getLength=function(){return this.length;};g.prototype.updateRange=function(h,i){this.offset=h;this.length=i;if(this.requestedLength>0){var j=Math.min(this.offset,this.requestedOffset),k=Math.max(this.offset+this.length,this.requestedOffset+this.requestedLength);this.requestedOffset=j;this.requestedLength=k-j;}else{this.requestedOffset=this.offset;this.requestedLength=this.length;}};g.prototype.getRequestedOffset=function(){return this.requestedOffset;};g.prototype.getRequestedLength=function(){return this.requestedLength;};g.prototype.updateRequestedRange=function(h,i){this.requestedOffset=h;this.requestedLength=i;};e.exports=g;},null);
__d("UFIController",["Arbiter","Bootloader","CSS","DOM","LayerRemoveOnHide","LiveTimer","Parent","React","ReactMount","ShortProfiles","UFI.react","UFIActionLinkController","UFICentralUpdates","UFIFeaturedReplyCommentList","UFIFeaturedToplevelCommentList","UFICommentTemplates","UFIConstants","UFIFeedbackTargets","UFIInstanceState","UFIRange","UFIReplyCommentList","UFIToplevelCommentList","UFIUserActions","URI","isEmpty","onEnclosingPageletDestroy","tx"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa,ga){"use strict";var ha=function(la,ma,na,oa,pa){var qa=la+ma===na;return {offset:la,length:(qa&&ia(pa))?oa-la:ma};},ia=function(la){return la==w.UFIPayloadSourceType.USER_ACTION||la==w.UFIPayloadSourceType.LIVE_SEND;},ja=function(la,ma){for(var na=0;na<ma.length;na++){var oa=ma[na];if(oa.author)la.push(oa.author);if(oa.socialcontext)la.push(oa.socialcontext.topmutualid);if(oa.replyauthors&&oa.replyauthors.length)for(var pa=0;pa<oa.replyauthors.length;pa++)la.push(oa.replyauthors[pa]);}};function ka(la,ma,na){this.root=la;this.id=ma.ftentidentifier;this.source=ma.source;this.$UFIController0=ma.instanceid;this.featuredToplevelCommentList=null;this.featuredReplyCommentLists={};this.$UFIController1=ma;this.$UFIController1.rootid=this.root.id;this.$UFIController2=false;this.storyInsert=ma.storyInsert;var oa=na.feedbacktargets[0];this.actionLink=new r(la,this.$UFIController1,oa);this.orderingMode=oa.defaultcommentorderingmode;var pa=null;if(na.featuredcommentlists&&na.featuredcommentlists.comments&&na.featuredcommentlists.comments[this.id]){pa=na.featuredcommentlists.comments[this.id];this.featuredToplevelCommentList=new u(this.id,pa.values,na.comments);}else pa=na.commentlists.comments[this.id][this.orderingMode];this.ranges={};this.replyRanges={};this.repliesMap={};this.showRepliesMap={};this.showReplySocialSentenceMap={};this.shortenTimestamp=ma.shortenTimestamp;this.commentcounts={};this.commentcounts[this.id]=this.getToplevelCommentList().getCommentCount();var qa=oa.orderingmodes||[{value:this.orderingMode}];qa.forEach(function(ua){this.ranges[ua.value]=new z(pa.range.offset,pa.range.length);}.bind(this));var ra,sa,ta;if(na.commentlists.replies)for(ra=0;ra<pa.values.length;ra++){sa=pa.values[ra];ta=na.commentlists.replies[sa];if(ta){this.commentcounts[sa]=this.getReplyCommentList(sa).getCommentCount();this.getReplyRange(sa).updateRange(ta.range.offset,ta.range.length);}}if(na.featuredcommentlists)if(na.featuredcommentlists.replies)for(ra=0;ra<pa.values.length;ra++){sa=pa.values[ra];ta=na.featuredcommentlists.replies[sa];if(ta){this.featuredReplyCommentLists[sa]=new t(this.id,sa,ta.values,na.comments);this.commentcounts[sa]=this.getReplyCommentList(sa).getCommentCount();this.getReplyRange(sa).updateRange(ta.range.offset,ta.range.length);}}this.$UFIController3=null;this.$UFIController4=null;this.ufiCentralUpdatesSubscriptions=[s.subscribe('feedback-updated',function(ua,va){var wa=va.updates,xa=va.payloadSource;if(xa!=w.UFIPayloadSourceType.COLLAPSED_UFI&&this.id in wa)this.fetchAndUpdate(this.render.bind(this),xa);}.bind(this)),s.subscribe('feedback-id-changed',function(ua,va){var wa=va.updates;if(this.id in wa)this.id=wa[this.id];}.bind(this)),s.subscribe('instance-updated',function(ua,va){var wa=va.updates;if(this.$UFIController0 in wa){var xa=wa[this.$UFIController0];if(xa.editcommentid)this.render(va.payloadSource);}}.bind(this))];this.clearPageletSubscription=fa(this.root,this.$UFIController6.bind(this));this.clearPageSubscription=g.subscribe('ufi/page_cleared',this.$UFIController7.bind(this));s.handleUpdate(w.UFIPayloadSourceType.INITIAL_SERVER,na);if(this.$UFIController1.viewas)this.viewasUFICleanSubscription=g.subscribe('pre_page_transition',function(ua,va){if(this.$UFIController1.viewas!==da(va.to).getQueryData('viewas'))ba.resetCommentListsForFeedbackTargetID(this.id);}.bind(this));h.loadModules(["ScrollAwareDOM"],function(ua){o.scrollMonitor=ua.monitor;});if(ma.notifyonload)g.inform('inlineStory/ufiLoaded');g.inform('notifStory/ufiLoaded');}ka.prototype.$UFIController8=function(){if(!this.$UFIController9)this.$UFIController9=m.byTag(this.root,'form');return this.$UFIController9;};ka.prototype.$UFIControllera=function(event){var la=!this.feedback.hasviewerliked;ca.changeLike(this.id,la,{source:this.source,target:event.target,rootid:this.$UFIController1.rootid});event.preventDefault();};ka.prototype.$UFIControllerb=function(la,event){var ma=!la.hasviewerliked;ca.changeCommentLike(la.id,ma,{source:this.source,target:event.target});};ka.prototype.$UFIControllerc=function(la,event){ca.changeAlsoRecommend(la,!la.hasviewerrecommended);};ka.prototype.$UFIControllerd=function(la){y.updateState(this.$UFIController0,'isediting',true);y.updateState(this.$UFIController0,'editcommentid',la.id);};ka.prototype.$UFIControllere=function(la,ma,event){if(!ma.visibleValue&&!ma.attachedPhoto&&!ma.attachedSticker){this.$UFIControllerf(la,event);}else ca.editComment(la.id,ma.visibleValue,ma.encodedValue,{source:this.$UFIController1.source,target:event.target,attachedPhoto:ma.attachedPhoto,attachedSticker:ma.attachedSticker});y.updateStateField(this.$UFIController0,'locallycomposed',la.id,true);this.$UFIControllerg();};ka.prototype.$UFIControllerg=function(){y.updateState(this.$UFIController0,'isediting',false);y.updateState(this.$UFIController0,'editcommentid',null);};ka.prototype.$UFIControllerf=function(la,event,ma){this.$UFIControllerh(la,false,event,ma);};ka.prototype.$UFIControllerh=function(la,ma,event,na){var oa=v[':fb:ufi:hide-dialog-template'].build();j.setContent(oa.getNode('body'),"Are you sure you want to delete this comment?");j.setContent(oa.getNode('title'),"Delete Comment");h.loadModules(["DialogX"],function(pa){var qa=new pa({modal:true,width:465,addedBehaviors:[k]},oa.getRoot());qa.subscribe('confirm',function(){ca.removeComment(la.id,{source:this.source,oneclick:ma,target:event.target,timelinelogdata:this.$UFIController1.timelinelogdata});if(na)na.setState({isInlinePageDeleted:true});qa.hide();}.bind(this));qa.show();}.bind(this));};ka.prototype.$UFIControlleri=function(la,event){ca.setHideAsSpam(la.id,true,{source:this.source,target:event.target});};ka.prototype.$UFIControllerj=function(la,event){ca.setHideAsSpam(la.id,false,{source:this.source,target:event.target});};ka.prototype.$UFIControllerk=function(la,event){ca.translateComment(la,{source:this.source,target:event.target});};ka.prototype.$UFIControllerl=function(la,ma,event){ca.banUser(la,this.feedback.ownerid,ma,{source:this.source,target:event.target});};ka.prototype.$UFIControllerm=function(la,event){this.$UFIControllerl(la,true,event);};ka.prototype.$UFIControllern=function(la,event){this.$UFIControllerl(la,false,event);};ka.prototype.$UFIControllero=function(la,ma){ca.fetchSpamComments(this.id,la,ma,this.$UFIController1.viewas);};ka.prototype.$UFIControllerp=function(la,event){ca.removePreview(la,{source:this.source,target:event.target});};ka.prototype.$UFIControllerq=function(la){h.loadModules(["UFIRetryActions"],function(ma){ma.retrySubmit(la,{source:this.source});}.bind(this));};ka.prototype.$UFIControllerr=function(){if(this.$UFIController2)return;var la=m.byTag(this.root,'form');if(la){i.removeClass(la,'collapsed_comments');this.$UFIController2=true;}};ka.prototype.setRange=function(la){this.getRange().updateRange(la.offset,la.length);};ka.prototype.setReplyRange=function(la,ma){this.getReplyRange(la).updateRange(ma.offset,ma.length);};ka.prototype.render=function(la){var ma=this.comments.length||!ea(this.feedback.likesentences.current);if(ma&&ia(la))this.$UFIControllerr();var na=this.getRange();if(this.$UFIController3===null)this.$UFIController3=na.getOffset()+na.getLength()-1;var oa=this.feedback.replysocialsentencemaxreplies||-1,pa={};pa[this.id]=this.getToplevelCommentList().getDeletedCount();var qa={},ra={};ra[this.id]=!this.featuredToplevelCommentList;this.comments.forEach(function(wa){var xa=wa.id;pa[xa]=this.getReplyCommentList(xa).getDeletedCount();qa[xa]=this.getToplevelCommentList().getPermalinkForComment(xa);ra[xa]=!this.featuredReplyCommentLists[xa];if(this.repliesMap[xa])this.repliesMap[xa].forEach(function(ya){var za=ya.id;qa[za]=aa.getCommentList(this.id,xa).getPermalinkForComment(za);}.bind(this));}.bind(this));var sa={};sa[this.id]=na;for(var ta in this.replyRanges)sa[ta]=this.replyRanges[ta];var ua=!!this.featuredToplevelCommentList,va=n.createElement(q,{feedback:this.feedback,id:this.id,storyInsert:this.storyInsert,onTargetLikeToggle:this.$UFIControllera.bind(this),onAlsoRecommendToggle:this.$UFIControllerc.bind(this),onCommentLikeToggle:this.$UFIControllerb.bind(this),onCommentRemove:this.$UFIControllerf.bind(this),onCommentHideAsSpam:this.$UFIControlleri.bind(this),onCommentMarkAsNotSpam:this.$UFIControllerj.bind(this),onCommentEdit:this.$UFIControllerd.bind(this),onCommentTranslate:this.$UFIControllerk.bind(this),onCommentInlineBan:this.$UFIControllerm.bind(this),onCommentUndoInlineBan:this.$UFIControllern.bind(this),onEditAttempt:this.$UFIControllere.bind(this),onCancelEdit:this.$UFIControllerg.bind(this),onChangeRange:this.$UFIControllers.bind(this),onSpamFetch:this.$UFIControllero.bind(this),onPreviewRemove:this.$UFIControllerp.bind(this),onRetrySubmit:this.$UFIControllerq.bind(this),onOrderingModeChange:this.$UFIControllert.bind(this),contextArgs:this.$UFIController1,repliesMap:this.repliesMap,showRepliesMap:this.showRepliesMap,showReplySocialSentenceMap:this.showReplySocialSentenceMap,shortenTimestamp:this.shortenTimestamp,commentCounts:this.commentcounts,deletedCounts:pa,availableComments:this.comments,source:this.source,ranges:sa,pageSize:w.defaultPageSize,authorProfiles:this.authorProfiles,instanceid:this.$UFIController0,loggingOffset:this.$UFIController3,replySocialSentenceMaxReplies:oa,orderingMode:this.orderingMode,hideOrderingModeSelector:ua,commentPermalinks:qa,canAddCommentMap:ra});this.$UFIController4=n.renderComponent(va,this.root);l.updateTimeStamps();if(this.$UFIController8())g.inform('ufi/changed',{form:this.$UFIController8()});if(la!=w.UFIPayloadSourceType.INITIAL_SERVER&&la!=w.UFIPayloadSourceType.COLLAPSED_UFI)g.inform('reflow');};ka.prototype.deferredCallback=function(la,ma,na,oa){la.callbackCount++;if(la.callbackCount<la.expectedCallbackCount)return;p.getMulti(ma,function(pa){this.authorProfiles=pa;oa(na);if(na==w.UFIPayloadSourceType.ENDPOINT_COMMENT_FETCH)g.inform('CommentUFI.Pager');}.bind(this));};ka.prototype.fetchAndUpdate=function(la,ma){x.getFeedbackTarget(this.id,function(na){this.feedback=na;var oa=this.getToplevelCommentList(this.orderingMode).getCommentCount(),pa=this.getRange(),qa=ha(pa.getRequestedOffset(),pa.getRequestedLength(),this.commentcounts[this.id],oa,ma),ra=[];if(this.feedback.actorforpost)ra.push(this.feedback.actorforpost);var sa={expectedCallbackCount:0,callbackCount:0},ta=qa.offset,ua=qa.length,va;if(this.$UFIController1.viewas)va=this.$UFIController1.viewas+'';this.getToplevelCommentList().getComments(ta,ua,va,function(wa,xa,ya){this.commentcounts[this.id]=xa;this.setRange(wa);this.comments=[];for(var za in ya)this.comments.push(ya[za]);ja(ra,this.comments);if(this.feedback.isthreaded&&this.comments.length){sa.expectedCallbackCount=this.comments.length;}else sa.expectedCallbackCount=1;for(var ab in ya){var bb=ya[ab],cb=bb.id;if(this.feedback.isthreaded){var db=this.getReplyCommentList(cb).getCommentCount(),eb;if(this.replyRanges[cb]){var fb=this.getReplyRange(cb);eb=ha(fb.getRequestedOffset(),fb.getRequestedLength(),this.commentcounts[cb],db,ma);}else eb={offset:0,length:Math.min(db,2)};var gb=eb.offset,hb=eb.length;this.getReplyCommentList(cb).getComments(gb,hb,null,function(ib,jb,kb,lb){this.commentcounts[ib]=kb;this.setReplyRange(ib,jb);this.repliesMap[ib]=[];for(var mb in lb)this.repliesMap[ib].push(lb[mb]);ja(ra,this.repliesMap[ib]);this.showRepliesMap[ib]=jb.length>0;if(this.showReplySocialSentenceMap[ib]===undefined&&this.commentcounts[ib]>0)this.showReplySocialSentenceMap[ib]=!this.showRepliesMap[ib];this.deferredCallback(sa,ra,ma,la);}.bind(this,cb,eb,db));}}if(!this.feedback.isthreaded||!this.comments.length)this.deferredCallback(sa,ra,ma,la);}.bind(this,qa,oa));}.bind(this));};ka.prototype.getToplevelCommentList=function(){if(this.featuredToplevelCommentList)return this.featuredToplevelCommentList;return ba.getCommentList(this.id,this.orderingMode);};ka.prototype.getReplyCommentList=function(la){if(la in this.featuredReplyCommentLists)return this.featuredReplyCommentLists[la];return aa.getCommentList(this.id,la);};ka.prototype.getRange=function(){if(!(this.orderingMode in this.ranges))this.ranges[this.orderingMode]=new z();return this.ranges[this.orderingMode];};ka.prototype.getReplyRange=function(la){if(!(la in this.replyRanges))this.replyRanges[la]=new z();return this.replyRanges[la];};ka.prototype.$UFIControllers=function(la,ma){if(la==this.id){this.getRange().updateRequestedRange(ma.offset,ma.length);}else this.replyRanges[la].updateRequestedRange(ma.offset,ma.length);this.fetchAndUpdate(this.render.bind(this),w.UFIPayloadSourceType.USER_ACTION);};ka.prototype.$UFIController6=function(){n.unmountComponentAtNode(this.root);this.ufiCentralUpdatesSubscriptions.forEach(s.unsubscribe.bind(s));g.unsubscribe(this.clearPageSubscription);this.viewasUFICleanSubscription&&g.unsubscribe(this.viewasUFICleanSubscription);};ka.prototype.$UFIController7=function(){this.$UFIController6();g.unsubscribe(this.clearPageletSubscription);};ka.prototype.$UFIControllert=function(la){this.orderingMode=la;this.fetchAndUpdate(this.render.bind(this),w.UFIPayloadSourceType.USER_ACTION);};e.exports=ka;},null);