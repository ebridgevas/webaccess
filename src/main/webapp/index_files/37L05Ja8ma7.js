/*!CK:3007284817!*//*1408337193,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["hF99B"]); }

__d("BlackbirdUpsellConstants",[],function(a,b,c,d,e,f){e.exports={ACTION_EDUCATE:"educate",ACTION_UPSELL:"upsell",CLICK_TYPE_DISMISS_PROMO:"dismiss_promo",CLICK_TYPE_ENABLE_CHAT:"enable_chat",CLICK_TYPE_OPEN_SETTINGS:"open_settings"};},null);
__d("GenderConst",[],function(a,b,c,d,e,f){e.exports={NOT_A_PERSON:0,FEMALE_SINGULAR:1,MALE_SINGULAR:2,FEMALE_SINGULAR_GUESS:3,MALE_SINGULAR_GUESS:4,MIXED_SINGULAR:5,MIXED_PLURAL:5,NEUTER_SINGULAR:6,UNKNOWN_SINGULAR:7,FEMALE_PLURAL:8,MALE_PLURAL:9,NEUTER_PLURAL:10,UNKNOWN_PLURAL:11,UNKNOWN:0};},null);
__d("StickerAssetType",[],function(a,b,c,d,e,f){e.exports={IMAGE:"BestEffortImage",SPRITE:"SpriteImage",PADDED_SPRITE:"PaddedSpriteImage"};},null);
__d("BlackbirdUpsell",["Event","Arbiter","AsyncRequest","LegacyContextualDialog","DOM","LayerDestroyOnHide","LayerHideOnTransition","PresencePrivacy","copyProperties","BlackbirdUpsellConfig","BlackbirdUpsellConstants","BlackbirdUpsellTemplates"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){var s='/ajax/chat/blackbird/update_clicks.php',t='/ajax/chat/blackbird/update_impressions.php',u='/ajax/chat/blackbird/dismiss.php',v=235,w=null,x=null,y=false,z=false;function aa(){}o(aa,{shouldShow:function(){if(this._dialogDismissed)return false;if(this.isEducation()){return !p.EducationDismissed&&p.EducationImpressions<p.EducationImpressionLimit;}else return !!p.UpsellGK&&!p.UpsellDismissed&&p.UpsellImpressions<p.UpsellImpressionLimit&&p.FriendCount>=p.UpsellMinFriendCount;},isEducation:function(){return p.TimeOffline<=p.EducationTimeOfflineThresdhold;},getOfflineContent:function(){if(this.isEducation()){return this._getEducationContent();}else return this._getUpsellContent();},_getEducationContent:function(){ga();var ka=r[':fb:chat:blackbird:offline-educate'].build(),la=ka.getNode('chatSettingsButton');g.listen(la,'click',function(){h.inform('chat/advanced-settings-dialog-opened');ja(q.CLICK_TYPE_OPEN_SETTINGS);da();});return ka.getRoot();},_getUpsellContent:function(){fa();var ka=r[':fb:chat:blackbird:upsell'].build(),la=ka.getNode('chatSettingsButton');g.listen(la,'click',function(){h.inform('chat/advanced-settings-dialog-opened');ia(q.CLICK_TYPE_OPEN_SETTINGS);ca();});var ma=ka.getNode('enableChatButton');g.listen(ma,'click',function(){ia(q.CLICK_TYPE_ENABLE_CHAT);ca();});return ka.getRoot();},getBlackbirdContent:function(ka){ga();switch(ka){case n.ONLINE:return r[':fb:chat:blackbird:most-friends-educate'].build().getRoot();case n.OFFLINE:return r[':fb:chat:blackbird:some-friends-educate'].build().getRoot();}},showOfflineDialog:function(ka){this.showDialog(ka,this.getOfflineContent.bind(this));},showBlackbirdDialog:function(ka,la){this.showDialog(ka,this.getBlackbirdContent.bind(null,la));},showDialog:function(ka,la){!w&&this._constructDialog();k.setContent(x,la());w.setContext(ka);w.show();},hide:function(){if(w&&w.isShown())w.hide();},dismiss:function(){this.hide();if(this.isEducation()){da();}else ca();},registerDismissClick:function(){if(this.isEducation()){ja(q.CLICK_TYPE_DISMISS_PROMO);}else ia(q.CLICK_TYPE_DISMISS_PROMO);},isVisible:function(){return z&&!y;},_constructDialog:function(){var ka=r[':fb:chat:blackbird:dialog-frame'].build();x=ka.getNode('dialogContent');w=new j();w.init(ka.getRoot());w.setPosition('above').setWidth(v).setFixed(true).disableBehavior(l).disableBehavior(m);g.listen(ka.getNode('dialogCloseButton'),'click',this.dismiss.bind(this));g.listen(ka.getNode('dialogCloseButton'),'click',this.registerDismissClick.bind(this));}});function ba(ka,la){if(!y&&z){y=true;n.inform('privacy-user-presence-changed');var ma=new i(u);ma.setData({source:ka,impressions:la,time_offline:p.TimeOffline});ma.setErrorHandler(function(){y=false;});ma.send();}}function ca(){ba(q.ACTION_UPSELL,p.UpsellImpressions);}function da(){ba(q.ACTION_EDUCATE,p.EducationImpressions);}function ea(ka,la){if(!z){z=true;var ma=new i(t);ma.setData({action:ka,impressions:la,time_offline:p.TimeOffline});ma.setErrorHandler(function(){z=false;});ma.send();}}function fa(){ea(q.ACTION_UPSELL,p.UpsellImpressions);}function ga(){ea(q.ACTION_EDUCATE,p.EducationImpressions);}function ha(ka,la,ma,na){var oa=new i(s);oa.setData({action:ka,impressions:ma,source:la,time_offline:na});oa.send();}function ia(ka){ha(ka,q.ACTION_UPSELL,p.UpsellImpressions,p.TimeOffline);}function ja(ka){ha(ka,q.ACTION_EDUCATE,p.EducateImpressions,p.TimeOffline);}h.subscribe('chat/advanced-settings-dialog-opened',aa.dismiss.bind(aa));h.subscribe('chat-visibility/go-online',aa.dismiss.bind(aa));h.subscribe('chat-visibility/go-offline',aa.dismiss.bind(aa));e.exports=aa;},null);
__d("Chat",["Arbiter"],function(a,b,c,d,e,f,g){var h={buddyListNub:'buddylist-nub/initialized',sidebar:'sidebar/initialized'};function i(k,l){g.subscribe(h[k],function(event,m){l(m);});}var j={openBuddyList:function(){i('buddyListNub',function(k){k.show();i('sidebar',function(l){l.enable();});});},closeBuddyList:function(){i('buddyListNub',function(k){k.hide();});},toggleSidebar:function(){i('sidebar',function(k){k.toggle();});}};a.Chat=e.exports=j;},3);
__d("ChatQuietLinks",["Event","DOM","UserAgent_DEPRECATED","DataStore","Parent"],function(a,b,c,d,e,f,g,h,i,j,k){var l={},m={silenceLinks:function(q){n(q,this.removeEmptyHrefs.bind(this));},nukeLinks:function(q){n(q,this.removeAllHrefs.bind(this));},removeEmptyHrefs:function(q){o(q,function(r){return !r||r==='#';});},removeAllHrefs:function(q){o(q);}};function n(q,r){var s=!!i.chrome(),t=!!i.chrome()||i.ie()>=9||i.firefox()>=4;if(l[h.getID(q)])return;l[h.getID(q)]=true;if(!t)return;if(!s){r&&r(q);return;}g.listen(q,'mouseover',function u(v){var w=k.byTag(v.getTarget(),'a');if(w){var x=w.getAttribute('href');if(p(x)){j.set(w,'stashedHref',w.getAttribute('href'));w.removeAttribute('href');}}});g.listen(q,'mouseout',function u(v){var w=k.byTag(v.getTarget(),'a'),x=w&&j.remove(w,'stashedHref');if(p(x))w.setAttribute('href',x);});g.listen(q,'mousedown',function(u){if(!u.isDefaultRequested())return true;var v=k.byTag(u.getTarget(),'a'),w=v&&j.get(v,'stashedHref');if(p(w))v.setAttribute('href',w);});}function o(q,r){var s=h.scry(q,'a');if(r)s=s.filter(function(t){return r(t.getAttribute('href'));});s.forEach(function(t){t.removeAttribute('href');t.setAttribute('tabindex',0);});}function p(q){return q&&q!=='#';}e.exports=m;},null);
__d("OrderedFriendsList",["AvailableList","ChatConfig","createArrayFrom","ShortProfiles","WorkModeConfig","InitialChatFriendsList"],function(a,b,c,d,e,f,g,h,i,j,k){var l=[],m={},n=[],o={contains:function(p){return p in m;},getList:function(){if(k.is_work_user)return i(l);if(h.get('chat_web_ranking_with_presence'))o.reRank();var p=i(l);p=p.filter(function(q){var r=j.getNowUnsafe(q);return !r||r.type=="friend";});return p;},getRank:function(p){return p in m?m[p]:l.length;},reRank:function(){var p={},q={};n.forEach(function(s,t){var u=s.substr(0,s.length-2),v=s.substring(s.length-1);if(typeof(q.uid)=='undefined'){if(typeof(p.uid)=='undefined')p[u]=g.get(u);var w=p[u];if(w==v)q[t]=u;}});l=[];for(var r in q)l.push(q[r]);l.forEach(function(s,t){m[s]=t;});}};(function(){var p=b('InitialChatFriendsList');l=p.list.length?p.list:[];if(h.get('chat_web_ranking_with_presence')&&!(k.is_work_user)){n=l.slice();o.reRank();}l.forEach(function(q,r){m[q]=r;});})();e.exports=a.OrderedFriendsList||o;},null);
__d("TypingDetector",["ArbiterMixin","Event","Input","Run","TypingStates","copyProperties","createObjectFrom","emptyFunction"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){function o(p){this._input=p;this._ignoreKeys={};}l(o.prototype,g,{_timeout:7000,_currentState:k.INACTIVE,init:function(){this.init=n;this.reset();h.listen(this._input,'keyup',this._update.bind(this));j.onUnload(this._onunload.bind(this));},reset:function(){clearTimeout(this._checkTimer);this._checkTimer=null;this._lastKeystrokeAt=null;this._currentState=k.INACTIVE;},setIgnoreKeys:function(p){this._ignoreKeys=m(p);},_onunload:function(){if(this._currentState==k.TYPING)this._transition(k.QUITTING);},_update:function(event){var p=h.getKeyCode(event),q=this._currentState;if(!this._ignoreKeys[p])if(i.getValue(this._input).trim().length===0){if(q==k.TYPING)this._transition(k.INACTIVE);}else if(q==k.TYPING){this._recordKeystroke();}else if(q==k.INACTIVE){this._transition(k.TYPING);this._recordKeystroke();}},_transition:function(p){this.reset();this._currentState=p;this.inform('change',p);},_recordKeystroke:function(){this._lastKeystrokeTime=Date.now();if(!this._checkTimer)this._checkTimer=setTimeout(this._checkTyping.bind(this),this._timeout);},_checkTyping:function(){var p=this._lastKeystrokeTime+this._timeout,q=Date.now();if(q>p){this._transition(k.INACTIVE);}else{clearTimeout(this._checkTimer);this._checkTimer=setTimeout(this._checkTyping.bind(this),p-q+10);}}});e.exports=o;},null);
__d("TypingDetectorController",["AsyncRequest","AvailableList","AvailableListConstants","ChannelConnection","ChatVisibility","Keys","PresencePrivacy","ShortProfiles","TypingDetector","TypingStates","copyProperties","emptyFunction","setTimeoutAcrossTransitions","shield"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){function u(w){if(!k.isOnline())return false;if(w){var x=n.getNow(w);return x&&x.type=="friend"&&m.allows(w);}return true;}function v(w,x,y,z,aa){"use strict";this.userID=w;this.input=x;this.source=y;this.threadID=aa;this.remoteState=p.INACTIVE;this.notifyTimer=null;z=z||{};this.notifyDelay=z.notifyDelay||this.notifyDelay;this._typingDetector=new o(x);this._typingDetector.init(z);this._typingDetector.subscribe('change',this._stateChange.bind(this));}v.prototype.setUserAndThread=function(w,x){"use strict";if(this.userID!==w||this.threadID!==x){this.resetState();this.userID=w;this.threadID=x;}};v.prototype.setIgnoreEnter=function(w){"use strict";var x=w?[l.RETURN]:[];this._typingDetector.setIgnoreKeys(x);};v.prototype.resetState=function(){"use strict";this._notifyState(p.INACTIVE);this.remoteState=p.INACTIVE;this._typingDetector.reset();clearTimeout(this.notifyTimer);this.notifyTimer=null;};v.prototype._stateChange=function(w,x){"use strict";if(x!=p.QUITTING){clearTimeout(this.notifyTimer);this.notifyTimer=s(t(this._notifyState,this,x),this.notifyDelay);}else this._notifyState(x,true);};v.prototype._notifyState=function(w,x){"use strict";if(!this.userID&&!this.threadID)return;var y=this.userID,z=u(y);if(z&&w!=this.remoteState){this.remoteState=w;if(j.disconnected())return;var aa={typ:w,to:y,source:this.source,thread:this.threadID};new g().setHandler(this._onTypResponse.bind(this,y)).setErrorHandler(r).setData(aa).setURI('/ajax/messaging/typ.php').setAllowCrossPageTransition(true).setOption('asynchronous',!x).send();}};v.prototype._onTypResponse=function(w,x){"use strict";var y=x.getPayload()||{};if(y.offline)h.set(w,i.OFFLINE,'typing_response');};q(v.prototype,{notifyDelay:1000});e.exports=v;},null);
__d("ChatSidebarSheet",["ArbiterMixin","BlackbirdUpsell","ChannelConnection","ChannelConstants","ChatBehavior","ChatConfig","ChatVisibility","CSS","DOM","Event","JSLogger","PresencePrivacy","copyProperties","mixin","setTimeoutAcrossTransitions","tx"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){var w=q.create('sidebar_sheet');function x(da){switch(da){case j.HINT_AUTH:return "Your session has timed out. Please log in.";case j.HINT_CONN:return v._("Facebook {Chat} is currently unavailable.",{Chat:"Chat"});case j.HINT_MAINT:return v._("Facebook {Chat} is currently down for maintenance.",{Chat:"Chat"});default:return v._("Facebook {Chat} is currently unavailable.",{Chat:"Chat"});}}function y(da){var ea;if(da===null||false===navigator.onLine){ea="Unable to connect to chat. Check your Internet connection.";}else if(da>l.get('warning_countdown_threshold_msec')){var fa=o.create('a',{href:'#',className:'fbChatReconnectLink'},"Try again");ea=o.tx._("Unable to connect to chat. {try-again-link}",{'try-again-link':fa});}else if(da>1000){ea=v._("Unable to connect to chat. Reconnecting in {seconds}...",{seconds:Math.floor(da/1000)});}else ea="Unable to connect to chat. Reconnecting...";return ea;}var z=t(g);for(var aa in z)if(z.hasOwnProperty(aa))ca[aa]=z[aa];var ba=z===null?null:z.prototype;ca.prototype=Object.create(ba);ca.prototype.constructor=ca;ca.__superConstructor__=z;function ca(da){"use strict";this._root=da;this._message=o.find(da,'div.fbChatSidebarMessage div.message');i.subscribe([i.CONNECTED,i.SHUTDOWN,i.RECONNECTING],this._handleConnectionChange.bind(this));i.subscribe([i.MUTE_WARNING,i.UNMUTE_WARNING],this._render.bind(this));r.subscribe('privacy-user-presence-changed',this._render.bind(this));k.subscribe(k.ON_CHANGED,this._render.bind(this));this._render();}ca.prototype._handleConnectionChange=function(da,ea){"use strict";this._channelStatus=da;this._channelData=ea;this._render();};ca.prototype._renderChannelDisconnect=function(){"use strict";if(this._channelStatus===i.SHUTDOWN){return o.setContent(this._message,x(this._channelData));}else if(this._channelStatus===i.RECONNECTING){var da=this._channelData;o.setContent(this._message,y(da));if(da>1000){if(da>l.get('warning_countdown_threshold_msec'))this._warningMsgEventListener=p.listen(this._message,'click',function(event){if(n.hasClass(event.getTarget(),'fbChatReconnectLink')){i.reconnect();return false;}});this._showWarningTimeout=u(this._handleConnectionChange.bind(this,i.RECONNECTING,da-1000),1000);}}};ca.prototype._renderOffline=function(){"use strict";var da='fbChatGoOnlineLink',ea="Turn on chat",fa=o.create('a',{href:'#',className:da},ea),ga=o.tx._("{=Go online} to see who's available.",{'=Go online':fa});o.setContent(this._message,ga);this._goOnlineEventListener=p.listen(this._message,'click',function(event){if(n.hasClass(event.getTarget(),da)){w.log('sidebar_go_online');m.goOnline();return false;}});};ca.prototype._renderBlackbirdUpsell=function(){"use strict";o.setContent(this._message,h.getOfflineContent());};ca.prototype._renderBlackbird=function(da){"use strict";o.setContent(this._message,h.getBlackbirdContent(da));};ca.prototype._clear=function(){"use strict";if(this._showWarningTimeout){clearTimeout(this._showWarningTimeout);this._showWarningTimeout=null;}if(this._warningMsgEventListener){this._warningMsgEventListener.remove();this._warningMsgEventListener=null;}if(this._goOnlineEventListener){this._goOnlineEventListener.remove();this._goOnlineEventListener=null;}n.removeClass(this._root,'upsell');n.removeClass(this._root,'offline');n.removeClass(this._root,'blackbird');n.removeClass(this._root,'error');n.removeClass(this._root,'notice');o.empty(this._message);};ca.prototype._render=function(){"use strict";this._clear();if(h.shouldShow()){if(m.hasBlackbirdEnabled()){var da=m.isOnline()?'blackbird':'upsell';n.addClass(this._root,da);this._renderBlackbird(r.getVisibility());}else if(!m.isOnline()){n.addClass(this._root,'upsell');this._renderBlackbirdUpsell();}}else if(!m.isOnline()){n.addClass(this._root,'offline');this._renderOffline();}else if(i.disconnected()){n.addClass(this._root,'error');this._renderChannelDisconnect();}else if(!k.notifiesUserMessages()){n.addClass(this._root,'notice');var ea="Alerts are off while you use another client to chat.";o.setContent(this._message,ea);}this.inform('updated');};s(ca.prototype,{_channelStatus:null,_channelData:null,_showWarningTimeout:null,_warningMsgEventListener:null,_goOnlineEventListener:null});e.exports=ca;},null);
__d("SidebarFitWindowHeight",["Arbiter","ArbiterMixin","Event","Style","SubscriptionsHandler","TinyViewport","Vector","mixin","queryThenMutateDOM"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){var p=n(h);for(var q in p)if(p.hasOwnProperty(q))s[q]=p[q];var r=p===null?null:p.prototype;s.prototype=Object.create(r);s.prototype.constructor=s;s.__superConstructor__=p;function s(t){"use strict";this.$SidebarFitWindowHeight0=t;this.onViewportUpdate();l.subscribe('change',this.onViewportUpdate.bind(this));}s.prototype.onViewportUpdate=function(){"use strict";if(l.isTiny()){this.onScroll();var t=this.onScroll.bind(this);this.$SidebarFitWindowHeight1=new k();this.$SidebarFitWindowHeight1.addSubscriptions(i.listen(window,'scroll',t),g.subscribe('dom-scroll',t));}else{if(this.$SidebarFitWindowHeight2!==0){j.set(this.$SidebarFitWindowHeight0,'margin-top','0');this.$SidebarFitWindowHeight2=0;}this.$SidebarFitWindowHeight1&&this.$SidebarFitWindowHeight1.release();}};s.prototype.onScroll=function(){"use strict";o(this.updateScrollPosition.bind(this),this.resizeSidebar.bind(this),'SidebarFitWindowHeight/scroll');};s.prototype.updateScrollPosition=function(){"use strict";this.$SidebarFitWindowHeight3=m.getScrollPosition().y;this.$SidebarFitWindowHeight4||(this.$SidebarFitWindowHeight4=this.$SidebarFitWindowHeight0.offsetHeight);};s.prototype.resizeSidebar=function(){"use strict";var t=-Math.max(Math.min(this.$SidebarFitWindowHeight3,this.$SidebarFitWindowHeight4),0);j.set(this.$SidebarFitWindowHeight0,'margin-top',t+'px');if(t!=this.$SidebarFitWindowHeight2){this.$SidebarFitWindowHeight2=t;this.inform('resized',t);}};s.prototype.getOffset=function(){"use strict";return this.$SidebarFitWindowHeight2;};e.exports=s;},null);
__d("ChatSidebar",["Arbiter","ArbiterMixin","AsyncRequest","Banzai","BanzaiLogger","BootloaderConfig","ChatConfig","ChatImpressionLogger","ChatOptions","ChatSidebarSheet","CSS","DOM","DOMDimensions","Event","JSLogger","JSXDOM","KeyEventController","LitestandClassicPlaceHolders","ModalLayer","OrderedFriendsList","Parent","PresencePrivacy","ScrollableArea","SidebarFitWindowHeight","Style","ViewportBounds","copyProperties","createArrayFrom","csx","debounce","emptyFunction","ge"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la){var ma,na=false,oa=false,pa=false,qa=false,ra=false,sa=false,ta,ua,va,wa,xa,ya=null,za,ab,bb=u.create('chat_sidebar'),cb='succeeded',db=k.create(ga({retry:true},j.VITAL));function eb(){q.removeClass(document.documentElement,'sidebarMode');if(!qa||!nb.isVisible()){g.inform('reflow');return;}pa=false;ya=null;va.hide();wa.getCore().reset();q.hide(ta);bb.log('sidebar_hide');nb.inform('sidebar/hide',nb);g.inform('sidebar/hide',nb);g.inform('reflow');}function fb(){var ob=nb.shouldShowSidebar();q.conditionClass(document.documentElement,'sidebarCapable',ob);if(nb.isEnabled()&&ob){ib();var pb=ha(ta.childNodes),qb=hb(pb),rb=va.getItemHeight(),sb=8,tb=Math.floor((qb-sb)/rb);ea.set(ma,'height',qb+'px');va.setNumTopFriends(tb);var ub=Math.floor((qb-sb)/rb);ub=(ub-2)>0?ub-2:0;wa.getData().setMaxResults(ub);nb.inform('sidebar/resized',nb);g.inform('sidebar/resized',nb);g.inform('reflow');}else eb();if(!qa){lb();qa=true;}ya=null;}function gb(){if(wa&&nb.isVisible())wa.getCore().getElement().focus();}function hb(ob){if(!ob)ob=ha(ta.childNodes);var pb=xa.height;ob.forEach(function(qb){if(qb&&qb!==ma)pb-=s.getElementDimensions(qb).height;});if(za)pb-=za.getOffset();return Math.max(0,pb);}function ib(){if(nb.isVisible())return;pa=true;ya=null;q.show(ta);q.addClass(document.documentElement,'sidebarMode');va.show();bb.log('sidebar_show');nb.inform('sidebar/show',nb);g.inform('sidebar/show',nb);x.destroy('sidebar');}function jb(){o.setSetting('sidebar_mode',nb.isEnabled(),'sidebar');new i('/ajax/chat/settings.php').setHandler(ka).setErrorHandler(ka).setData({sidebar_mode:nb.isEnabled()}).setAllowCrossPageTransition(true).send();}function kb(){return z.getList().length<=m.get('sidebar.min_friends');}function lb(){var ob=true;if(!nb.isEnabled()){bb.log('state_not_enabled');ob=false;}if(!nb.isViewportCapable()){bb.log('state_not_shown_viewport');ob=false;}if(oa){bb.log('state_not_shown_hidden');ob=false;}if(kb()){bb.log('state_not_shown_num_friends');ob=false;}bb.log(ob?'state_shown':'state_not_shown');}function mb(event,ob){if(!nb.isVisible())return;if(ob){ea.set(ta,'right',ob+'px');}else ea.set(ta,'right','');}var nb={init:function(ob,pb,qb,rb){nb.init=ka;ra=true;ta=ob;va=pb;wa=qb;ua=rb;ma=r.find(ob,'div.fbChatSidebarBody');t.listen(window,'resize',fb);w.registerKey('q',function(event){if(pa){var vb=null;if(ab){vb=r.scry(ab,'.inputsearch')[0];}else vb=r.scry(ob,'.inputsearch')[0];if(vb){vb.focus();event.prevent();}}});var sb=new p(ob);sb.subscribe('updated',fb);g.subscribe('sidebar/invalidate',fb);pb.setScrollContainer(aa.byClass(pb.getRoot(),'uiScrollableAreaWrap'));pb.subscribe(['render','show','hide'],ja(function(vb){if(vb==='render'&&!sa){sa=true;nb.inform('sidebar/chatRendered',null,g.BEHAVIOR_PERSISTENT);}var wb=pb.getRoot(),xb=ca.getInstance(wb);xb&&xb.adjustGripper();}));g.subscribe('chat/option-changed',function(vb,wb){if(wb.name=="sidebar_mode"){na=!!o.getSetting('sidebar_mode');fb();}});qb.getCore().subscribe('sidebar/typeahead/active',nb.updateOnActiveTypeahead);qb.subscribe('reset',function(){if(!qb.getCore().getValue()&&!va.isVisible())nb.updateOnActiveTypeahead(null,false);});g.subscribe('buddylist-nub/initialized',function(vb,wb){t.listen(wb.getButton(),'click',function(event){var xb=oa;oa=false;nb.enable();var yb=nb.shouldShowSidebar();oa=xb&&!yb;return !yb;});});na=!!o.getSetting('sidebar_mode');ba.subscribe('privacy-user-presence-changed',fb);fb();n.init(va);fa.addPersistentRight(nb.getVisibleWidth);nb.inform('sidebar/initialized',nb,g.BEHAVIOR_PERSISTENT);g.inform('sidebar/initialized',nb,g.BEHAVIOR_PERSISTENT);if(m.get('sidebar_below_bluebar')){var tb=r.find(ob,"._5qqe");za=new da(tb);za.subscribe('resized',fb);}if(m.get('chat_sidebar_load_log')){var ub={event:cb,session_token:rb.session_token,country_code:rb.viewer_country_code,buddylist_short:m.get('buddylist_short_group'),bootloader_retry:l.retry_on_timeout};db.log('MessagesSidebarLoadLoggerConfig',ub);}y.subscribe('CompensateForScrollbar',mb);},updateOnActiveTypeahead:function(ob,pb){if(!pa)return;if(pb){va.hide();}else{va.show();fb();}},isInitialized:function(){return qa;},disable:function(){if(!nb.isEnabled())return;na=false;jb();eb();},enable:function(){if(nb.isEnabled())return;na=true;jb();fb();setTimeout(gb,0);},forceEnsureLoaded:function(){if(ra)return;if(la('pagelet_sidebar'))return;d(['UIPagelet'],function(ob){var pb=v.div({id:"pagelet_sidebar"});r.appendContent(document.body,pb);ob.loadFromEndpoint('SidebarPagelet','pagelet_sidebar');});ra=true;},ensureLoaded:function(){if(!na)return;nb.forceEnsureLoaded();},hide:function(){if(oa)return;oa=true;eb();},unhide:function(){if(!oa)return;oa=false;fb();},getBody:function(){return ma;},getRoot:function(){return ta;},getVisibleWidth:function(){if(!pa||!ta)return 0;if(ya===null)ya=ta.offsetWidth;return ya;},isEnabled:function(){return na;},isViewportCapable:function(){xa=s.getViewportWithoutScrollbarDimensions();var ob=m.get('sidebar.minimum_width');return xa.width>ob;},shouldShowSidebar:function(){var ob=nb.isViewportCapable();return ob&&!oa&&!kb();},isVisible:function(){return pa;},resize:fb,toggle:function(){nb.isEnabled()?nb.disable():nb.enable();}};ga(nb,h);e.exports=nb;},null);
__d("ChatTypeaheadBehavior",["ChatOpenTab","CSS","MercuryConfig","Parent","Rect","copyProperties","cx"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){function n(p,q){var r=j.byClass(p,"_4oes");if(r)h.conditionClass(r,"_5q83",q);}function o(p){"use strict";this._typeahead=p;}o.prototype.enable=function(){"use strict";var p=this._typeahead;this._subscriptions=[p.subscribe('focus',function(){p.getData().refreshData();n(p.getElement(),true);}),p.subscribe('blur',function(q){p.getCore().reset();n(p.getElement(),false);}),p.subscribe('respond',function(q,r){if(r.value&&r.value===p.getCore().getValue()){if(!r.results.length){var s=r.value.toLowerCase(),t=p.getData().getQueryCache();if(!r.isAsync&&!t.hasOwnProperty(s))return;p.getView().showNoResults();}h.addClass(p.getElement(),'hasValue');}}),p.subscribe('reset',function(){h.removeClass(p.getElement(),'hasValue');}),p.subscribe('select',function(q,r){var s=r.selected.uid;if(i.MercuryFBIDGK&&r.selected.mercury_thread&&!r.selected.mercury_thread.is_canonical)s=r.selected.mercury_thread.thread_fbid;p.getView().hide();g.openTabByType(s,r.selected.type,'typeahead');}),p.subscribe('highlight',function(q,r){if(r.index>=0){var s=p.getView().getItems()[r.index];if(s){var t=new k(s),u=s.offsetParent,v=t.boundWithin(new k(u)).getPositionVector();t.getPositionVector().sub(v).scrollElementBy(u);}}})];};o.prototype.disable=function(){"use strict";this._subscriptions.forEach(function(p){this._typeahead.unsubscribe(p);},this);this._subscriptions=null;};l(o.prototype,{_subscriptions:null});e.exports=o;},null);
__d("CroppedImage.react",["Image.react","React","ReactPropTypes","cx"],function(a,b,c,d,e,f,g,h,i,j){var k=h.createClass({displayName:'CroppedImage',propTypes:{center:i.shape({x:i.number.isRequired,y:i.number.isRequired}),crop:i.shape({height:i.number.isRequired,width:i.number.isRequired}).isRequired,size:i.shape({height:i.number.isRequired,width:i.number.isRequired}).isRequired,src:i.string.isRequired},getDefaultProps:function(){return {center:{x:.5,y:.5}};},_calculateMargin:function(l,m,n){return -1*Math.max(Math.min(((n*m)-(.5*l)),m-l),0);},render:function(){var l=this._calculateMargin(this.props.crop.width,this.props.size.width,this.props.center.x),m=this._calculateMargin(this.props.crop.height,this.props.size.height,this.props.center.y),n={left:l,height:this.props.size.height,top:m,width:this.props.size.width};return (h.createElement(h.DOM.div,{className:"_46-h",style:this.props.crop},h.createElement(g,{alt:this.props.alt||'',className:"_46-i",src:this.props.src,style:n})));}});e.exports=k;},null);
__d("MercuryMessageError.react",["CurrentUser","ImmutableObject","MercuryErrorInfo","MercuryMessages","React","cx","joinClasses"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){'use strict';var n=k.PropTypes,o=k.createClass({displayName:'MercuryMessageError',propTypes:{authorFBID:n.string,message:n.instanceOf(h).isRequired},getDefaultProps:function(){return {authorFBID:g.getID()};},render:function(){var p=this.props.message,q=p.error_data;return (k.createElement(k.DOM.div,Object.assign({},this.props,{className:m(this.props.className,this._getClassNameFromStatus(p)),tabIndex:i.isTransient(q)?0:null,onClick:i.isTransient(q)?this.messageResend:null}),k.createElement(k.DOM.div,{className:"_2fs1"}),k.createElement(k.DOM.span,null,this._getTextFromStatus(p))));},messageResend:function(){j.getForFBID(this.props.authorFBID).resendMessage(this.props.message);},_getClassNameFromStatus:function(p){if(i.hasErrorStatus(p)){return (("_2fs2")+(' '+"_2fs3")+(i.isTransient(p.error_data)?' '+"_2fs4":'')+(i.isPermanent(p.error_data)?' '+"_2fs5":''));}else return "_2fs6 _2fs2";},_getTextFromStatus:function(p){var q='',r=p.error_data;if(i.hasErrorStatus(p))q=i.getMessage(r);return q;}});e.exports=o;},null);
__d("MercuryAudioPlayer",["Event","Arbiter","DOM","Flash","UserAgent_DEPRECATED","copyProperties"],function(a,b,c,d,e,f,g,h,i,j,k,l){var m=200;function n(){if(k.webkit()&&!k.chrome())return false;var w=i.create('audio'),x=false;try{if(!!w.canPlayType)if(w.canPlayType('video/mp4;').replace(/^no$/,''))x=true;}finally{return x;}}function o(){return j.isAvailable();}var p=function(){this.interval=null;this.arbiterInstance=null;this.audio=i.create('audio');g.listen(this.audio,'playing',function(){this.informAttachment('playing',this.audio.currentTime);this.interval=setInterval(function(){this.informAttachment('playing',this.audio.currentTime);}.bind(this),m);}.bind(this));g.listen(this.audio,'ended',function(){clearInterval(this.interval);this.informAttachment('finished');}.bind(this));};l(p.prototype,{setAudio:function(w,x){this.audio.setAttribute('src',w);this.arbiterInstance=x;},informAttachment:function(w,x){if(this.arbiterInstance)this.arbiterInstance.inform(w,x);},play:function(){this.audio.play();this.informAttachment('played');},resume:function(){this.audio.play();this.informAttachment('played');},pause:function(){this.audio.pause();clearInterval(this.interval);this.informAttachment('paused');},getType:function(){return 'html5';}});var q=function(){this.src=null;this.arbiterInstance=null;var w=i.create('div');document.body.appendChild(w);this.swf=j.embed('/swf/SoundStreamPlayer.swf',w,null,{});this.interval=null;h.subscribe('soundstream/finished',function(){clearInterval(this.interval);this.informAttachment('finished');}.bind(this));};l(q.prototype,{setAudio:function(w,x){this.src=w;this.arbiterInstance=x;},informAttachment:function(w,x){if(this.arbiterInstance)this.arbiterInstance.inform(w,x);},play:function(){this.swf.playSound(this.src);this.interval=setInterval(function(){var w=this.swf.getCurrentTime();this.informAttachment('playing',w);}.bind(this),m);this.informAttachment('played');},resume:function(){this.swf.resume();this.informAttachment('played');},pause:function(){clearInterval(this.interval);this.swf.pause();this.informAttachment('paused');},getType:function(){return 'flash';}});function r(){if(n()){return new p();}else if(o())return new q();return false;}var s=null,t=null,u=0;function v(w,x){this.src=w;this.arbiterInstance=x;this.audio_id=++u;s!==null||(s=r());if(!s)return false;}l(v.prototype,{getType:function(){if(!s){return false;}else return s.getType();},play:function(w){if(w&&t==this.audio_id){s.resume();}else{this.pause();t=this.audio_id;s.setAudio(this.src,this.arbiterInstance);s.play();}},pause:function(){s.pause();}});e.exports=v;},null);
__d("MercuryAttachmentAudioClip.react",["Arbiter","ArbiterMixin","MercuryAudioPlayer","CurrentUser","JSLogger","LeftRight.react","React","cx","shield","tx"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){var q='MercuryAttachmentAudioClip/play',r=k.create('mercury_audio_clip'),s=m.createClass({displayName:'AudioClip',mixins:[h],getInitialState:function(){this.subscribe('playing',this.updateTime);this.subscribe('played',o(this.setState,this,{playing:true,started:true}));this.subscribe('paused',o(this.setState,this,{playing:false}));this.subscribe('finished',o(this.setState,this,{playing:false,started:false,time:this.props.duration}));this.logged=false;var t=this.props.downloadOnly?false:new i(this.props.src,this);g.subscribe(q,function(u,v){if(this.props.src!=v)this.setState({time:0});}.bind(this));return {time:0,playing:false,started:false,duration:this.props.duration,audioPlayer:t};},updateTime:function(t,u){this.setState({time:u});},play:function(){if(this.state.playing){this.state.audioPlayer.pause();}else{this.state.audioPlayer.play(this.state.started);g.inform(q,this.props.src);if(!this.logged){this.logged=true;r.log('play',{uid:j.getID(),duration:this.props.duration});}}},_formatSeconds:function(t){if(t){t=Math.ceil(t);var u=t%60;if(u<10)u='0'+u;var v=Math.floor(t/60);return v+':'+u;}else return null;},_renderPlayer:function(t,u){return (m.createElement(m.DOM.a,{className:"_1miz",style:{width:t},onClick:this.play},m.createElement(m.DOM.span,{className:"_1mi-"},m.createElement(m.DOM.i,{className:"_1mi_"})),m.createElement(m.DOM.span,{className:"_1mj0"},u),m.createElement(m.DOM.div,{className:"_1mj1"})));},render:function(){var t=this.state.time,u=this.state.playing,v=this._formatSeconds(this.state.duration),w=this.props.width||170,x=null,y=Math.ceil((t*(w+2))/this.state.duration);if(this.state.audioPlayer&&this.state.audioPlayer.getType()){var z=this._renderPlayer(w,v),aa=this._renderPlayer(w,v),ba=(("_1mj2")+(u&&(t!==0)?' '+"_1mj3":'')+(u&&(t===0)?' '+"_4g4x":''));x=(m.createElement(m.DOM.div,{className:ba},z,m.createElement(m.DOM.div,{className:"_1mj4",style:{width:y}},aa)));}else x=(m.createElement(m.DOM.div,{className:"_1mj2"},m.createElement(m.DOM.div,{className:"_1miz"},m.createElement(l,null,m.createElement(m.DOM.a,{className:"_1mj5",href:this.props.src},m.createElement(m.DOM.span,{className:"_3qi6"},m.createElement(m.DOM.i,{className:"_1mj6"})),m.createElement(m.DOM.span,{className:"_1mj7"},"Voice Message"),m.createElement(m.DOM.span,{className:"_1mj8"},v)),m.createElement(m.DOM.a,{href:this.props.src,className:"_1mj9"},m.createElement(m.DOM.i,{className:"_1mja"}))))));return (m.createElement(m.DOM.div,{className:"_1mjb"},x));}});e.exports=s;},null);
__d("XMessagingVideoAttachmentControllerURIBuilder",["XControllerURIBuilder"],function(a,b,c,d,e,f){e.exports=b("XControllerURIBuilder").create("\/mercury\/attachments\/video\/",{video_id:{type:"Int",required:true},window_width:{type:"Int",required:true}});},null);
__d("MercuryAttachmentVideo.react",["CroppedImage.react","Image.react","React","ReactPropTypes","XMessagingVideoAttachmentControllerURIBuilder","cx","ix"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){var n=i.createClass({displayName:'MercuryAttachmentVideo',propTypes:{duration:j.number.isRequired,name:j.string.isRequired,size:j.shape({height:j.number,width:j.number}),thumbnailSize:j.shape({height:j.number,width:j.number}),thumbnail:j.string,videoID:j.string},_formatDuration:function(){var o=this.props.duration,p=Math.floor(o/60),q=o%60;if(q<10)return p+':0'+q;return p+':'+q;},render:function(){var o=!!this.props.thumbnail,p=(("_zow")+(' '+"_59go")+(!o?' '+"_59gq":'')),q=((!o?"_3l6h":'')+(!o?' '+"uiIconText":'')),r=new k().setInt('video_id',this.props.videoID).setInt('window_width',document.body.clientWidth).getURI();if(this.props.thumbnail)return (i.createElement(i.DOM.div,{className:p,style:this.props.size},i.createElement(i.DOM.a,{className:q,href:r,role:"button",rel:"async"},i.createElement(g,{crop:this.props.size,size:this.props.thumbnailSize,src:this.props.thumbnail}),i.createElement(i.DOM.div,{className:"_zox"}),i.createElement(i.DOM.div,{className:"_zoy"},i.createElement(h,{src:m('/images/chat/chat_play_icon.png')})),i.createElement(i.DOM.span,{className:"_zoz"},this._formatDuration()))));return (i.createElement(i.DOM.div,{className:p},i.createElement(i.DOM.a,{className:q,href:r,role:"button",rel:"async"},i.createElement(h,{src:m('/images/icons/video.gif')}),i.createElement(i.DOM.span,{className:"_59gp"},this.props.name))));}});e.exports=n;},null);
__d("SyncRequestTitle.react",["React","fbt","cx"],function(a,b,c,d,e,f,g,h,i){var j=g.createClass({displayName:'SyncRequestTitle',propTypes:{appName:g.PropTypes.string.isRequired,isSender:g.PropTypes.bool.isRequired,receiverName:g.PropTypes.string.isRequired,senderName:g.PropTypes.string.isRequired},render:function(){if(this.props.isSender){return (g.createElement(g.DOM.div,null,h._("Waiting for {receiver} to accept your invite to play {app_name}.",[h.param("receiver",g.createElement(g.DOM.span,{className:"_dg4"},this.props.receiverName)),h.param("app_name",g.createElement(g.DOM.span,{className:"_dg5"},h._("{app}",[h.param("app",this.props.appName)])))])));}else return (g.createElement(g.DOM.div,null,h._("{sender} wants to play {app_name} with you, right now.",[h.param("sender",g.createElement(g.DOM.span,{className:"_dg4"},this.props.senderName)),h.param("app_name",g.createElement(g.DOM.span,{className:"_dg5"},h._("{app}",[h.param("app",this.props.appName)])))])));}});e.exports=j;},null);
__d("SyncRequestAcceptedMessage.react",["React","fbt","cx"],function(a,b,c,d,e,f,g,h,i){var j=g.createClass({displayName:'SyncRequestAcceptedMessage',propTypes:{appName:g.PropTypes.string.isRequired,isSender:g.PropTypes.bool.isRequired,receiverName:g.PropTypes.string.isRequired,senderName:g.PropTypes.string.isRequired},render:function(){if(this.props.isSender){return (g.createElement(g.DOM.div,null,h._("{receiver} accepted your invite to play {app_name}.",[h.param("receiver",g.createElement(g.DOM.span,{className:"_dg4"},this.props.receiverName)),h.param("app_name",g.createElement(g.DOM.span,{className:"_dg5"},h._("{app}",[h.param("app",this.props.appName)])))])));}else return (g.createElement(g.DOM.div,null,h._("You accepted an invite from {sender} to play {app_name}.",[h.param("sender",g.createElement(g.DOM.span,{className:"_dg4"},this.props.senderName)),h.param("app_name",g.createElement(g.DOM.span,{className:"_dg5"},h._("{app}",[h.param("app",this.props.appName)])))])));}});e.exports=j;},null);
__d("SyncRequestRejectedMessage.react",["React","fbt","Link.react","cx","URI","AsyncRequest"],function(a,b,c,d,e,f,g,h,i,j,k,l){var m=g.createClass({displayName:'SyncRequestRejectedMessage',propTypes:{requestId:g.PropTypes.string.isRequired,app:g.PropTypes.object.isRequired,isSender:g.PropTypes.bool.isRequired,receiver:g.PropTypes.object.isRequired,sender:g.PropTypes.object.isRequired},render:function(){if(this.props.isSender){return (g.createElement(g.DOM.div,null,h._("{receiver} declined your invite to play {app_name}.",[h.param("receiver",g.createElement(g.DOM.span,{className:"_dg4"},this.props.receiver.name)),h.param("app_name",g.createElement(g.DOM.span,{className:"_dg5"},h._("{app}",[h.param("app",this.props.app.name)])))])));}else return (g.createElement(g.DOM.div,null,h._("You declined an invite from {sender} to play {app_name}.",[h.param("sender",g.createElement(g.DOM.span,{className:"_dg4"},this.props.sender.name)),h.param("app_name",g.createElement(g.DOM.span,{className:"_dg5"},h._("{app}",[h.param("app",this.props.app.name)])))]),g.createElement(g.DOM.div,{className:"_13n7"},g.createElement(g.DOM.div,null,g.createElement(i,{onClick:this._submitBlockApp},h._("Block {app}",[h.param("app",this.props.app.name)]))),g.createElement(g.DOM.div,null,g.createElement(i,{onClick:this._submitBlockUser},h._("Block requests from {sender}",[h.param("sender",this.props.sender.name)]))))));},_submitBlockApp:function(){var n=new k('/games/block_app/'),o=new l().setURI(n);o.setData({app_id:this.props.app.id,source:'sync_request'});o.send();},_submitBlockUser:function(){var n=new k('/games/block_user/'),o=new l().setURI(n);o.setData({app_id:this.props.app.id,blockee_uid:this.props.sender.id});o.send();}});e.exports=m;},null);
__d("SyncRequestExpiredMessage.react",["React","fbt","cx"],function(a,b,c,d,e,f,g,h,i){var j=g.createClass({displayName:'SyncRequestExpiredMessage',propTypes:{appName:g.PropTypes.string.isRequired,isSender:g.PropTypes.bool.isRequired,receiverName:g.PropTypes.string.isRequired,senderName:g.PropTypes.string.isRequired},render:function(){if(this.props.isSender){return (g.createElement(g.DOM.div,null,h._("{receiver} missed your invite to play {app_name}.",[h.param("receiver",g.createElement(g.DOM.span,{className:"_dg4"},this.props.receiverName)),h.param("app_name",g.createElement(g.DOM.span,{className:"_dg5"},h._("{app}",[h.param("app",this.props.appName)])))])));}else return (g.createElement(g.DOM.div,null,h._("You missed an invite from {sender} to play {app_name}.",[h.param("sender",g.createElement(g.DOM.span,{className:"_dg4"},this.props.senderName)),h.param("app_name",g.createElement(g.DOM.span,{className:"_dg5"},h._("{app}",[h.param("app",this.props.appName)])))])));}});e.exports=j;},null);
__d("SyncRequestCanceledMessage.react",["React","fbt","cx"],function(a,b,c,d,e,f,g,h,i){var j=g.createClass({displayName:'SyncRequestCanceledMessage',propTypes:{appName:g.PropTypes.string.isRequired,isSender:g.PropTypes.bool.isRequired,receiverName:g.PropTypes.string.isRequired,senderName:g.PropTypes.string.isRequired},render:function(){if(this.props.isSender){return (g.createElement(g.DOM.div,null,h._("You canceled an invite to {receiver} to play {app_name}.",[h.param("receiver",g.createElement(g.DOM.span,{className:"_dg4"},this.props.receiverName)),h.param("app_name",g.createElement(g.DOM.span,{className:"_dg5"},h._("{app}",[h.param("app",this.props.appName)])))])));}else return (g.createElement(g.DOM.div,null,h._("{sender} canceled an invitation to play {app_name}.",[h.param("sender",g.createElement(g.DOM.span,{className:"_dg4"},this.props.senderName)),h.param("app_name",g.createElement(g.DOM.span,{className:"_dg5"},h._("{app}",[h.param("app",this.props.appName)])))])));}});e.exports=j;},null);
__d("SyncRequestTimer.react",["React","fbt"],function(a,b,c,d,e,f,g,h){function i(k){if(k){k=Math.ceil(k);var l=k%60;if(l<10)l='0'+l;var m=Math.floor(k/60);return m+':'+l;}else return "0:00";}var j=g.createClass({displayName:'SyncRequestTimer',propTypes:{timeRemaining:g.PropTypes.number.isRequired,isSender:g.PropTypes.bool.isRequired,receiverName:g.PropTypes.string.isRequired},render:function(){if(this.props.isSender){return (g.createElement(g.DOM.div,null,h._("({time_remaining} remaining)",[h.param("time_remaining",i(this.props.timeRemaining))])));}else return (g.createElement(g.DOM.div,null,h._("You have {time_remaining} to accept.",[h.param("time_remaining",i(this.props.timeRemaining))])));}});e.exports=j;},null);
__d("XSyncRequestSubmitControllerURIBuilder",["XControllerURIBuilder"],function(a,b,c,d,e,f){e.exports=b("XControllerURIBuilder").create("\/platform\/games\/sync_requests\/submit\/",{request_id:{type:"Int",required:true},sender:{type:"Int",required:true},action:{type:"Int",required:true}});},null);
__d("SyncRequest.react",["Arbiter","AsyncRequest","ChannelConstants","React","SyncRequestStatusEnum","SyncRequestTitle.react","SyncRequestAcceptedMessage.react","SyncRequestRejectedMessage.react","SyncRequestExpiredMessage.react","SyncRequestCanceledMessage.react","SyncRequestTimer.react","XUIButton.react","XSyncRequestSubmitControllerURIBuilder","cx","fbt","getObjectValues"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){var w=j.createClass({displayName:'SyncRequest',propTypes:{app:j.PropTypes.object.isRequired,creationTime:j.PropTypes.number.isRequired,requestId:j.PropTypes.string.isRequired,receiver:j.PropTypes.object.isRequired,sender:j.PropTypes.object.isRequired,status:j.PropTypes.oneOf(v(k)).isRequired,timeout:j.PropTypes.number.isRequired,timeRemaining:j.PropTypes.number.isRequired,viewerId:j.PropTypes.number.isRequired,onStatusUpdate:j.PropTypes.func},componentWillMount:function(){if(this.props.status===k.PENDING){var x=g.subscribe(i.getArbiterType('sync_request_updated'),function(aa,ba){ba=ba.obj;if(ba.id.toString()!==this.props.requestId)return;this.setState({status:ba.status});}.bind(this));this.setState({statusEvent:x});}var y=null;if(this.props.status===k.PENDING){var z=function(){this.setState({time_remaining:(this.state.time_remaining-1)});if(this.state.time_remaining<=0){clearInterval(this.state.counter);var aa={counter:null,time_remaining:0};if(this.state.status===k.PENDING)aa.status=k.EXPIRED;this.setState(aa);}};y=setInterval(z.bind(this),1000);}this.setState({time_remaining:this.props.timeRemaining,counter:y});},componentWillUnmount:function(){if(this.state.counter)clearInterval(this.state.counter);g.unsubscribe(this.state.statusEvent);},getInitialState:function(){return {buttonsDisabled:false,time:Date.now(),status:this.props.status,viewerIsSender:this.props.viewerId===this.props.sender.id};},componentDidUpdate:function(x,y){if(this.props.status!=k.PENDING)this.state.status=this.props.status;if(this.props.onStatusUpdate)this.props.onStatusUpdate(this.state.status,y.status);},render:function(){var x;switch(this.state.status){case k.PENDING:var y;if(!this.state.viewerIsSender){y=[j.createElement(r,{use:"confirm",onClick:this._handleAccept,disabled:this.state.buttonsDisabled,label:"Accept"}),j.createElement(r,{use:"default",onClick:this._handleReject,disabled:this.state.buttonsDisabled,label:"Decline"})];}else y=j.createElement(r,{use:"default",onClick:this._handleCancel,disabled:this.state.buttonsDisabled,label:"Cancel"});x=(j.createElement(j.DOM.div,null,j.createElement(j.DOM.div,{className:"_372m"},j.createElement(l,{appName:this.props.app.name,isSender:this.state.viewerIsSender,receiverName:this.props.receiver.name,senderName:this.props.sender.name})),j.createElement(j.DOM.div,{className:"_372n"},j.createElement(q,{isSender:this.state.viewerIsSender,timeRemaining:this.state.time_remaining,receiverName:this.props.receiver.name})),j.createElement(j.DOM.div,{className:"_372o"},y)));break;case k.ACCEPTED:x=j.createElement(j.DOM.div,{className:"_372p mvs"},j.createElement(m,{appName:this.props.app.name,isSender:this.state.viewerIsSender,receiverName:this.props.receiver.name,senderName:this.props.sender.name}));break;case k.REJECTED:x=j.createElement(j.DOM.div,{className:"_372p mvs"},j.createElement(n,{requestId:this.props.requestId,app:this.props.app,isSender:this.state.viewerIsSender,receiver:this.props.receiver,sender:this.props.sender}));break;case k.EXPIRED:x=j.createElement(j.DOM.div,{className:"_372p mvs"},j.createElement(o,{appName:this.props.app.name,isSender:this.state.viewerIsSender,receiverName:this.props.receiver.name,senderName:this.props.sender.name}));break;case k.CANCELED:x=j.createElement(j.DOM.div,{className:"_372p mvs"},j.createElement(p,{appName:this.props.app.name,isSender:this.state.viewerIsSender,receiverName:this.props.receiver.name,senderName:this.props.sender.name}));break;default:throw new Error('The request status `%s` is unknown.',this.state.status);}return (j.createElement(j.DOM.div,{className:"_372q"},x));},_handleAccept:function(){this._handleStatusUpdate(k.ACCEPTED);var x=window.open(this.props.app.uri);if(x)x.focus();},_handleReject:function(){this._handleStatusUpdate(k.REJECTED);},_handleCancel:function(){this._handleStatusUpdate(k.CANCELED);},_handleStatusUpdate:function(x){this.setState({status:x,buttonsDisabled:true});var y=new s().setInt('request_id',this.props.requestId).setInt('sender',this.props.sender.id).setInt('action',x).getURI();new h().setURI(y).setHandler(function(z){this.setState({status:x});}.bind(this)).setErrorHandler(function(z){this.setState({buttonsDisabled:false});}.bind(this)).send();}});e.exports=w;},null);
__d("XUIBadge.react",["React","cx","invariant","joinClasses"],function(a,b,c,d,e,f,g,h,i,j){function k(m){return parseInt(m,10)===m;}var l=g.createClass({displayName:'XUIBadge',propTypes:{type:g.PropTypes.oneOf(['regular','special']),count:g.PropTypes.number.isRequired,maxcount:g.PropTypes.number},getDefaultProps:function(){return {type:'regular',maxcount:20};},render:function(){var m=this.props.type,n=this.props.count,o=this.props.maxcount;i(k(n));i(k(o));var p=(("_5ugh")+(n>o?' '+"_5ugi":'')+(m==='regular'?' '+"_5ugf":'')+(m==='special'?' '+"_5ugg":'')+(n===0?' '+"hidden_elem":''));return (g.createElement(g.DOM.span,Object.assign({},this.props,{className:j(this.props.className,p),type:null}),n>o?o+'+':n));}});e.exports=l;},null);
__d("XUIAmbientNUXTheme",["cx"],function(a,b,c,d,e,f,g){var h={wrapperClassName:"_2x6q",arrowDimensions:{offset:14,length:18}};e.exports=h;},null);
__d("XUIAmbientNUX.react",["XUIAmbientNUXTheme","ContextualDialog","ContextualDialogArrow","LayerAutoFocus","LayerRefocusOnHide","React","ReactLayer","XUICloseButton.react","cx"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){var p=l.PropTypes,q=300,r=380,s=m.createClass({displayName:'XUIAmbientNUX',immutableProps:{modal:null},createLayer:function(u){var v=this.getContextNode(),w={alignment:this.props.alignment,arrowBehavior:i,context:v,offsetX:this.props.offsetX,offsetY:this.props.offsetY,position:this.props.position,theme:g,width:this.getWidth(this.props)},x=new h(w,u);x.disableBehavior(j);x.disableBehavior(k);x.conditionShow(this.props.shown);return x;},receiveProps:function(u){var v=this.getContextNode();this.layer.setContext(v);this.layer.setPosition(u.position).setAlignment(u.alignment).setOffsetX(u.offsetX).setOffsetY(u.offsetY).setWidth(this.getWidth(u)).conditionShow(u.shown);},getContextNode:function(){if(this.props.context)return this.props.context;var u=this.props.owner.getSiblingByRef(this.props.contextRef);return u&&u.getDOMNode();},getWidth:function(u){switch(u.width){case 'wide':return r;case 'custom':return u.customwidth;case 'auto':return null;default:return q;}}}),t=l.createClass({displayName:'XUIAmbientNUX',propTypes:{context:p.object,contextRef:p.string,position:p.oneOf(['above','below','left','right']),alignment:p.oneOf(['left','center','right']),offsetX:p.number,offsetY:p.number,width:p.oneOf(['wide','normal','auto','custom']),customwidth:p.number,shown:p.bool,onCloseButtonClick:p.func},render:function(){return (l.createElement(s,Object.assign({},this.props,{owner:this}),l.createElement(l.DOM.div,{className:"_36gm"},l.createElement(n,{shade:"light",className:"_36gl",onClick:this.props.onCloseButtonClick}),l.createElement(l.DOM.div,{className:"_36gn"},this.props.children))));}});e.exports=t;},null);
__d("updatePhotoProgressBar",[],function(a,b,c,d,e,f){'use strict';function g(h,event){if(event.loaded!=event.total){h.setPosition(50*event.loaded/event.total);}else{h.setPosition(50);h.setTarget(100,2000);}}e.exports=g;},null);
__d("str2rstr",[],function(a,b,c,d,e,f){function g(h){var i="",j,k;for(var l=0;l<h.length;l++){j=h.charCodeAt(l);k=l+1<h.length?h.charCodeAt(l+1):0;if(55296<=j&&j<=56319&&56320<=k&&k<=57343){j=65536+((j&1023)<<10)+(k&1023);l++;}if(j<=127){i+=String.fromCharCode(j);}else if(j<=2047){i+=String.fromCharCode(192|((j>>>6)&31),128|(j&63));}else if(j<=65535){i+=String.fromCharCode(224|((j>>>12)&15),128|((j>>>6)&63),128|(j&63));}else if(j<=2097151)i+=String.fromCharCode(240|((j>>>18)&7),128|((j>>>12)&63),128|((j>>>6)&63),128|(j&63));}return i;}e.exports=g;},null);
__d("md5",["str2rstr"],function(a,b,c,d,e,f,g){function h(u,v){var w=u[0],x=u[1],y=u[2],z=u[3];w=j(w,x,y,z,v[0],7,-680876936);z=j(z,w,x,y,v[1],12,-389564586);y=j(y,z,w,x,v[2],17,606105819);x=j(x,y,z,w,v[3],22,-1044525330);w=j(w,x,y,z,v[4],7,-176418897);z=j(z,w,x,y,v[5],12,1200080426);y=j(y,z,w,x,v[6],17,-1473231341);x=j(x,y,z,w,v[7],22,-45705983);w=j(w,x,y,z,v[8],7,1770035416);z=j(z,w,x,y,v[9],12,-1958414417);y=j(y,z,w,x,v[10],17,-42063);x=j(x,y,z,w,v[11],22,-1990404162);w=j(w,x,y,z,v[12],7,1804603682);z=j(z,w,x,y,v[13],12,-40341101);y=j(y,z,w,x,v[14],17,-1502002290);x=j(x,y,z,w,v[15],22,1236535329);w=k(w,x,y,z,v[1],5,-165796510);z=k(z,w,x,y,v[6],9,-1069501632);y=k(y,z,w,x,v[11],14,643717713);x=k(x,y,z,w,v[0],20,-373897302);w=k(w,x,y,z,v[5],5,-701558691);z=k(z,w,x,y,v[10],9,38016083);y=k(y,z,w,x,v[15],14,-660478335);x=k(x,y,z,w,v[4],20,-405537848);w=k(w,x,y,z,v[9],5,568446438);z=k(z,w,x,y,v[14],9,-1019803690);y=k(y,z,w,x,v[3],14,-187363961);x=k(x,y,z,w,v[8],20,1163531501);w=k(w,x,y,z,v[13],5,-1444681467);z=k(z,w,x,y,v[2],9,-51403784);y=k(y,z,w,x,v[7],14,1735328473);x=k(x,y,z,w,v[12],20,-1926607734);w=l(w,x,y,z,v[5],4,-378558);z=l(z,w,x,y,v[8],11,-2022574463);y=l(y,z,w,x,v[11],16,1839030562);x=l(x,y,z,w,v[14],23,-35309556);w=l(w,x,y,z,v[1],4,-1530992060);z=l(z,w,x,y,v[4],11,1272893353);y=l(y,z,w,x,v[7],16,-155497632);x=l(x,y,z,w,v[10],23,-1094730640);w=l(w,x,y,z,v[13],4,681279174);z=l(z,w,x,y,v[0],11,-358537222);y=l(y,z,w,x,v[3],16,-722521979);x=l(x,y,z,w,v[6],23,76029189);w=l(w,x,y,z,v[9],4,-640364487);z=l(z,w,x,y,v[12],11,-421815835);y=l(y,z,w,x,v[15],16,530742520);x=l(x,y,z,w,v[2],23,-995338651);w=m(w,x,y,z,v[0],6,-198630844);z=m(z,w,x,y,v[7],10,1126891415);y=m(y,z,w,x,v[14],15,-1416354905);x=m(x,y,z,w,v[5],21,-57434055);w=m(w,x,y,z,v[12],6,1700485571);z=m(z,w,x,y,v[3],10,-1894986606);y=m(y,z,w,x,v[10],15,-1051523);x=m(x,y,z,w,v[1],21,-2054922799);w=m(w,x,y,z,v[8],6,1873313359);z=m(z,w,x,y,v[15],10,-30611744);y=m(y,z,w,x,v[6],15,-1560198380);x=m(x,y,z,w,v[13],21,1309151649);w=m(w,x,y,z,v[4],6,-145523070);z=m(z,w,x,y,v[11],10,-1120210379);y=m(y,z,w,x,v[2],15,718787259);x=m(x,y,z,w,v[9],21,-343485551);u[0]=s(w,u[0]);u[1]=s(x,u[1]);u[2]=s(y,u[2]);u[3]=s(z,u[3]);}function i(u,v,w,x,y,z){v=s(s(v,u),s(x,z));return s((v<<y)|(v>>>(32-y)),w);}function j(u,v,w,x,y,z,aa){return i((v&w)|((~v)&x),u,v,y,z,aa);}function k(u,v,w,x,y,z,aa){return i((v&x)|(w&(~x)),u,v,y,z,aa);}function l(u,v,w,x,y,z,aa){return i(v^w^x,u,v,y,z,aa);}function m(u,v,w,x,y,z,aa){return i(w^(v|(~x)),u,v,y,z,aa);}function n(u){var v=u.length,w=[1732584193,-271733879,-1732584194,271733878],x;for(x=64;x<=u.length;x+=64)h(w,o(u.substring(x-64,x)));u=u.substring(x-64);var y=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(x=0;x<u.length;x++)y[x>>2]|=u.charCodeAt(x)<<((x&3)<<3);y[x>>2]|=128<<((x&3)<<3);if(x>55){h(w,y);for(x=0;x<16;x++)y[x]=0;}y[14]=v*8;h(w,y);return w;}function o(u){var v=[],w=0;while(w<64)v[w>>2]=u.charCodeAt(w++)|(u.charCodeAt(w++)<<8)|(u.charCodeAt(w++)<<16)|(u.charCodeAt(w++)<<24);return v;}var p='0123456789abcdef'.split('');function q(u){var v='',w=0;for(;w<4;w++)v+=p[(u>>((w<<3)+4))&15]+p[(u>>(w<<3))&15];return v;}function r(u){for(var v=0;v<u.length;v++)u[v]=q(u[v]);return u.join('');}var s=function(u,v){return (u+v)&4294967295;};function t(u){if(null===u||undefined===u){return null;}else{for(var v=0;v<u.length;v++)if(u[v]>"\u007F"){u=g(u);break;}return r(n(u));}}if(t('hello')!='5d41402abc4b2a76b9719d911017c592')s=function(u,v){var w=(u&65535)+(v&65535),x=(u>>16)+(v>>16)+(w>>16);return (x<<16)|(w&65535);};e.exports=t;},null);
__d("WebMessengerEvents",["Arbiter","copyProperties"],function(a,b,c,d,e,f,g,h){var i=h(new g(),{MASTER_DOM_CHANGED:'master-dom-changed',DETAIL_DOM_CHANGED:'detail-dom-changed',FOCUS_COMPOSER:'focus-composer',FOCUS_SEARCH:'focus-search',FOCUS_AND_SELECT_SEARCH:'focus-and-select-search',STICKER_CLICKED:'sticker-clicked',SUBMIT_REPLY:'submit-reply',UPDATE_SELECTION:'update-selection',masterDOMChanged:function(){this.inform(i.MASTER_DOM_CHANGED);},detailDOMChanged:function(){this.inform(i.DETAIL_DOM_CHANGED);},focusComposer:function(){this.inform(i.FOCUS_COMPOSER);},focusSearch:function(){this.inform(i.FOCUS_SEARCH);},focusAndSelectSearch:function(){this.inform(i.FOCUS_AND_SELECT_SEARCH);},updateSelection:function(j){this.inform(i.UPDATE_SELECTION,j);},stickerClicked:function(j,k){this.inform(i.STICKER_CLICKED,{packID:j,stickerID:k});},submitReply:function(){this.inform(i.SUBMIT_REPLY);}});e.exports=i;},null);
__d("WebMessengerSubscriptionsHandler",["SubscriptionsHandler"],function(a,b,c,d,e,f,g){var h=new g('webmessenger');e.exports=h;},null);
__d("isWebMessengerURI",[],function(a,b,c,d,e,f){function g(h){return (/^(\/messages)/).test(h.getPath());}e.exports=g;},null);
__d("WebMessengerWidthControl",["Arbiter","CSS","CSSClassTransition","DOM","DOMDimensions","Event","Style","URI","ViewportBounds","WebMessengerEvents","WebMessengerSubscriptionsHandler","$","cx","csx","isWebMessengerURI","requestAnimationFrame","setTimeoutAcrossTransitions","shield","throttle"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y){var z=205,aa=981,ba=257,ca=18,da=848,ea=724,fa=.57,ga=56,ha,ia,ja;function ka(pa,qa,ra){this.masterChanged=pa;this.detailChaned=qa;q.addSubscriptions(l.listen(window,'resize',y(x(la,this,this),100)),g.subscribe(['sidebar/initialized','sidebar/show','sidebar/hide'],x(la,this,this),g.SUBSCRIBE_NEW));var sa=oa()?ga:0;if(ra)sa=z;this._width=oa()?0:da;ja=true;la(this,sa);}function la(pa,qa){var ra=o.getRight()+o.getLeft();ra=ra||qa||0;var sa=k.getViewportWithoutScrollbarDimensions().width-ra,ta=Math.round(Math.max(0,sa/2-aa/2));sa=aa+ta-ba;sa-=ca;sa=Math.max(ea,Math.min(da,sa));if(!isNaN(sa)&&pa._width!==sa){pa._width=sa;var ua=Math.round(sa/(1+fa)),va=sa-ua;pa.masterChanged(va);pa.detailChaned(ua);if(oa()){var wa=sa+ba;ma(function(){if(ia){document.body.className=ia;ia='';}na(wa+'px');h.removeClass(document.body,"_5uj5");ja&&p.detailDOMChanged();ja=false;},ia);}}}function ma(pa,qa){qa&&h.addClass(document.documentElement,"_5uj6");v(pa);qa&&w(h.removeClass.bind(null,document.documentElement,"_5uj6"),1000);}function na(pa){m.set(j.find(document,"div._uaw"),'width',pa);m.set(r('globalContainer'),'width',pa);}function oa(){if(!ha)ha=h.hasClass(document.body,"_6nw");return ha;}i.registerHandler(function(pa,qa,ra,sa){function ta(ua){return oa()&&u(n(ua));}if(ta(sa)){ia=qa;return true;}else if(ta(ra)){ma(function(){pa.className=qa;na('');},true);return true;}});e.exports=ka;},null);
__d("Dock",["Event","shield","Arbiter","ArbiterMixin","ChatQuietLinks","CSS","DataStore","DOM","Parent","Style","Toggler","Vector","copyProperties","csx","emptyFunction","WebMessengerWidthControl"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u){b('WebMessengerWidthControl');function v(){}s(v,j,{MIN_HEIGHT:140,INITIAL_FLYOUT_HEIGHT_OFFSET:10,init:function(w){this.init=u;this.rootEl=w;this.calculateViewportDimensions();this.calculateFlyoutHeightOffset();k.removeEmptyHrefs(this.rootEl);g.listen(w,'click',this._onClick.bind(this));g.listen(window,'resize',this._onWindowResize.bind(this));q.subscribe(['show','hide'],function(x,y){var z=y.getActive();if(!n.contains(w,z))return;if(l.hasClass(z,'fbNub')){this.notifyNub(z,x);if(x==='show')this._resizeNubFlyout(z);}else{var aa=o.byClass(z,'fbNubFlyout');if(aa)l.conditionClass(aa,'menuOpened',x==='show');}}.bind(this));this.inform('init',{},i.BEHAVIOR_PERSISTENT);},calculateViewportDimensions:function(){return (this.viewportDimensions=r.getViewportDimensions());},calculateFlyoutHeightOffset:function(){this.flyoutHeightOffset=this.INITIAL_FLYOUT_HEIGHT_OFFSET+r.getElementDimensions(this.rootEl).y;var w=n.scry(document,"div._4f7n")[0];if(w){var x=p.isFixed(w)?'viewport':'document';this.flyoutHeightOffset+=r.getElementPosition(w,x).y+r.getElementDimensions(w).y;}},toggle:function(w){var x=this._findFlyout(w);if(!x)return;this.subscribe('init',function(){q.toggle(w);});},show:function(w){this.subscribe('init',function(){q.show(w);});},showNub:function(w){l.show(w);},hide:function(w){this.subscribe('init',function(){var x=q.getInstance(w);n.contains(w,x.getActive())&&x.hide();});},hideNub:function(w){l.hide(w);this.hide(w);},setUseMaxHeight:function(w,x){l.conditionClass(w,'maxHeight',x!==false);this._resizeNubFlyout(w);},_resizeNubFlyout:function(w){var x=this._findFlyout(w);if(!x||!(l.hasClass(w,'openToggler')||l.hasClass(w,'opened')))return;var y=n.find(x,'div.fbNubFlyoutOuter'),z=n.find(y,'div.fbNubFlyoutInner'),aa=n.find(z,'div.fbNubFlyoutBody'),ba=aa.scrollTop,ca=aa.offsetHeight;p.set(aa,'height','auto');var da=r.getElementDimensions(x),ea=r.getElementDimensions(aa),fa=this.getMaxFlyoutHeight(w);p.set(x,'max-height',fa+'px');p.set(y,'max-height',fa+'px');da=r.getElementDimensions(x);var ga=r.getElementDimensions(z),ha=ga.y-ea.y,ia=da.y-ha,ja=parseInt(aa.style.height||aa.clientHeight,10),ka=ia!==ja;if(da.y>ha&&ka)p.set(aa,'height',ia+'px');l.removeClass(x,'swapDirection');var la=r.getElementPosition(x).x;l.conditionClass(x,'swapDirection',function(){if(la<0)return true;return (la+da.x>this.viewportDimensions.x);}.bind(this)());if(ka&&ba+ca>=ea.y){aa.scrollTop=aa.scrollHeight;}else aa.scrollTop=ba;this.notifyNub(w,'resize');},getMaxFlyoutHeight:function(w){var x=this._findFlyout(w),y=r.getElementPosition(x,'viewport'),z=r.getElementDimensions(x),aa=Math.max(this.MIN_HEIGHT,this.viewportDimensions.y-this.flyoutHeightOffset)-(this.viewportDimensions.y-y.y-z.y);return Math.max(aa,0);},resizeAllFlyouts:function(){var w=this._getAllNubs(),x=w.length;while(x--)this._resizeNubFlyout(w[x]);},hideAllFlyouts:function(){var w=this._getAllNubs(),x=w.length;while(x--)this.hide(w[x]);},_getAllNubs:function(){var w=n.scry(this.rootEl,"div._50-v.openToggler");return w.concat(n.scry(this.rootEl,"div._50-v.opened"));},_onClick:function(event){var w=event.getTarget(),x=o.byClass(w,'fbNub');if(x){if(o.byClass(w,'fbNubFlyoutTitlebar')){var y=o.byTag(w,'a'),z=w.nodeName=='INPUT'&&w.getAttribute('type')=='submit';if(!y&&!z){this.hide(x);return false;}}this.notifyNub(x,'click');}},_onWindowResize:function(event){this.calculateViewportDimensions();this.resizeAllFlyouts();},_findFlyout:function(w){return l.hasClass(w,'fbNubFlyout')?w:n.scry(w,'div.fbNubFlyout')[0]||null;},registerNubController:function(w,x){m.set(w,'dock:nub:controller',x);x.subscribe('nub/button/content-changed',h(this.inform,this,'resize',w));x.subscribe('nub/flyout/content-changed',h(this._resizeNubFlyout,this,w));},unregisterNubController:function(w){m.remove(w,'dock:nub:controller');},notifyNub:function(w,x,y){var z=m.get(w,'dock:nub:controller');z&&z.inform(x,y);}});e.exports=a.Dock||v;},null);
__d("BlobFactory",["emptyFunction"],function(a,b,c,d,e,f,g){var h,i=a.BlobBuilder||a.WebKitBlobBuilder||a.MozBlobBuilder||a.MSBlobBuilder;if(a.Blob){var j;try{new a.Blob();j=true;}catch(k){j=false;}h={getBlob:function(l,m){l=l||[];m=m||{};if(j){return new a.Blob(l,m);}else{var n=new i();for(var o=0;o<l.length;o++)n.append(l[o]);return n.getBlob(m.type);}},isSupported:g.thatReturnsTrue};}else h={getBlob:function(){},isSupported:g.thatReturnsFalse};e.exports=h;},null);
__d("AbstractTextFieldMixin.react",["React","Keys","cx","invariant","joinClasses","cloneWithProps"],function(a,b,c,d,e,f,g,h,i,j,k,l){var m={propTypes:{value:g.PropTypes.string,placeholder:g.PropTypes.string,tabIndex:g.PropTypes.string,maxLength:g.PropTypes.number,onBackspace:g.PropTypes.func,onBackTab:g.PropTypes.func,onBlur:g.PropTypes.func,onChange:g.PropTypes.func,onDownArrow:g.PropTypes.func,onEnter:g.PropTypes.func,onEscape:g.PropTypes.func,onFocus:g.PropTypes.func,onKeyDown:g.PropTypes.func,onLeftArrow:g.PropTypes.func,onNoShiftEnter:g.PropTypes.func,onRightArrow:g.PropTypes.func,onShiftEnter:g.PropTypes.func,onShiftDownArrow:g.PropTypes.func,onShiftUpArrow:g.PropTypes.func,onTab:g.PropTypes.func,onUpArrow:g.PropTypes.func,type:g.PropTypes.string,autoCapitalize:g.PropTypes.string},getInitialState:function(){return {focused:false,value:this.props.defaultValue||''};},getValue:function(){return this.props.value!=null?''+this.props.value:this.state.value;},onInputKeyDown:function(n){var o=this.props,p=n.keyCode,q=n.shiftKey;if(p===h.BACKSPACE&&!q&&o.onBackspace){o.onBackspace(n);}else if(p===h.TAB&&!q&&o.onTab){o.onTab(n);}else if(p===h.TAB&&q&&o.onBackTab){o.onBackTab(n);}else if(p===h.UP){if(q){if(o.onShiftUpArrow)o.onShiftUpArrowAttempt(n);}else if(o.onUpArrow)o.onUpArrow(n);}else if(p===h.DOWN&&o.onDownArrow){if(q){if(o.onShiftDownArrow)o.onShiftDownArrow(n);}else if(o.onDownArrow)o.onDownArrow(n);}else if(p===h.LEFT&&o.onLeftArrow){o.onLeftArrow(n);}else if(p===h.RIGHT&&o.onRightArrow){o.onRightArrow(n);}else if(p===h.RETURN){if(o.onEnter)o.onEnter(n);if(q){if(o.onShiftEnter)o.onShiftEnter(n);}else if(o.onNoShiftEnter)o.onNoShiftEnter(n);}else if(p===h.ESC&&o.onEscape)o.onEscape(n);if(o.onKeyDown)o.onKeyDown(n);},onInputChange:function(n){if(this.props.onChange)this.props.onChange(n);this.setState({value:n.target.value});},focusInput:function(){this.getTextFieldDOM().focus();},blurInput:function(){this.getTextFieldDOM().blur();},onInputBlur:function(event){if(this.props.onBlur)this.props.onBlur(event);if(!event.isDefaultPrevented())this.setState({focused:false});},onInputFocus:function(event){if(this.props.onFocus)this.props.onFocus(event);if(!event.isDefaultPrevented())this.setState({focused:true});},getTextFieldDOM:function(){return this.refs[this.getTextFieldRef()].getDOMNode();},getTextFieldRef:function(){return 'textField';},setTextFieldPropsOn:function(n){return l(n,{'aria-activedescendant':this.props['aria-activedescendant'],'aria-autocomplete':this.props['aria-autocomplete'],'data-testid':this.props['data-testid'],ref:this.getTextFieldRef(),autoCapitalize:this.props.autoCapitalize,onKeyDown:this.onInputKeyDown,onBlur:this.onInputBlur,onFocus:this.onInputFocus,onChange:this.onInputChange,disabled:this.props.disabled,defaultValue:this.props.defaultValue,name:this.props.name,value:this.getValue(),id:this.props.id,maxLength:this.props.maxLength,min:this.props.min,max:this.props.max,title:this.props.title,type:this.props.type||n.props.type});},render:function(){var n=null;if(!this.getValue()){var o=(("_58ai")+(this.state.focused?' '+"_58aj":''));n=g.createElement(g.DOM.span,{className:o},this.props.placeholder);}var p=k(this.props.className,"_58ak");j(this.renderTextField);return (g.createElement(g.DOM.label,{className:p},{placeholder:n,textField:this.renderTextField()}));}};e.exports=m;},null);
__d("AbstractTextInput.react",["AbstractTextFieldMixin.react","React","ReactDOMInput","cx"],function(a,b,c,d,e,f,g,h,i,j){var k=h.createClass({displayName:'AbstractTextInput',mixins:[g],renderTextField:function(){return this.setTextFieldPropsOn(h.createElement(i,{type:"text",className:"_58al",tabIndex:this.props.tabIndex,onClick:this.props.onClick,onKeyUp:this.props.onKeyUp,onPaste:this.props.onPaste}));}});e.exports=k;},null);
__d("Grid.react",["React","cx","flattenChildren","getObjectValues","joinClasses"],function(a,b,c,d,e,f,g,h,i,j,k){var l=g.PropTypes,m=g.createClass({displayName:'Grid',propTypes:{cols:l.number.isRequired,fixed:l.bool,alignv:l.oneOf(['top','middle','bottom']),alignh:l.oneOf(['left','center','right']),spacing:l.string},render:function(){var p=j(i(this.props.children)),q=p.length,r=[],s=[],t=0;p.forEach(function(u,v){if(u.type!==n.type)u=g.createElement(n,null,u);u.props.alignv=u.props.alignv||this.props.alignv;u.props.alignh=u.props.alignh||this.props.alignh;if(this.props.spacing)o(u,this.props.spacing);s.push(u);t+=Math.max(u.props.colSpan||0,1);if(t%this.props.cols===0||v+1===q){if(this.props.fixed&&t<this.props.cols){for(var w=t;w<this.props.cols;w++)s.push(g.createElement(n,null));t=this.props.cols;}if(t===this.props.cols)o(s[s.length-1],"_51mw");r.push(g.createElement(g.DOM.tr,{className:"_51mx",key:v},s));s=[];t=0;}},this);return (g.createElement(g.DOM.table,Object.assign({},this.props,{className:k(this.props.className,(("uiGrid")+(' '+"_51mz")+(this.props.fixed?' '+"_5f0n":''))),cellSpacing:"0",cellPadding:"0"}),g.createElement(g.DOM.tbody,null,r)));}}),n=g.createClass({displayName:'GridItem',propTypes:{alignv:l.oneOf(['top','middle','bottom']),alignh:l.oneOf(['left','center','right'])},render:function(){var p=k(this.props.className,(("_51m-")+(this.props.alignv==='top'?' '+"vTop":'')+(this.props.alignv==='middle'?' '+"vMid":'')+(this.props.alignv==='bottom'?' '+"vBot":'')+(this.props.alignh==='left'?' '+"hLeft":'')+(this.props.alignh==='center'?' '+"hCent":'')+(this.props.alignh==='right'?' '+"hRght":'')));return (g.createElement(g.DOM.td,Object.assign({},this.props,{className:p})));}}),o=function(p,q){p.props.className=k(p.props.className,q);};m.GridItem=n;e.exports=m;},null);
__d("Emscripten",[],function(a,b,c,d,e,f){e.exports={isSupported:function(){return (typeof Int32Array!=='undefined'&&typeof Float64Array!=='undefined'&&!!new Int32Array(1).subarray&&!!new Int32Array(1).set);}};},null);
__d("XHRHttpError",[],function(a,b,c,d,e,f){var g='HTTP_CLIENT_ERROR',h='HTTP_PROXY_ERROR',i='HTTP_SERVER_ERROR',j='HTTP_TRANSPORT_ERROR',k='HTTP_UNKNOWN_ERROR';function l(m,n){if(n===0){var o=m.getProtocol();if(o==='file'||o==='ftp')return null;return j;}else if(n>=100&&n<200){return h;}else if(n>=200&&n<300){return null;}else if(n>=400&&n<500){return g;}else if(n>=500&&n<600){return i;}else if(n>=12001&&n<12156){return j;}else return k;}e.exports={getErrorCode:l,HTTP_CLIENT_ERROR:g,HTTP_PROXY_ERROR:h,HTTP_SERVER_ERROR:i,HTTP_TRANSPORT_ERROR:j,HTTP_UNKNOWN_ERROR:k};},null);
__d("xhrSimpleDataSerializer",[],function(a,b,c,d,e,f){function g(h){var i=[],j;for(j in h)i.push(encodeURIComponent(j)+'='+encodeURIComponent(h[j]));return i.join('&');}e.exports=g;},null);
__d("XHRRequest",["ErrorUtils","URI","XHRHttpError","getSameOriginTransport","invariant","xhrSimpleDataSerializer"],function(a,b,c,d,e,f,g,h,i,j,k,l){var m={errorCode:null,errorMsg:null,errorType:null},n={loadedBytes:null,totalBytes:null};function o(p){"use strict";this.setURI(p);this.setMethod('POST');this.setIsAsynchronous(true);this.setTransportBuilder(j);this.setDataSerializer(l);this.$XHRRequest0=this.$XHRRequest0.bind(this);}o.prototype.setURI=function(p){"use strict";this.$XHRRequest1=new h(p);return this;};o.prototype.getURI=function(){"use strict";return this.$XHRRequest1;};o.prototype.setMethod=function(p){"use strict";this.$XHRRequest2=p;return this;};o.prototype.getMethod=function(){"use strict";return this.$XHRRequest2;};o.prototype.setData=function(p){"use strict";this.$XHRRequest3=p;return this;};o.prototype.getData=function(){"use strict";return this.$XHRRequest3;};o.prototype.setRawData=function(p){"use strict";this.$XHRRequest4=p;return this;};o.prototype.setRequestHeaderField=function(p,q){"use strict";if(!this.$XHRRequest5)this.$XHRRequest5={};this.$XHRRequest5[p]=q;return this;};o.prototype.setTimeout=function(p){"use strict";this.$XHRRequest6=p;return this;};o.prototype.setResponseHandler=function(p){"use strict";this.$XHRRequest7=p;return this;};o.prototype.setErrorHandler=function(p){"use strict";this.$XHRRequest8=p;return this;};o.prototype.setAbortHandler=function(p){"use strict";this.$XHRRequest9=p;return this;};o.prototype.setTimeoutHandler=function(p){"use strict";this.$XHRRequesta=p;return this;};o.prototype.setUploadProgressHandler=function(p){"use strict";this.$XHRRequestb=p;return this;};o.prototype.setIsAsynchronous=function(p){"use strict";this.$XHRRequestc=p;return this;};o.prototype.setTransportBuilder=function(p){"use strict";this.$XHRRequestd=p;return this;};o.prototype.setDataSerializer=function(p){"use strict";this.$XHRRequeste=p;return this;};o.prototype.send=function(){"use strict";var p=this.$XHRRequest6,q=this.$XHRRequestd(),r=this.getURI();this.$XHRRequestf=q;var s;k(this.$XHRRequest2==='POST'||!this.$XHRRequest4);if(this.$XHRRequest2==='GET'||this.$XHRRequest4){r.addQueryData(this.$XHRRequest3);s=this.$XHRRequest4;}else s=this.$XHRRequeste(this.$XHRRequest3);q.onreadystatechange=this.$XHRRequest0;if(q.upload&&this.$XHRRequestb)q.upload.onprogress=this.$XHRRequestg.bind(this);if(p)this.$XHRRequesth=setTimeout(this.$XHRRequesti.bind(this),p);q.open(this.$XHRRequest2,r.toString(),this.$XHRRequestc);if(this.$XHRRequest5)for(var t in this.$XHRRequest5)q.setRequestHeader(t,this.$XHRRequest5[t]);q.send(s);if(!this.$XHRRequestc)q.onreadystatechange(null,true);};o.prototype.abort=function(){"use strict";this.$XHRRequestj();if(this.$XHRRequest9)g.applyWithGuard(this.$XHRRequest9,null,null,null,'XHRRequest:_abortHandler');};o.prototype.$XHRRequestj=function(){"use strict";var p=this.$XHRRequestf;if(p){p.onreadystatechange=null;p.abort();}this.$XHRRequestk();};o.prototype.$XHRRequesti=function(){"use strict";this.$XHRRequestj();if(this.$XHRRequesta)g.applyWithGuard(this.$XHRRequesta,null,null,null,'XHRRequest:_abortHandler');};o.prototype.$XHRRequest0=function(p,q){"use strict";if(!this.$XHRRequestc&&q!==true)return;var r=this.$XHRRequestf,s=r,t=s.readyState;if(t>=2){var u=t===4,v=this.getURI(),w=i.getErrorCode(v,r.status),x=this.$XHRRequest7;if(w!==null){if(u){m.errorCode=w;m.errorMsg=r.responseText;m.errorType='HTTP';if(this.$XHRRequest8)g.applyWithGuard(this.$XHRRequest8,null,[m],null,'XHRRequest:_errorHandler');}}else if(x){var y=null;if(x.includeHeaders)y=r.getAllResponseHeaders();if(u||(x.parseStreaming&&t===3))g.applyWithGuard(x,null,[r.responseText,y,u],null,'XHRRequest:handler');}if(u)this.$XHRRequestk();}};o.prototype.$XHRRequestg=function(p){"use strict";n.loadedBytes=p.loaded;n.totalBytes=p.total;if(this.$XHRRequestb)g.applyWithGuard(this.$XHRRequestb,null,[n],null,'XHRRequest:_uploadProgressHandler');};o.prototype.$XHRRequestk=function(){"use strict";clearTimeout(this.$XHRRequesth);delete this.$XHRRequestf;};e.exports=o;},null);
__d("getCrossOriginTransport",["ex","invariant"],function(a,b,c,d,e,f,g,h){function i(){try{var k=new XMLHttpRequest();if(!('withCredentials' in k)&&typeof XDomainRequest!=='undefined')k=new XDomainRequest();return k;}catch(j){throw new Error(g('getCrossOriginTransport: %s',j.message));}}i.withCredentials=function(){var j=i();h('withCredentials' in j);var k=j.open;j.open=function(){k.apply(this,arguments);this.withCredentials=true;};return j;};e.exports=i;},null);
__d("WebWorker",["BanzaiLogger","WebWorkerConfig","BlobFactory","EventListener","URI","areSameOrigin","destroyOnUnload","SubscriptionsHandler","XHRRequest","arrayContains","emptyFunction","getCrossOriginTransport","performanceNow","invariant","memoize","merge","filterObject"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w){var x=a.URL||a.webkitURL;function y(ea){"use strict";this.$WebWorker0=false;this.$WebWorker1=null;this.$WebWorker2=ea;this.$WebWorker3=null;this.$WebWorker4=q;this.$WebWorker5=q;this.$WebWorker6=[];this.$WebWorker7=false;this.$WebWorker8=new n();m(function(){if(!this.$WebWorker7)this.terminate();}.bind(this));this.$WebWorker9('constructed');}y.prototype.setMessageHandler=function(ea){"use strict";this.$WebWorker4=ea||q;return this;};y.prototype.setErrorHandler=function(ea){"use strict";this.$WebWorker5=ea||q;return this;};y.prototype.postMessage=function(ea,fa){"use strict";t(!this.isCurrentState('constructed'));t(!this.isCurrentState('terminated'));if(this.isCurrentState('preparing')){this.$WebWorker6.push(this.postMessage.bind(this,ea,fa));return this;}var ga={type:'message',message:ea};if(fa){this.$WebWorker3.postMessage(ga,fa);}else this.$WebWorker3.postMessage(ga);return this;};y.prototype.terminate=function(){"use strict";if(this.isCurrentState('executing'))this.$WebWorker3.terminate();if(!this.isCurrentState('terminated')){this.$WebWorker9('terminated');this.$WebWorker3=null;this.$WebWorkera();this.$WebWorker6=[];}return this;};y.prototype.execute=function(){"use strict";t(!this.isCurrentState('terminated'));if(['preparing','executing'].some(this.isCurrentState,this))return this;this.$WebWorker9('preparing');y.prepareResource(this.$WebWorker2,this.$WebWorkerb.bind(this));return this;};y.prototype.setAllowCrossPageTransition=function(ea){"use strict";this.$WebWorker7=ea;return this;};y.prototype.isCurrentState=function(ea){"use strict";t(p(y.states,ea));return ea===this.$WebWorker1;};y.prototype.$WebWorkerb=function(){"use strict";t(!this.isCurrentState('executing'));if(this.isCurrentState('terminated'))return;t(this.$WebWorker2.sameOriginURL||this.$WebWorker2.source);if(this.$WebWorker2.sameOriginURL){this.$WebWorker3=new a.Worker(this.$WebWorker2.sameOriginURL);}else{this.$WebWorker3=new a.Worker(y.evalWorkerURL);this.$WebWorker3.postMessage(this.$WebWorker2.source);}this.$WebWorkerc('ping',Date.now());this.$WebWorkerd();this.$WebWorker9('executing');this.$WebWorker6.forEach(function(ea){return ea();});this.$WebWorker6=null;};y.prototype.$WebWorkera=function(){"use strict";this.$WebWorker8.release();};y.prototype.$WebWorkerc=function(ea){"use strict";var fa=Array.prototype.slice.call(arguments,1);this.$WebWorker3.postMessage({type:ea,args:fa});};y.prototype.$WebWorkere=function(event,ea){"use strict";y.$WebWorkere(event,this.$WebWorker2.name,v(ea,{cross_page_transition:!!this.$WebWorker7,state:this.$WebWorker1}));};y.$WebWorkerf=function(){"use strict";return Object.keys(w({object_url:y.$WebWorkerg(),eval_url:ca(),data_url:y.$WebWorkerh(),worker:y.isSupported(),transferables:y.areTransferablesSupported()},function(ea){return !!ea;}));};y.prototype.$WebWorkerd=function(){"use strict";this.$WebWorker8.addSubscriptions(j.listen(this.$WebWorker3,'message',this.$WebWorkeri.bind(this)),j.listen(this.$WebWorker3,'error',this.$WebWorkerj.bind(this)));};y.prototype.$WebWorkerj=function(ea){"use strict";var fa=this.$WebWorker5(ea);if(!fa&&!ea.defaultPrevented)this.$WebWorkere('exception',{message:ea.message});};y.prototype.$WebWorkeri=function(event){"use strict";var ea=event.data;switch(ea.type){case 'message':this.$WebWorker4(ea.message);break;case 'pong':this.$WebWorker0=true;this.$WebWorkere('executed',{dt:Math.floor(ea.args[1]-ea.args[0]),bytes:this.$WebWorker2.source.length});break;case 'terminate':this.terminate();break;case 'haste-error':this.terminate();this.$WebWorkere('haste_error',{message:ea.message});break;case 'console':var fa=ea.args.shift();t(p(['log','error','info','debug','warn'],fa));a.console[fa].apply(a.console,ea.args);break;}};y.prototype.$WebWorker9=function(ea){"use strict";t(p(y.states,ea));this.$WebWorkere('transition',{next_state:ea});this.$WebWorker1=ea;};y.prepareResource=function(ea,fa){"use strict";fa=fa||q;t(ea.sameOriginURL||ea.url||ea.source);t(!!y.isSupported());if(ea.sameOriginURL){fa();}else if(ea.url&&l(new k(ea.url),new k(a.location.href))){ea.sameOriginURL=ea.url;fa();}else if(ea.source){if(y.$WebWorkerk())ea.sameOriginURL=y.$WebWorkerl(ea.source);fa();}else if(!ea.loading){var ga=s();ea.loading=[fa];y.$WebWorkerm(ea.url,function(ha){if(ha){ea.source=ha;if(y.$WebWorkerk())ea.sameOriginURL=y.$WebWorkerl(ha);}y.$WebWorkere('prepared',ea.name,{dt:Math.floor(s()-ga),bytes:ha.length});ea.loading.forEach(function(ia){return ia();});ea.loading=false;});}else ea.loading.push(fa);return ea;};y.releaseResource=function(ea){"use strict";if(ea.sameOriginURL.indexOf('blob:')===0){if(x.revokeObjectURL)x.revokeObjectURL(ea.sameOriginURL);ea.sameOriginURL=null;}return ea;};y.isSupported=function(){"use strict";return ba&&(y.$WebWorkerk()||ca());};y.areTransferablesSupported=function(){"use strict";return y.isSupported()&&da();};y.$WebWorkerm=function(ea,fa){"use strict";new o(ea).setTransportBuilder(r).setMethod('GET').setResponseHandler(function(ga){fa(ga);}).setErrorHandler(fa.bind(null,null)).send();};y.$WebWorkerl=function(ea){"use strict";t(y.$WebWorkerk());if(y.$WebWorkerg()){var fa=i.getBlob([ea],{type:'application/javascript'});return x.createObjectURL(fa);}if(y.$WebWorkerh())return 'data:application/javascript,'+encodeURIComponent(ea);};y.$WebWorkerg=function(){"use strict";return i.isSupported()&&z();};y.$WebWorkerh=function(){"use strict";return aa();};y.$WebWorkerk=function(){"use strict";return y.$WebWorkerg()||y.$WebWorkerh();};y.$WebWorkere=function(event,ea,fa){"use strict";if(!h.logging.enabled)return;g.log(h.logging.config,v(fa,{features_array:y.$WebWorkerf(),event:event,resource:ea}));};var z=u(function(){var ea,fa;if(!x||!x.createObjectURL)return false;try{ea=x.createObjectURL(i.getBlob([''],{type:'application/javascript'}));var ha=new a.Worker(ea);ha.terminate();fa=true;}catch(ga){fa=false;}finally{if(x.revokeObjectURL)x.revokeObjectURL(ea);}return fa;}),aa=u(function(){var ea;try{var ga=new a.Worker('data:application/javascript,');ga.terminate();ea=true;}catch(fa){ea=false;}return ea;}),ba=!!a.Worker,ca=u(function(){var ea;try{var ga=new a.Worker(y.evalWorkerURL);ga.terminate();ea=true;}catch(fa){ea=false;}return ea;}),da=u(function(){var ea;try{var ga=new a.Worker(y.evalWorkerURL),ha=new ArrayBuffer(0);ga.postMessage({buffer:ha},[ha]);ga.terminate();ea=true;}catch(fa){ea=false;}return ea;});y.states=['constructed','preparing','executing','terminated'];y.evalWorkerURL=h.evalWorkerURL;e.exports=y;},null);
__d("PooledWebWorker",["WebWorker"],function(a,b,c,d,e,f,g){for(var h in g)if(g.hasOwnProperty(h))j[h]=g[h];var i=g===null?null:g.prototype;j.prototype=Object.create(i);j.prototype.constructor=j;j.__superConstructor__=g;function j(k,l,m){"use strict";i.constructor.call(this,m);this.$PooledWebWorker0=l;this.$PooledWebWorker1=k;}j.prototype.getIndex=function(){"use strict";return this.$PooledWebWorker0;};j.prototype.getPool=function(){"use strict";return this.$PooledWebWorker1;};e.exports=j;},null);
__d("WebWorkerPool",["PooledWebWorker","emptyFunction"],function(a,b,c,d,e,f,g,h){i.isSupported=function(){"use strict";return g.isSupported();};function i(j,k){"use strict";this.$WebWorkerPool0=[];for(var l=0;l<k;l++)this.$WebWorkerPool0.push(new g(this,l,j).setErrorHandler(this.$WebWorkerPool1).setMessageHandler(this.$WebWorkerPool2).execute());this.$WebWorkerPool3=0;}i.prototype.setMessageHandler=function(j){"use strict";this.$WebWorkerPool4=j||h;return this;};i.prototype.setAllowCrossPageTransition=function(j){"use strict";this.$WebWorkerPool0.forEach(function(k){return k.setAllowCrossPageTransition(j);});return this;};i.prototype.setErrorHandler=function(j){"use strict";this.$WebWorkerPool5=j||h;return this;};i.prototype.postMessage=function(){"use strict";var j=Array.prototype.slice.call(arguments,0),k=this.getWorker();k.postMessage.apply(k,j);return k;};i.prototype.$WebWorkerPool2=function(){"use strict";var j=Array.prototype.slice.call(arguments,0);j.unshift(this);this.getPool().$WebWorkerPool4.apply(this.getPool(),j);};i.prototype.$WebWorkerPool1=function(){"use strict";var j=Array.prototype.slice.call(arguments,0);j.unshift(this);return this.getPool().$WebWorkerPool5.apply(this.getPool(),j);};i.prototype.getWorker=function(){"use strict";var j=this.$WebWorkerPool0[this.$WebWorkerPool3];this.$WebWorkerPool3=(this.$WebWorkerPool3+1)%this.$WebWorkerPool0.length;return j;};e.exports=i;},null);
__d("JpegResizer",["Emscripten","JpegResizerConfig","JpegResizeWorkerResource","WebWorker","WebWorkerPool"],function(a,b,c,d,e,f,g,h,i,j,k){var l=null;m.isSupported=function(){"use strict";return k.isSupported()&&g.isSupported()&&!h.isGKBlacklisted;};m.getSingleton=function(){"use strict";if(!l)l=new m(m.DEFAULT_POOL_SIZE).setAllowCrossPageTransition(true);return l;};m.prepareResource=function(n){"use strict";j.prepareResource(i,n);};function m(n){"use strict";n=n||m.DEFAULT_POOL_SIZE;j.prepareResource(i);this.$JpegResizer0=(new k(i,n)).setErrorHandler(this.$JpegResizer1.bind(this)).setMessageHandler(this.$JpegResizer2.bind(this));this.$JpegResizer3={};}m.prototype.setAllowCrossPageTransition=function(n){"use strict";this.$JpegResizer0.setAllowCrossPageTransition(n);return this;};m.prototype.resizeBlob=function(n,o,p){"use strict";var q=this.$JpegResizer0.getWorker();if(q.isCurrentState('terminated')){o(new Error('Worker terminated'));return this;}var r=q.postMessage({blob:n,height:2048,width:2048}).getIndex();this.$JpegResizer4(r).unshift({done:o,progress:p});return this;};m.prototype.$JpegResizer4=function(n){"use strict";if(!this.$JpegResizer3.hasOwnProperty(n))this.$JpegResizer3[n]=[];return this.$JpegResizer3[n];};m.prototype.$JpegResizer1=function(n,o){"use strict";n.terminate();var p=this.$JpegResizer4(n.getIndex());p.forEach(function(q){return q.done(o);});p.length=0;};m.prototype.$JpegResizer2=function(n,o){"use strict";if(o.done){this.$JpegResizer4(n.getIndex()).pop().done(o.error,o.blob,o.skipped);}else{var p=this.$JpegResizer4(n.getIndex()),q=p[p.length-1].progress;if(q)q({written:o.written,total:o.total});}};m.DEFAULT_POOL_SIZE=3;e.exports=m;},null);
__d("DropdownContextualHelpLink",["DOM","ge"],function(a,b,c,d,e,f,g,h){var i={set:function(j){var k=h('navHelpCenter');if(k!==null)g.replace(k,j);}};e.exports=i;},null);
__d("WaterfallIDGenerator",["CurrentUser","md5"],function(a,b,c,d,e,f,g,h){function i(){var l=2147483647;return Math.random()*l;}function j(){return Math.floor(Date.now()/1000);}var k={generate:function(){return h([g.getID(),j(),i()].join(':'));}};e.exports=k;},null);
__d("FileForm",["ArbiterMixin","AsyncRequest","AsyncResponse","AsyncUploadRequest","BehaviorsMixin","CurrentUser","DataStore","DOMQuery","Event","Form","JSONPTransport","Parent","URI","copyProperties","mixin","shield"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){function w(ca){var da={},ea=n.scry(ca,'input[type="file"]');ea.forEach(function(fa){da[fa.name]=fa.files;});return da;}function x(ca){var da=n.scry(ca,'input[type="file"]');da.forEach(function(ea){ea.files=null;});}var y=u(g,k);for(var z in y)if(y.hasOwnProperty(z))ba[z]=y[z];var aa=y===null?null:y.prototype;ba.prototype=Object.create(aa);ba.prototype.constructor=ba;ba.__superConstructor__=y;function ba(ca,da,ea){"use strict";if(ca.getAttribute('rel')==='async')throw new Error('FileForm cannot be used with Primer forms.');if(ca.getAttribute('method').toUpperCase()!=='POST')throw new Error('FileForm must be used with POST forms.');this._form=ca;this._previousEncoding=this._form.enctype;this._form.enctype=this._form.encoding='multipart/form-data';this._files=null;da&&this.enableBehaviors(da);this._options=ea||{};this.setAllowCrossOrigin(this._options.allowCrossOrigin);this.setUploadInParallel(this._options.uploadInParallel);this.setPreprocessHandler(this._options.preprocessHandler);this.setNetworkErrorRetryLimit(this._options.networkErrorRetryLimit);this._listeners=[o.listen(this._form,'submit',this._submit.bind(this)),o.listen(this._form,'click',this._click.bind(this))];m.set(this._form,'FileForm',this);}ba.prototype.getRoot=function(){"use strict";return this._form;};ba.prototype.setAllowCrossOrigin=function(ca){"use strict";this._allowCrossOrigin=!!ca;return this;};ba.prototype.setUploadInParallel=function(ca){"use strict";this._uploadInParallel=!!ca;return this;};ba.prototype.setPreprocessHandler=function(ca){"use strict";this._preprocessHandler=ca;return this;};ba.prototype.setNetworkErrorRetryLimit=function(ca){"use strict";this._retryLimit=ca;return this;};ba.prototype.setFiles=function(ca){"use strict";this._files=ca;return this;};ba.prototype.canUseXHR=function(){"use strict";var ca='FormData' in window;if(ca)if(!s(this._form.action).isSameOrigin()&&!this._allowCrossOrigin)ca=false;return ca;};ba.prototype._submit=function(event){"use strict";if(this.inform('submit')===false){event.prevent();return;}return this.canUseXHR()?this._sendViaXHR(event):this._sendViaFrame(event);};ba.prototype._click=function(event){"use strict";var ca=event.getTarget();while(n.isElementNode(ca)){if(ca.type==='submit'){this._clickTarget=ca;setTimeout(this._unclick.bind(this),0);break;}ca=ca.parentNode;}};ba.prototype._unclick=function(){"use strict";this._clickTarget=null;};ba.prototype._sendViaFrame=function(event){"use strict";var ca=this._request=new h();ca.setStatusElement(this._getStatusElement());ca.addStatusIndicator();ca.setOption('useIframeTransport',true);var da=ca.handleResponse.bind(ca),ea=new q('iframe',this._form.action,da),fa=ea.getTransportFrame(),ga=ea.getRequestURI().addQueryData({__iframe:true,__user:l.getID()});this._form.setAttribute('action',ga.toString());this._form.setAttribute('target',fa.name);ca.setJSONPTransport(ea);ca.setURI(ga);ca.setHandler(this.success.bind(this,null));ca.setErrorHandler(this.failure.bind(this,null));ca.setInitialHandler(v(this.initial,this,null));};ba.prototype._sendViaXHR=function(event){"use strict";var ca;if(this._uploadInParallel&&j.isSupported()){ca=new j().setPreprocessHandler(this._preprocessHandler).setData(p.serialize(this._form,this._clickTarget));ca.setNetworkErrorRetryLimit(this._retryLimit);if(this._files){ca.setFiles(this._files);}else ca.setFiles(w(this._form));var da=[ca.subscribe('progress',function(ia,ja){this.progress(ja,ja.getProgressEvent());}.bind(this)),ca.subscribe('initial',function(ia,ja){this.initial(ja,ja.getResponse());}.bind(this)),ca.subscribe('success',function(ia,ja){this.success(ja,ja.getResponse());}.bind(this)),ca.subscribe('start',function(ia,ja){this.inform('start',{upload:ja});}.bind(this)),ca.subscribe('failure',function(ia,ja){this.failure(ja,ja.getResponse());return false;}.bind(this)),ca.subscribe('complete',function(){while(da.length)da.pop().unsubscribe();})];}else{var ea;if(this._files){ea=p.createFormData(p.serialize(this._form,this._clickTarget));var fa=j.parseFiles(this._files);for(var ga in fa){var ha=fa[ga];if(ha.length===1){ea.append(ga,ha[0]);}else{ga=ga+'[]';ha.forEach(function(ia){ea.append(ga,ia);});}}}else ea=p.createFormData(this._form,this._clickTarget);ca=new h().setRawData(ea).setHandler(this.success.bind(this,null)).setErrorHandler(this.failure.bind(this,null)).setUploadProgressHandler(this.progress.bind(this,null)).setInitialHandler(v(this.initial,this,null));}ca.setAllowCrossOrigin(this._allowCrossOrigin).setRelativeTo(this._form).setStatusElement(this._getStatusElement()).setURI(this._form.action).send();this._request=ca;event&&event.prevent();};ba.prototype.forceSendViaXHR=function(){"use strict";return this._sendViaXHR(null);};ba.prototype.initial=function(ca){"use strict";return this.inform('initial',{upload:ca});};ba.prototype.success=function(ca,da){"use strict";var ea={response:da,upload:ca};if(this.inform('success',ea)!==false)o.fire(this._form,'success',ea);this._cleanup();};ba.prototype.failure=function(ca,da){"use strict";var ea={response:da,upload:ca};if(this.inform('failure',ea)!==false)if(o.fire(this._form,'error',ea)!==false)i.defaultErrorHandler(da);this._cleanup();};ba.prototype.progress=function(ca,event){"use strict";this.inform('progress',{event:event,upload:ca});};ba.prototype.abort=function(){"use strict";if(this._request){this._request.abort();this._cleanup();}};ba.prototype.clear=function(){"use strict";x(this._form);};ba.prototype.destroy=function(){"use strict";this._cleanup();while(this._listeners.length)this._listeners.pop().remove();this._listeners=null;this._form.enctype=this._form.encoding=this._previousEncoding;m.remove(this._form,'FileForm');};ba.prototype._cleanup=function(){"use strict";this._request=null;};ba.prototype._getStatusElement=function(){"use strict";return r.byClass(this._form,'stat_elem')||this._form;};ba.getInstance=function(ca){"use strict";return m.get(ca,'FileForm');};t(ba,{EVENTS:['start','submit','initial','progress','success','failure']});e.exports=ba;},null);
__d("FileFormResetOnSubmit",["DOMQuery","Event","emptyFunction"],function(a,b,c,d,e,f,g,h,i){function j(l,m){var n=h.listen(l,'change',i.thatReturnsFalse,h.Priority.URGENT);try{m();}catch(o){throw o;}finally{n.remove();}}function k(l){"use strict";this._form=l;}k.prototype.enable=function(){"use strict";var l=this._reset.bind(this);this._subscription=this._form.subscribe('submit',function(){setTimeout(l,0);});};k.prototype.disable=function(){"use strict";this._subscription.unsubscribe();this._subscription=null;};k.prototype._reset=function(){"use strict";var l=this._form.getRoot();j(l,function(){var m=g.scry(l,'input[type="file"]');m.forEach(function(n){n.value='';});});};e.exports=k;},null);
__d("PhotosUploadID",[],function(a,b,c,d,e,f){var g=1024,h={getNewID:function(){return (g++).toString();}};e.exports=h;},null);
__d("MercuryFileUploader",["ArbiterMixin","CSS","Dialog","DOM","Event","FileForm","FileFormResetOnSubmit","FileInput","FormSubmitOnChange","MercuryAttachment","MercuryAttachmentTemplates","MercuryConstants","PhotosUploadID","SubscriptionsHandler","csx","fbt","getObjectValues","mixin","shield","startsWith","tx"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa){var ba=x(g);for(var ca in ba)if(ba.hasOwnProperty(ca))ea[ca]=ba[ca];var da=ba===null?null:ba.prototype;ea.prototype=Object.create(da);ea.prototype.constructor=ea;ea.__superConstructor__=ba;function ea(ga,ha,ia,ja){"use strict";this.$MercuryFileUploader0=ga;this.$MercuryFileUploader1={};this.$MercuryFileUploader2={};this.$MercuryFileUploader3={};this.$MercuryFileUploader4={};this.$MercuryFileUploader5={};this.$MercuryFileUploader6={};this.$MercuryFileUploader7=new t();this.$MercuryFileUploader8=new l(ha,[o,m]);this.$MercuryFileUploader8.setAllowCrossOrigin(true);this.$MercuryFileUploader8.setUploadInParallel(true);var ka=j.find(ha,"._4q60"),la=j.find(ka,"._4q61");new n(ka,la,ia);h.hide(this.$MercuryFileUploader0);this.$MercuryFileUploader7.addSubscriptions(this.$MercuryFileUploader8.subscribe('submit',function(){var ma={count:0,file_sizes:[]};if(ia.files){for(var na=0;na<ia.files.length;na++)if(ia.files[na].size>r.AttachmentMaxSize){this.showAttachmentSizeErrorDialog();return false;}var oa={};for(var pa=0;pa<ia.files.length;pa++){var qa=this.$MercuryFileUploader9();this.$MercuryFileUploadera(qa,ia.files[pa].name);ma.count++;ma.file_sizes.push(ia.files[pa].size);oa[qa]=ia.files[pa];}this.$MercuryFileUploader8.setFiles(oa);}else{ja.value=this.$MercuryFileUploader9();this.$MercuryFileUploadera(ja.value,ia.value);ma.count=1;}this.inform('submit',ma);}.bind(this)),this.$MercuryFileUploader8.subscribe('success',this.$MercuryFileUploaderb.bind(this)),this.$MercuryFileUploader8.subscribe('failure',this.$MercuryFileUploaderc.bind(this)),k.listen(la,'click',y(this.inform,this,'open')));}ea.prototype.showAttachmentSizeErrorDialog=function(){"use strict";this.$MercuryFileUploader8.abort();this.$MercuryFileUploader8.clear();new i().setTitle("The file you have selected is too large").setBody("The file you have selected is too large. The maximum size is 25MB.").setButtons(i.OK).setSemiModal(true).show();};ea.prototype.addDroppedFiles=function(ga){"use strict";if(!this.$MercuryFileUploader8||!this.$MercuryFileUploader8.canUseXHR())return;var ha={},ia={count:0,file_sizes:[]};for(var ja=0;ja<ga.length;ja++){var ka=ga[ja];if(ka.size>r.AttachmentMaxSize){this.showAttachmentSizeErrorDialog();return false;}var la=this.$MercuryFileUploader9();this.$MercuryFileUploadera(la,ka.name);ha[la]=ka;ia.file_sizes.push(ka.size);ia.count++;}this.$MercuryFileUploader8.setFiles(ha);this.$MercuryFileUploader8.forceSendViaXHR();this.inform('submit',ia);};ea.prototype.isUploading=function(){"use strict";return !!Object.keys(this.$MercuryFileUploader4).length;};ea.prototype.addCachedAttachments=function(ga){"use strict";ga.forEach(function(ha){var ia=this.$MercuryFileUploader9();this.$MercuryFileUploadera(ia,ha.filename);this.$MercuryFileUploaderd(ia,ha);}.bind(this));};ea.prototype.addCachedImageFiles=function(ga){"use strict";var ha="Photo";ga.forEach(function(ia){var ja=this.$MercuryFileUploader9();this.$MercuryFileUploadera(ja,ha);this.$MercuryFileUploaderd(ja,{filename:ia,image_id:ia,filetype:'image/jpeg'});}.bind(this));};ea.prototype.getAttachments=function(){"use strict";return w(this.$MercuryFileUploader1);};ea.prototype.getImageFiles=function(){"use strict";var ga=Object.keys(this.$MercuryFileUploader2).sort(),ha=[];ga.forEach(function(ia){return ha.push(this.$MercuryFileUploader2[ia]);}.bind(this));return ha;};ea.prototype.getVideoFiles=function(){"use strict";return w(this.$MercuryFileUploader3);};ea.prototype.removeAttachments=function(){"use strict";j.empty(this.$MercuryFileUploader0);this.$MercuryFileUploader1={};this.$MercuryFileUploader2={};this.$MercuryFileUploader3={};this.$MercuryFileUploader5={};this.$MercuryFileUploader4={};this.$MercuryFileUploader6={};h.hide(this.$MercuryFileUploader0);this.inform('dom-updated');};ea.prototype.destroy=function(){"use strict";this.$MercuryFileUploader7&&this.$MercuryFileUploader7.release();this.$MercuryFileUploader8&&this.$MercuryFileUploader8.destroy();this.removeAttachments();};ea.prototype.$MercuryFileUploadera=function(ga,ha){"use strict";var ia=q[':fb:mercury:upload-file-row'].build();this.$MercuryFileUploader5[ga]=ia;this.$MercuryFileUploader4[ga]=true;this.$MercuryFileUploader6[ga]=Date.now();j.appendContent(ia.getNode('iconText'),fa(ha));k.listen(ia.getNode('closeFileUpload'),'click',this.$MercuryFileUploadere.bind(this,ga));j.appendContent(this.$MercuryFileUploader0,ia.getRoot());h.show(this.$MercuryFileUploader0);this.inform('dom-updated');};ea.prototype.$MercuryFileUploadere=function(ga,event){"use strict";if(this.$MercuryFileUploader4[ga]){this.inform('upload-canceled-during-upload');}else if(this.$MercuryFileUploader1[ga]||this.$MercuryFileUploader2[ga]||this.$MercuryFileUploader3[ga])this.inform('upload-canceled-after-uploaded');delete this.$MercuryFileUploader1[ga];delete this.$MercuryFileUploader2[ga];delete this.$MercuryFileUploader3[ga];delete this.$MercuryFileUploader4[ga];delete this.$MercuryFileUploader6[ga];var ha=this.$MercuryFileUploader5[ga];delete this.$MercuryFileUploader5[ga];if(ha){j.remove(ha.getRoot());this.inform('dom-updated');}this.inform('upload-canceled');return false;};ea.prototype.$MercuryFileUploaderf=function(ga,ha){"use strict";var ia=this.$MercuryFileUploader5[ga],ja=p.getAttachIconClassByMime(ha);h.addClass(ia.getNode('iconText'),ja);h.addClass(ia.getRoot(),'done');};ea.prototype.$MercuryFileUploaderd=function(ga,ha){"use strict";if(this.$MercuryFileUploader4[ga]){delete this.$MercuryFileUploader4[ga];if(ha.image_id){this.$MercuryFileUploader2[ga]=ha.image_id;}else if(ha.video_id){this.$MercuryFileUploader3[ga]=ha.video_id;}else this.$MercuryFileUploader1[ga]=ha;this.$MercuryFileUploaderf(ga,ha.filetype);this.inform('one-upload-completed',{upload_time_ms:Date.now()-this.$MercuryFileUploader6[ga]});}if(!this.isUploading())this.inform('all-uploads-completed',{count:this.getAttachments().length});};ea.prototype.$MercuryFileUploaderb=function(event,ga){"use strict";var ha=ga.response.getPayload();this.$MercuryFileUploaderd(this.$MercuryFileUploaderg(ga),ha.metadata[0]);};ea.prototype.$MercuryFileUploaderc=function(event,ga){"use strict";this.inform('one-upload-failed');this.$MercuryFileUploadere(this.$MercuryFileUploaderg(ga),event);};ea.prototype.$MercuryFileUploader9=function(){"use strict";return 'upload_'+s.getNewID();};ea.prototype.$MercuryFileUploaderg=function(ga){"use strict";var ha=ga.response.getPayload();if(ga.upload){return ga.upload.getName();}else return ha.uploadID;};function fa(ga){if(ga&&z(ga,'C:\\fakepath\\'))return ga.substring(12);return ga;}e.exports=ea;},null);
__d("URLScraper",["ArbiterMixin","DataStore","Event","URLMatcher","copyProperties","mixin"],function(a,b,c,d,e,f,g,h,i,j,k,l){var m='scraperLastPermissiveMatch',n=l(g);for(var o in n)if(n.hasOwnProperty(o))q[o]=n[o];var p=n===null?null:n.prototype;q.prototype=Object.create(p);q.prototype.constructor=q;q.__superConstructor__=n;function q(r){"use strict";this.input=r;this.enable();}q.prototype.reset=function(){"use strict";h.set(this.input,m,null);};q.prototype.enable=function(){"use strict";if(this.events)return;var r=function(s){setTimeout(this.check.bind(this,s),30);};this.events=i.listen(this.input,{paste:r.bind(this,false),keydown:r.bind(this,true)});};q.prototype.disable=function(){"use strict";if(!this.events)return;for(var event in this.events)this.events[event].remove();this.events=null;};q.prototype.check=function(r){"use strict";var s=this.input.value;if(r&&q.trigger(s))return;var t=q.match(s),u=j.permissiveMatch(s);if(u&&(u!=h.get(this.input,m))){h.set(this.input,m,u);this.inform('match',{url:t||u,alt_url:u});}};k(q,j);e.exports=q;},null);
__d("MercuryShareLinkUploader",["ArbiterMixin","AsyncRequest","CSS","DOM","Form","URLScraper","WebMessengerEvents","mixin","Event"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){var p=n(g);for(var q in p)if(p.hasOwnProperty(q))s[q]=p[q];var r=p===null?null:p.prototype;s.prototype=Object.create(r);s.prototype.constructor=s;s.__superConstructor__=p;function s(t,u,v,w,x){"use strict";this.$MercuryShareLinkUploader0=t;this.$MercuryShareLinkUploader1=u;this.$MercuryShareLinkUploader2=v;this.$MercuryShareLinkUploader3=x;this.$MercuryShareLinkUploader4=false;this.$MercuryShareLinkUploader5=null;this.$MercuryShareLinkUploader6=null;o.listen(w,'click',this.close.bind(this));o.listen(x,'keyup',function(){!x.value.length&&this.$MercuryShareLinkUploader7.enable();}.bind(this));this.$MercuryShareLinkUploader7=new l(x);this.$MercuryShareLinkUploader7.subscribe('match',function(y,z){this.loadShare(z&&z.url);}.bind(this));}s.prototype.getAttachData=function(){"use strict";return this.loadAttachData(this.$MercuryShareLinkUploader4,this.$MercuryShareLinkUploader0,this.$MercuryShareLinkUploader3);};s.prototype.loadAttachData=function(t,u,v){"use strict";if(t){var w=k.serialize(u),x=w.attachment&&w.attachment.params,y=w.link_metrics?w.link_metrics.no_image:true;if(!x||!x.url)return null;if(v.value.indexOf(x.url)===-1)return w;if(!x.summary&&!x.favicon&&y)if(!x.title||x.url.substr(0,x.title.length)===x.title)return null;return w;}return null;};s.prototype.check=function(){"use strict";this.$MercuryShareLinkUploader7.check();};s.prototype.close=function(){"use strict";this.$MercuryShareLinkUploader8();this.$MercuryShareLinkUploader7.disable();this.inform('closed');};s.prototype.clear=function(){"use strict";this.$MercuryShareLinkUploader8();this.$MercuryShareLinkUploader7.enable();};s.prototype.enable=function(){"use strict";this.$MercuryShareLinkUploader7.enable();};s.prototype.disable=function(){"use strict";this.$MercuryShareLinkUploader7.disable();};s.prototype.loadShare=function(t){"use strict";this.$MercuryShareLinkUploader5=t;this.$MercuryShareLinkUploader6&&this.$MercuryShareLinkUploader6.abort();this.$MercuryShareLinkUploader6=new h().setMethod('POST').setURI('/ajax/share_scrape.php').setData({u:t}).setHandler(this.$MercuryShareLinkUploader9.bind(this).bind(null,t)).setStatusElement(this.$MercuryShareLinkUploader2);this.$MercuryShareLinkUploader6.send();this.inform('link-detected');};s.prototype.$MercuryShareLinkUploader9=function(t,u){"use strict";if(this.$MercuryShareLinkUploader5!==t)return;this.$MercuryShareLinkUploader5=null;this.$MercuryShareLinkUploader6=null;i.show(this.$MercuryShareLinkUploader0);j.empty(this.$MercuryShareLinkUploader1);j.setContent(this.$MercuryShareLinkUploader1,u.payload);this.$MercuryShareLinkUploader4=true;if(!this.getAttachData()){this.close();return;}m.detailDOMChanged();};s.prototype.$MercuryShareLinkUploader8=function(){"use strict";i.hide(this.$MercuryShareLinkUploader0);this.$MercuryShareLinkUploader4=false;this.$MercuryShareLinkUploader5=null;this.$MercuryShareLinkUploader6&&this.$MercuryShareLinkUploader6.abort();this.$MercuryShareLinkUploader6=null;this.$MercuryShareLinkUploader7.reset();m.detailDOMChanged();};e.exports=s;},null);
__d("ChatActivity",["Event","Arbiter","AvailableList","AvailableListConstants","JSLogger","MercuryConfig","PresenceState","UserActivity","copyProperties"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){var p=l.activity_limit||60000,q=l.idle_limit||1800000,r=l.idle_poll_interval||300000,s=k.create('chat_activity'),t=Date.now(),u=t,v=true;function w(){var aa=Date.now();return !!(v&&(aa-t<p));}var x=o(new h(),{isActive:w});function y(){var aa=t;t=Date.now();if(t-aa>q){s.debug('idle_to_active',aa);m.doSync();}x.inform('activity');}i.subscribe(j.ON_AVAILABILITY_CHANGED,function(){if(!i.isUserIdle())u=Date.now();});g.listen(window,'focus',function(){v=true;y();});g.listen(window,'blur',function(){v=false;});n.subscribe(function(){y();});function z(aa){var ba=aa&&aa.at&&m.verifyNumber(aa.at);if(typeof ba!=='number')ba=null;return ba||0;}setInterval(function(){var aa=Date.now(),ba=z(m.get()),ca=Math.max(t,ba,u);if(aa-ca>q){s.debug('idle',{cookie:ba,local:t,presence:u});x.inform('idle',aa-ca);}},r);m.registerStateStorer(function(aa){var ba=z(aa);if(ba<t)aa.at=t;return aa;});h.subscribe(k.DUMP_EVENT,function(aa,ba){ba.chat_activity={activity_limit:p,idle_limit:q,idle_poll_interval:r,last_active_time:t,last_global_active_time:u};});e.exports=x;},null);
__d("MercuryNotificationRenderer",["MercuryAssert","MercuryParticipants","tx","MercuryMessages","MercuryThreads"],function(a,b,c,d,e,f,g,h,i){var j=b('MercuryMessages').get(),k=b('MercuryThreads').get();function l(m,n){g.isThreadID(m);k.getThreadMeta(m,function(o){j.getThreadMessagesRange(m,0,1,function(p){var q=p.length&&p[p.length-1];if(q&&q.author!=h.user){h.get(q.author,function(r){if(o.name){n(i._("{senderName} messaged {groupName}",{senderName:r.short_name,groupName:o.name}));}else n(i._("{name} messaged you",{name:r.short_name}));});}else n("New message!");});});}e.exports={renderDocumentTitle:l};},null);
__d("MercuryTimestampTracker",["MercuryActionTypeConstants","MercuryPayloadSource","MercurySingletonMixin","MercuryServerRequests","copyProperties"],function(a,b,c,d,e,f,g,h,i,j,k){function l(m){this._fbid=m;this._serverRequests=j.getForFBID(this._fbid);this._lastTimestamp=0;this._serverRequests.subscribe('update-messages',function(n,o){if(!o.actions||!o.actions.length)return;if(o.payload_source==h.CLIENT_SEND_MESSAGE||o.payload_source==h.UNKNOWN)return;for(var p=0;p<o.actions.length;p++){var q=o.actions[p],r=q.action_type;if(r==g.USER_GENERATED_MESSAGE&&q.thread_id&&q.timestamp>this._lastTimestamp)this._lastTimestamp=q.timestamp;}}.bind(this));}k(l.prototype,{getLastUserMessageTimestamp:function(){return this._lastTimestamp;}});k(l,i);e.exports=l;},null);
__d("ChatTitleBarBlinker",["ChatActivity","DocumentTitle","JSLogger","MercuryNotificationRenderer","PresenceState","MercuryThreadInformer","MercuryTimestampTracker"],function(a,b,c,d,e,f,g,h,i,j,k){var l=b('MercuryThreadInformer').get(),m=b('MercuryTimestampTracker').get(),n=i.create('chat_title'),o=null,p=0,q=false;function r(){if(o){o.stop();o=null;return true;}return false;}function s(x){var y=x||m.getLastUserMessageTimestamp();if(p<=y){p=y;if(r()||q)k.doSync();}}var t={blink:function(x,y){if(!o&&p<y)j.renderDocumentTitle(x,function(z){if(!o)o=h.blink(z);});},stopBlinking:function(){s();},blinkingElsewhere:function(){q=true;}};function u(x){var y=k.verifyNumber(x.sb2);if(!y||y<=p)return null;return y;}function v(x){var y=x&&u(x);if(y){p=y;n.debug('load',p);r();q=false;}}function w(x){var y=u(x);if(!y){n.debug('store',p);x.sb2=p;q=false;}return x;}k.registerStateStorer(w);k.registerStateLoader(v);l.subscribe('thread-read-changed',function(x,y){var z=m.getLastUserMessageTimestamp(),aa=0;for(var ba in y)if(y[ba].mark_as_read&&y[ba].timestamp>=z&&y[ba].timestamp>aa)aa=y[ba].timestamp;aa&&s(aa);});g.subscribe('activity',function(){s();});(function(){var x=k.getInitial();if(x)p=u(x)||0;})();e.exports=t;},null);
__d("Sound",["SoundInitialData","SoundPlayer","SoundRPC","SoundSynchronizer","URI","UserAgent_DEPRECATED","isFacebookURI"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){var n=null,o={init:function(s){if(!n)h.init(s);},play:function(s,t,u){if(n){i.playRemote(n.contentWindow,s,t,false);}else i.playLocal(s,t,u);},stop:function(s){if(!n)h.stop(s);}},p=new k(location.href);if(p.getSubdomain()&&p.getSubdomain()!=='www')p.setSubdomain('www');var q=p.getDomain();function r(){if(l.ie()<9)return false;if(g.RPC_DISABLED)return false;return j.isSupported()&&i.supportsRPC();}if(m(p)&&location.host!==q&&r()){n=document.createElement('iframe');n.setAttribute('src','//'+q+'/sound_iframe.php');n.style.display='none';document.body.appendChild(n);}e.exports=o;},null);
__d("MercuryBrowserAlerts",["ArbiterMixin","ChatActivity","ChatConfig","ChatOptions","ChatTitleBarBlinker","MercuryParticipants","MercuryThreadMuter","MessagingTag","Sound","copyProperties","MercuryThreads"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){var q=b('MercuryThreads').get();o.init(['audio/ogg','audio/mpeg']);function r(t){if(j.getSetting('sound'))o.play([i.get('sound.notif_ogg_url'),i.get('sound.notif_mp3_url')],t,false);}var s={messageReceived:function(t){if(t.author==l.user||!t.is_unread||(t.folder!=n.INBOX&&t.folder!=n.ARCHIVED))return;var u=t.thread_id,v=h.isActive();if(v){var w=false;s.inform('before-alert',{threadID:u,cancelAlert:function(){w=true;}});}q.getThreadMeta(u,function(x){var y=m.isThreadMuted(x);if(y)return;var z=t.timestamp;if(v){!w&&r(z);}else{k.blink(u,z);r(z);}k.blinkingElsewhere();}.bind(this));}};e.exports=p(s,g);},null);
__d("VideoCallRecordMessageDialog",["AsyncDialog","AsyncRequest","Dialog","URI","tx"],function(a,b,c,d,e,f,g,h,i,j,k){var l={get:function(m,n){var o="Would you like to leave a message?",p="New Message";return new i().setTitle(k._("{firstname} is Unavailable",{firstname:n})).setBody(o).setButtons([{name:'record-message',label:p},i.CANCEL]).setHandler(function(){var q=j('/ajax/messaging/composer.php').setQueryData({ids:[m],autoloadvideo:true}).toString();g.send(new h(q));});}};e.exports=l;},null);
__d("VideoCallCore",["Event","Arbiter","AsyncRequest","AvailableList","AvailableListConstants","Bootloader","ChannelConstants","Cookie","CSS","Dialog","MercuryConfig","UserAgent_DEPRECATED","VideoCallSupport","emptyFunction","ge","PresenceStatus","VideoCallUI","VideoCallTemplates","ShortProfiles","VideoCallRecordMessageDialog"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){var w=b('VideoCallUI').module;b('VideoCallTemplates');var x=[],y=[],z={mightReloadPostInstall:function(){return r.windows();},onVideoMessage:function(ba){x.push(ba);l.loadModules(["VideoCallController"],t);},onRTCMessage:function(ba){if(s.isWebrtcSupported()){y.push(ba);l.loadModules(["FBRTCOfferHandler"],t);}},setMessageHandler:function(ba){this.onVideoMessage=ba;if(ba)while(x.length)ba(x.shift());},setRTCMessageHandler:function(ba){this.onRTCMessage=ba;if(ba)while(y.length)ba(y.shift());},availableForCall:function(ba){var ca=j.get(ba);return ca==k.ACTIVE||ca==k.IDLE;},attachListenerToProfileButton:function(ba){var ca=u('videoCallProfileButton');if(ca){if(!s.isVideoCallSupported()){o.hide(ca);return;}g.listen(ca,'click',function(event){z.startCallOrLeaveMessage(ba,'profile_button_click_timeline');});}},startCallOrLeaveMessage:function(ba,ca){if(this.availableForCall(ba)){z.showOutgoingCallDialog(ba,ca);}else b('ShortProfiles').get(ba,function(da){b('VideoCallRecordMessageDialog').get(ba,da.firstName).show();});},showOutgoingCallDialog:function(ba,ca){var da=ca||'unknown';z.logClick(ba,da);if(s.isWebrtcSupported()&&w){var ea=v.getCapabilities(ba),fa=m.CAPABILITY_VOIP_INTEROP|m.CAPABILITY_VIDEO,ga=ea&fa;if(ga!==0){w.open(ba,true);return;}}z.makeSkypeCall(ba);},makeSkypeCall:function(ba){var ca=s.isPluginInstalled()||q.NewVCGK?'outgoing_dialog.php':'intro.php',da='/ajax/chat/video/'+ca+'?idTarget='+ba;new p().setAllowCrossPageTransition(true).setAsync(new i(da).setHandler(t).setServerDialogCancelHandler(t)).show();},logClick:function(ba,ca){new i().setURI('/ajax/chat/video/log_click.php').setData({targetUserID:ba,clickSource:ca}).setAllowCrossPageTransition(true).setErrorHandler(t).send();}};function aa(){if(!z.mightReloadPostInstall())return;var ba=n.get('vcpwn');if(ba){n.clear('vcpwn');var ca=n.get('vctid');if(ca){n.clear('vctid');if(n.get('vctid'))return;if(ca&&z.isInstalled()){var da='/ajax/chat/video/outgoing_dialog.php?idTarget='+ca;new p().setAllowCrossPageTransition(true).setAsync(new i(da)).show();}}}}h.subscribe(m.getArbiterType('video'),function(ba,ca){z.onVideoMessage(ca.obj);});h.subscribe(m.getArbiterType('webrtc'),function(ba,ca){z.onRTCMessage(ca.obj);});h.subscribe(m.getArbiterType('chat_event'),function(ba,ca){if(ca.obj.event_name=="missed-call")l.loadModules(["VideoCallController"],function(da){da.onMissedCallEvent(ca.obj);});});aa();e.exports=z;},null);
__d("ChatAnimatedGifs",["URI"],function(a,b,c,d,e,f,g){var h={shouldHideBody:function(i){if(!i.has_attachment)return false;for(var j=0;j<i.attachments.length;j++){var k=i.attachments[j];if(k.preview_url){var l=h.getRawUrlFromSafeUrl(k.preview_url);if(i.body==l)return true;}}return false;},getRawUrlFromSafeUrl:function(i){return g(i).getQueryData().url;}};e.exports=h;},null);
__d("ChatAutoSendPhotoUploader",["ArbiterMixin","AsyncUploadRequest","DOM","Event","FileForm","FileFormResetOnSubmit","FileInput","FormSubmitOnChange","JpegResizer","MercuryAttachmentType","PhotosMimeType","PhotosUploadID","SubscriptionsHandler","arrayContains","csx","getImageSize","getObjectValues","invariant","isEmpty","mixin"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z){"use strict";function aa(){return 'upload_'+r.getNewID();}var ba=z(g);for(var ca in ba)if(ba.hasOwnProperty(ca))ea[ca]=ba[ca];var da=ba===null?null:ba.prototype;ea.prototype=Object.create(da);ea.prototype.constructor=ea;ea.__superConstructor__=ba;function ea(fa,ga,ha){this.$ChatAutoSendPhotoUploader0=ha;this.$ChatAutoSendPhotoUploader1=ga;this.$ChatAutoSendPhotoUploader2=new s();this.$ChatAutoSendPhotoUploader3={};this.$ChatAutoSendPhotoUploader4={};this.$ChatAutoSendPhotoUploader5=fa.getAttribute('action');this.$ChatAutoSendPhotoUploader6=new k(fa,[n,l]);this.$ChatAutoSendPhotoUploader6.setAllowCrossOrigin(true);this.$ChatAutoSendPhotoUploader6.setUploadInParallel(true);var ia=i.find(fa,"._4q60"),ja=i.find(ia,"._4q61");new m(ia,ja,ga);this.$ChatAutoSendPhotoUploader2.addSubscriptions(this.$ChatAutoSendPhotoUploader6.subscribe('submit',this.$ChatAutoSendPhotoUploader7.bind(this)),this.$ChatAutoSendPhotoUploader6.subscribe('success',this.$ChatAutoSendPhotoUploader8.bind(this)),this.$ChatAutoSendPhotoUploader6.subscribe('failure',this.$ChatAutoSendPhotoUploader9.bind(this)),this.$ChatAutoSendPhotoUploader6.subscribe('progress',this.$ChatAutoSendPhotoUploadera.bind(this)),j.listen(ja,'click',function(){if(this.$ChatAutoSendPhotoUploaderb)if(o.prepareResource)o.prepareResource();this.inform('open');}.bind(this)));this.$ChatAutoSendPhotoUploaderb=o.isSupported();if(this.$ChatAutoSendPhotoUploaderb)this.$ChatAutoSendPhotoUploader6.setPreprocessHandler(this.$ChatAutoSendPhotoUploaderc.bind(this));}ea.prototype.isUploading=function(){return !y(this.$ChatAutoSendPhotoUploader3);};ea.prototype.destroy=function(){this.$ChatAutoSendPhotoUploader2.release();this.$ChatAutoSendPhotoUploader6.destroy();this.$ChatAutoSendPhotoUploader3={};this.$ChatAutoSendPhotoUploader4={};};ea.prototype.$ChatAutoSendPhotoUploaderd=function(fa,ga){var ha=this.$ChatAutoSendPhotoUploadere(fa);if(ga){ha.preview_width=ga.width;ha.preview_height=ga.height;}return ha;};ea.prototype.$ChatAutoSendPhotoUploadere=function(fa){var ga={upload_id:fa,on_progress:function(ha){this.$ChatAutoSendPhotoUploader2.addSubscriptions(this.subscribe('progress',ha));}.bind(this),on_resizing_progress:function(ha){this.$ChatAutoSendPhotoUploader2.addSubscriptions(this.subscribe('resize_progress',ha));}.bind(this),on_success:function(ha){this.$ChatAutoSendPhotoUploader2.addSubscriptions(this.subscribe('success',ha));}.bind(this),upload_canceled:this.$ChatAutoSendPhotoUploaderf.bind(this),attach_type:p.PHOTO,preview_uploading:true};return ga;};ea.prototype.$ChatAutoSendPhotoUploaderc=function(fa,ga){var ha=fa.getFile();if(!q(ha.type).isJpeg())return ga(fa);o.getSingleton().resizeBlob(ha,function(ia,ja,ka){if(ja)fa.setFile(ja);ga(fa);},this.$ChatAutoSendPhotoUploaderg.bind(this,fa));};ea.prototype.$ChatAutoSendPhotoUploader7=function(){var fa=aa();this.$ChatAutoSendPhotoUploaderh(fa,this.$ChatAutoSendPhotoUploader1.files);};ea.prototype.$ChatAutoSendPhotoUploaderh=function(fa,ga){var ha={};if(typeof FileReader!=='undefined'&&FileReader.prototype.readAsArrayBuffer&&ga&&ga.length===1){this.$ChatAutoSendPhotoUploader3[fa]=fa;ha[fa]=ga[0];var ia=new FileReader();ia.onload=function(){this.inform('submit',{upload_id:fa,preview_attachments:[this.$ChatAutoSendPhotoUploaderd(fa,v(ia.result))]});}.bind(this);ia.onerror=function(){this.inform('submit',{upload_id:fa,preview_attachments:[this.$ChatAutoSendPhotoUploadere(fa)]});}.bind(this);ia.readAsArrayBuffer(ga[0]);}else{var ja=[];if(!ga){this.$ChatAutoSendPhotoUploader3[fa]=fa;this.$ChatAutoSendPhotoUploader0.value=fa;ja.push(this.$ChatAutoSendPhotoUploadere(fa));}else for(var ka=0;ka<ga.length;++ka){var la=aa();ha[la]=ga[ka];this.$ChatAutoSendPhotoUploader3[la]=fa;ja.push(this.$ChatAutoSendPhotoUploadere(la));}this.inform('submit',{upload_id:fa,preview_attachments:ja});}if(Object.keys(ha).length>0)this.$ChatAutoSendPhotoUploader6.setFiles(ha);};ea.prototype.$ChatAutoSendPhotoUploader8=function(event,fa){var ga=this.$ChatAutoSendPhotoUploaderi(fa);if(this.$ChatAutoSendPhotoUploader3[ga]){var ha=this.$ChatAutoSendPhotoUploader3[ga];delete this.$ChatAutoSendPhotoUploader3[ga];var ia=fa.response.getPayload();if(!this.$ChatAutoSendPhotoUploader4[ha])this.$ChatAutoSendPhotoUploader4[ha]=[];this.$ChatAutoSendPhotoUploader4[ha].push({id:ga,fbid:ia.metadata[0].image_id});this.inform('success',{upload_id:ga});if(!this.$ChatAutoSendPhotoUploaderj(ha))this.$ChatAutoSendPhotoUploaderk(ha);}};ea.prototype.$ChatAutoSendPhotoUploaderk=function(fa){x(!this.$ChatAutoSendPhotoUploaderj(fa));this.$ChatAutoSendPhotoUploader4[fa].sort(function(ha,ia){return ha.id<ia.id?-1:1;});var ga=this.$ChatAutoSendPhotoUploader4[fa].map(function(ha){return ha.fbid;});this.inform('all-uploads-completed',{upload_id:fa,image_ids:ga});delete this.$ChatAutoSendPhotoUploader4[fa];};ea.prototype.$ChatAutoSendPhotoUploadera=function(event,fa){this.inform('progress',{upload_id:fa.upload.getName(),event:fa.event});};ea.prototype.$ChatAutoSendPhotoUploaderg=function(fa,event){this.inform('resize_progress',{upload_id:fa.getName(),event:event});};ea.prototype.$ChatAutoSendPhotoUploaderj=function(fa){return t(w(this.$ChatAutoSendPhotoUploader3),fa);};ea.prototype.$ChatAutoSendPhotoUploader9=function(event,fa){var ga=this.$ChatAutoSendPhotoUploaderi(fa);this.$ChatAutoSendPhotoUploaderl(ga,'last-upload-failed');return false;};ea.prototype.$ChatAutoSendPhotoUploaderf=function(fa){this.$ChatAutoSendPhotoUploaderl(fa,'last-upload-canceled');};ea.prototype.$ChatAutoSendPhotoUploaderl=function(fa,ga){if(!this.$ChatAutoSendPhotoUploader3[fa])return;var ha=this.$ChatAutoSendPhotoUploader3[fa];delete this.$ChatAutoSendPhotoUploader3[fa];if(!this.$ChatAutoSendPhotoUploaderj(ha))if(this.$ChatAutoSendPhotoUploader4[ha]){this.$ChatAutoSendPhotoUploaderk(ha);}else this.inform(ga,{upload_id:ha});};ea.prototype.$ChatAutoSendPhotoUploaderi=function(fa){if(fa.upload){return fa.upload.getName();}else return fa.response.getPayload().uploadID;};ea.prototype.uploadFile=function(fa){var ga=aa(),ha={};ha[ga]=fa;var ia=new h(this.$ChatAutoSendPhotoUploader5).setAllowCrossOrigin(true).setRelativeTo(this.$ChatAutoSendPhotoUploader6.getRoot()).setFiles(ha);this.$ChatAutoSendPhotoUploader2.addSubscriptions(ia.subscribe('success',function(event,ja){this.$ChatAutoSendPhotoUploader8(event,{upload:ja,response:ja.getResponse()});}.bind(this)),ia.subscribe('failure',this.$ChatAutoSendPhotoUploader9.bind(this)));ia.send();this.$ChatAutoSendPhotoUploaderh(ga,[fa]);};e.exports=ea;},null);
__d("ChatTabModel",["Arbiter","ArbiterMixin","ChatBehavior","ChatConfig","JSLogger","MercuryAssert","PresenceInitialData","PresenceState","PresenceUtil","areJSONRepresentationsEqual","arrayContains","copyProperties","MercuryServerRequests","MercuryMessages","MercuryThreads","MercuryTimestampTracker"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){var s=b('MercuryServerRequests').get(),t=b('MercuryMessages').get(),u=b('MercuryThreads').get(),v=b('MercuryTimestampTracker').get(),w=[],x=null,y=null,z=null,aa=null;function ba(){return parseInt(m.serverTime,10);}var ca=j.get('tab_max_load_age')||3600000,da=ba()-ca,ea=0,fa=20,ga=k.create('chat_tab_model'),ha=false;function ia(bb){var cb=n.verifyNumber(bb.uct2);if(!cb||typeof cb!=='number'){ga.warn('bad_cookie_version',bb.uct2);return null;}if(cb<ea||cb<da)return null;return cb;}function ja(bb){var cb=ia(bb);if(!cb){var db={};db.old_tabs=bb&&bb.t2&&JSON.stringify(bb.t2);db.old_promoted=bb&&bb.lm2;db.old_time=bb&&bb.uct2;db.old_reason=bb&&bb.tr;db.old_window=bb&&bb.tw;var eb;if(y&&bb.t2)for(var fb=0;fb<bb.t2.length;fb++){var gb=bb.t2[fb];if(gb.i===y)eb=gb.r;}var hb=[];w.forEach(function(ib){if(!ib.fragile){var jb={i:ib.id,si:ib.server_id};if(ib.raised||(ib.id===y&&eb))jb.r=1;hb.push(jb);}});bb.t2=hb;bb.uct2=ea;bb.lm2=x;bb.tr=aa;bb.tw=o.getSessionID();db.new_tabs=JSON.stringify(bb.t2);db.new_promoted=bb.lm2;db.new_time=bb.uct2;db.new_reason=bb.tr;db.new_window=bb.tw;ga.debug('store',db);}else ga.warn('store_bad_state',bb);return bb;}function ka(bb){if(bb){var cb=ia(bb);if(cb&&cb!==ea){var db={};db.old_tabs=JSON.stringify(w);db.old_promoted=x;db.old_time=ea;db.old_reason=aa;db.window_id=o.getSessionID();db.cookie_tabs=bb&&bb.t2&&JSON.stringify(bb.t2);db.cookie_promoted=bb&&bb.lm2;db.cookie_time=bb&&bb.uct2;db.cookie_reason=bb&&bb.tr;db.cookie_window=bb&&bb.tw;ea=cb;aa='load';var eb=la(bb.t2,bb.lm2||null);db.load_result=eb;db.new_tabs=JSON.stringify(w);db.new_promoted=x;db.new_time=ea;db.new_reason=aa;var event='load';if(!ha)event+='_init';ga.log(event,db);return eb;}}else ga.warn('load_bad_state',bb);return false;}function la(bb,cb){if(ma(bb,cb)){var db=w.filter(function(gb){return gb.fragile;}),eb={};x=null;w=bb.map(function(gb){var hb={id:gb.i,server_id:gb.si};if(hb.id==cb)x=hb.id;if(y==gb.i){var ib=ra(y);if(ib!=-1){hb.raised=w[ib].raised;return hb;}else return null;}if(gb.r)hb.raised=true;eb[hb.id]=hb;return hb;});w=w.filter(function(gb){return gb!=null;});if(z)for(var fb in z)if(!eb[fb]||!eb[fb].raised)delete z[fb];db=db.filter(function(gb){return !eb[gb.id];});w=w.concat(db);qa();return true;}return false;}function ma(bb,cb){if(cb!=x)return true;var db=w.filter(function(gb){return !gb.fragile;});if(bb.length!=db.length)return true;for(var eb=0,fb=bb.length;eb<fb;eb++){if(bb[eb].id===y)continue;if(!p(bb[eb],db[eb]))return true;}return false;}function na(bb,cb,db){var eb=ka(n.get());if(cb===undefined||cb>ea){if(bb()){eb=true;aa=db||null;pa(cb);}}else ga.error('rejected',{change_time:cb,state_time:ea});eb&&oa();}function oa(){if(ha)za.inform('chat/tabs-changed',za.get());}function pa(bb){if(bb===undefined)bb=Math.max(v.getLastUserMessageTimestamp()||1,ea+1);ea=bb;n.doSync();}function qa(bb){var cb=w.length-fa;if(cb>0)w=w.filter(function(db){return db.raised||db.id==bb||cb--<=0;});if(cb>0)w=w.filter(function(db){return db.id==x||db.id==bb||cb--<=0;});}function ra(bb){for(var cb=0;cb<w.length;cb++)if(w[cb].id==bb)return cb;return -1;}function sa(bb,cb){var db=u.getThreadMetaNow(bb);if(!db)return false;if(db.is_canonical_user){return va(bb,cb);}else{var eb=ta(bb);if(eb)s.getServerThreadID(bb,function(fb){if(xa(bb,fb)){pa();oa();}});return eb;}}function ta(bb){if(ra(bb)===-1){w.push({id:bb,fragile:true});ga.log('open_fragile_tab',{tabs:JSON.stringify(w),opened:bb,window_id:o.getSessionID()});return true;}return false;}function ua(bb){var cb=[];bb.forEach(function(db){var eb=ra(db);if(eb!==-1)cb.push(w[eb]);});w.forEach(function(db){if(!q(bb,db.id))cb.push(db);});na(function(){if(ma(cb,x)){w=cb;return true;}return false;});}function va(bb,cb){var db=ra(bb);if(db!=-1)if(w[db].fragile){w.splice(db,1);}else{cb&&(w[db].signatureID=cb);return true;}for(var eb=0;eb<=w.length;eb++)if(eb==w.length||w[eb].fragile){w.splice(eb,0,{id:bb,signatureID:cb});qa(bb);ga.log('open_tab',{tabs:JSON.stringify(w),opened:bb,window_id:o.getSessionID()});return true;}}function wa(bb){var cb=ra(bb);if(cb!=-1&&(!w[cb].raised||x!==bb)){w[cb].raised=true;x=bb;return true;}return false;}function xa(bb,cb){var db=ra(bb);if(db!=-1&&w[db].fragile){var eb=w[db];eb.fragile=false;eb.server_id=cb;var fb=[];w.forEach(function(gb){if(gb.id!=bb){if(eb&&gb.fragile){fb.push(eb);eb=null;}fb.push(gb);}});if(eb)fb.push(eb);w=fb;ga.log('make_permanent',{tabs:JSON.stringify(w),tab_id:bb,window_id:o.getSessionID()});return true;}return false;}function ya(bb){var cb=ra(bb);if(bb==x)x=null;if(cb!=-1){w.splice(cb,1);ga.log('close_tab',{tabs:JSON.stringify(w),closed:bb,window_id:o.getSessionID()});return true;}return false;}n.registerStateStorer(ja);n.registerStateLoader(function(bb){if(ka(bb))oa();});function za(){}r(za,h,{isTabPromoted:function(bb){if(bb)return bb==x;return false;},indexOf:function(bb){return ra(bb);},getTab:function(bb){l.isThreadID(bb);var cb=this.indexOf(bb);if(cb>-1){var db=w[cb];return r({},db);}return null;},getEmptyTab:function(){var bb;for(var cb=0;cb<w.length;cb++){bb=w[cb].id;if(u.isNewEmptyLocalThread(bb))return bb;}bb='root:'+t.generateNewClientMessageID(Date.now());u.createNewLocalThread(bb,[]);return bb;},getServerTime:function(){return ba();},changeShowingTabs:function(bb){return ua(bb);},closeAllTabs:function(){if(w.length){ga.log('close_all_tabs',{closed_tabs:JSON.stringify(w),window_id:o.getSessionID()});w=[];x=null;if(z)z={};pa();oa();}},closeFragileTabs:function(){var bb=[];for(var cb=0;cb<w.length;cb++)if(w[cb].fragile&&!u.isNewEmptyLocalThread(w[cb].id)){bb.push(w[cb]);w.splice(cb);oa();break;}ga.log('close_fragile_tabs',{tabs:JSON.stringify(w),fragile_closed:bb,window_id:o.getSessionID()});},closeTab:function(bb,cb){l.isThreadID(bb);var db=false;if(z){delete z[bb];db=true;}na(function(){if(ya(bb))db=true;return db;},undefined,cb);},raiseTab:function(bb,cb,db){l.isThreadID(bb);var eb=false;if(z&&cb){z[bb]=true;eb=true;}if(!cb&&bb===y){eb&&oa();return;}na(function(){if(sa(bb,db))eb=true;var fb=ra(bb);if(fb!=-1&&!w[fb].raised){w[fb].raised=true;eb=true;ga.log('raise_tab',{tabs:JSON.stringify(w),raised:bb,window_id:o.getSessionID()});}return eb;});},get:function(){var bb=w.map(function(cb){var db=r({},cb);delete db.fragile;if(z)db.raised=z[db.id];return db;});return {tabs:bb,promoted:x};},openFragileTab:function(bb){l.isThreadID(bb);if(ta(bb))oa();},openTab:function(bb){l.isThreadID(bb);na(sa.bind(null,bb));},lowerTab:function(bb){l.isThreadID(bb);var cb=false;if(z){delete z[bb];cb=true;}na(function(){var db=ra(bb);if(db!=-1&&w[db].raised){delete w[db].raised;ga.log('lower_tab',{tabs:JSON.stringify(w),lowered:bb,window_id:o.getSessionID()});cb=true;}return cb;});},raiseAndPromoteTab:function(bb,cb,db,eb,fb){l.isThreadID(bb);var gb=false;if(z&&cb){z[bb]=true;gb=true;}if(!cb&&bb===y){gb&&oa();return;}na(function(){if(sa(bb,db))gb=true;if(wa(bb)){gb=true;ga.log('raise_and_promote_tab',{tabs:JSON.stringify(w),promoted:bb,window_id:o.getSessionID()});}return gb;},eb,fb);},setPromotedTab:function(bb){l.isThreadID(bb);na(wa.bind(null,bb));},promoteThreadInPlaceOfThread:function(bb,cb,db,eb){l.isThreadID(bb);l.isThreadID(cb);na(function(){var fb=ra(bb),gb=ra(cb);if(eb){x=bb;}else if(x===cb)return true;var hb=w[fb];if(db){l.isThreadID(db);var ib=ra(db),jb=w[gb];w[gb]=hb;w.splice(fb,1);w.splice(ib,0,jb);}else{w[fb]=w[gb];w[gb]=hb;}return true;});},squelchTab:function(bb){l.isThreadID(bb);y=bb;this.lowerTab(bb);ga.log('squelch_tab',{squelched:bb,tabs:JSON.stringify(w),window_id:o.getSessionID()});},clearSquelchedTab:function(){if(y)ga.log('unsquelch_tab',{squelched:y,tabs:JSON.stringify(w),window_id:o.getSessionID()});y=null;},persistLocalRaised:function(){if(z){na(function(){var bb=false;w.forEach(function(cb){if(cb.raised!=z[cb.id]){bb=true;if(z[cb.id]){cb.raised=true;}else delete cb.raised;}});return bb;});ga.log('persist_local_raise',{tabs:JSON.stringify(w),window_id:o.getSessionID()});}}});g.subscribe(k.DUMP_EVENT,function(bb,cb){cb.chat_tabs={promoted:x,tabs:w.map(function(db){return r({},db);}),time:ea,max_load_age:ca};});function ab(){var bb=i.ignoresRemoteTabRaise();if(bb&&!z){ga.log('start_ignore_remote_raise');z={};oa();}else if(!bb&&z){ga.log('stop_ignore_remote_raise');z=null;oa();}}i.subscribe(i.ON_CHANGED,ab);ab();ka(n.getInitial(),true);if(ea===0)ea=ba()-600000;ha=true;e.exports=za;},null);
__d("MessagesEmoticons.react",["Grid.react","React","cx","emptyFunction","fbt"],function(a,b,c,d,e,f,g,h,i,j,k){var l=g.GridItem,m=8,n={smile:"smile",frown:"frown",tongue:"tongue",grin:"grin",gasp:"gasp",wink:"wink",pacman:"pacman",grumpy:"grumpy",unsure:"unsure",cry:"cry",kiki:"kiki",glasses:"glasses",sunglasses:"sunglasses",heart:"heart",devil:"devil",angel:"angel",squint:"squint",confused:"confused",upset:"upset",colonthree:"colonthree",like:"like"},o=h.createClass({displayName:'MessagesEmoticons',propTypes:{onEmoticonSelect:h.PropTypes.func},getDefaultProps:function(){return {onEmoticonSelect:j};},getEmoticons:function(){return Object.keys(n).map(function(p){return (h.createElement(l,{key:p},h.createElement(h.DOM.div,{className:"panelCell"},h.createElement(h.DOM.a,{'aria-label':n[p],className:'emoticon emoticon_'+p,onClick:function(){return this.props.onEmoticonSelect(p);}.bind(this)}))));}.bind(this));},render:function(){return (h.createElement(h.DOM.div,{className:"emoticonsTable"},h.createElement(g,{cols:m,alignv:"middle",alignh:"center",spacing:"pam"},this.getEmoticons())));}});e.exports=o;},null);
__d("StickersDispatcher",["Dispatcher","StickerConstants","copyProperties","merge"],function(a,b,c,d,e,f,g,h,i,j){'use strict';var k=i(new g(),{_handleUpdate:function(l,m){var n=j({payloadSource:l},m);this.dispatch(n);},handleUpdateFromViewActions:function(l){this._handleUpdate(h.PayloadSource.VIEW_ACTION,l);}});e.exports=k;},null);
__d("StickerActions",["StickerConstants","StickersDispatcher"],function(a,b,c,d,e,f,g,h){'use strict';var i={addPack:function(j){h.handleUpdateFromViewActions({actions:[{actionType:g.ActionTypes.ADD_PACK,packID:j}]});},removePack:function(j){h.handleUpdateFromViewActions({actions:[{actionType:g.ActionTypes.REMOVE_PACK,packID:j}]});},selectPack:function(j){h.handleUpdateFromViewActions({actions:[{actionType:g.ActionTypes.SELECT_PACK,packID:j}]});},resetNumNewPacks:function(){h.handleUpdateFromViewActions({actions:[{actionType:g.ActionTypes.RESET_NUM_NEW_PACKS}]});}};e.exports=i;},null);
__d("XStickerPackImagesControllerURIBuilder",["XControllerURIBuilder"],function(a,b,c,d,e,f){e.exports=b("XControllerURIBuilder").create("\/stickers\/{pack_id}\/images\/",{pack_id:{type:"Int",required:true},sticker_size:{type:"Int"}});},null);
__d("XStickersAddPackControllerURIBuilder",["XControllerURIBuilder"],function(a,b,c,d,e,f){e.exports=b("XControllerURIBuilder").create("\/stickers\/addpack\/",{pack_id:{type:"Int"},size:{type:"String"},redirect_uri:{type:"String"},is_promoted:{type:"Bool"}});},null);
__d("XStickersRemovePackControllerURIBuilder",["XControllerURIBuilder"],function(a,b,c,d,e,f){e.exports=b("XControllerURIBuilder").create("\/stickers\/removepack\/",{pack_id:{type:"Int"},size:{type:"String"},redirect_uri:{type:"String"}});},null);
__d("XStickerStateInitialDataControllerURIBuilder",["XControllerURIBuilder"],function(a,b,c,d,e,f){e.exports=b("XControllerURIBuilder").create("\/stickers\/state\/",{});},null);
__d("XStickerStatePackDataControllerURIBuilder",["XControllerURIBuilder"],function(a,b,c,d,e,f){e.exports=b("XControllerURIBuilder").create("\/stickers\/state\/pack\/",{pack_id:{type:"Int",required:true}});},null);
__d("XStickerStateStoreDataControllerURIBuilder",["XControllerURIBuilder"],function(a,b,c,d,e,f){e.exports=b("XControllerURIBuilder").create("\/stickers\/state\/store\/",{});},null);
__d("XStickerSearchNUXSeenControllerURIBuilder",["XControllerURIBuilder"],function(a,b,c,d,e,f){e.exports=b("XControllerURIBuilder").create("\/stickers\/searchNUX\/seen\/",{tooltip_only:{type:"Bool"}});},null);
__d("XStickerTagImagesControllerURIBuilder",["XControllerURIBuilder"],function(a,b,c,d,e,f){e.exports=b("XControllerURIBuilder").create("\/stickers\/tag\/images\/",{tag_ids:{type:"IntVector",required:true}});},null);
__d("XStickerTagDataControllerURIBuilder",["XControllerURIBuilder"],function(a,b,c,d,e,f){e.exports=b("XControllerURIBuilder").create("\/stickers\/tag\/data\/",{});},null);
__d("XStickerQueryImagesControllerURIBuilder",["XControllerURIBuilder"],function(a,b,c,d,e,f){e.exports=b("XControllerURIBuilder").create("\/stickers\/query\/images\/",{query:{type:"String",required:true}});},null);
__d("StickerServerRequests",["AsyncRequest","Promise","XStickerPackImagesControllerURIBuilder","XStickersAddPackControllerURIBuilder","XStickersRemovePackControllerURIBuilder","XStickerStateInitialDataControllerURIBuilder","XStickerStatePackDataControllerURIBuilder","XStickerStateStoreDataControllerURIBuilder","XStickerSearchNUXSeenControllerURIBuilder","XStickerTagImagesControllerURIBuilder","XStickerTagDataControllerURIBuilder","XStickerQueryImagesControllerURIBuilder"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){'use strict';var s={addPack:function(u,v,w){var x=new j().setInt('pack_id',u).setBool('is_promoted',v).getURI();new g(x).setHandler(function(y){return w(y.payload);}).send();},removePack:function(u,v){var w=new k().setInt('pack_id',u).getURI();new g(w).setHandler(function(x){return v(x.payload);}).send();},getStickersForPack:function(u,v){var w=new i().setInt('pack_id',u).setInt('sticker_size',v).getURI();return new h(function(x,y){return new g().setURI(w).setMethod("POST").setHandler(function(z){return x(z.payload);}).send();});},getStickersForTags:function(u,v){new g().setURI(new p().setIntVector('tag_ids',u).getURI()).setMethod("POST").setHandler(function(w){return v(w);}).send();},getStickersForQuery:function(u,v){new g().setURI(new r().setString('query',u).getURI()).setMethod("POST").setHandler(function(w){return v(w);}).send();},fetchTrayData:function(u){return t(new l().getURI(),u,true);},fetchStoreData:function(u){return t(new n().getURI(),u);},fetchPackData:function(u,v){return t(new m().setInt('pack_id',u).getURI(),v);},fetchTagData:function(u){return t(new q().getURI(),u,true);},markSeenSearchNUX:function(){new g(new o().setBool('tooltip_only',false).getURI().toString()).send();},markSeenSearchTooltipNUX:function(){new g(new o().setBool('tooltip_only',true).getURI().toString()).send();}};function t(u,v,w){return new h(function(x,y){return new g(u).setHandler(function(z){return x(z.getPayload());}).setAllowCrossPageTransition(w).send();}).then(v);}e.exports=s;},null);
__d("StickerImages",["StickerServerRequests"],function(a,b,c,d,e,f,g){'use strict';var h={},i={},j={},k={requestStickersForTags:function(l,m){var n=l.filter(function(o){return !j[o.id];}).map(function(o){return o.id;});if(n.length>0){g.getStickersForTags(n,function(o){for(var p in o.payload)j[p]=o.payload[p];m();});}else m();},getStickerTagsData:function(){return j;},requestStickersForPack:function(l,m,n){if(!l)return;if(!i[l]){i[l]=g.getStickersForPack(l,m);i[l].then(function(o){o.forEach(function(p){return this.cacheSticker(p);}.bind(this));}.bind(this));}i[l].then(function(o){return n(o);});},cacheSticker:function(l){h[l.id]=l;},getSticker:function(l){return h[l];}};e.exports=k;},null);
__d("StickerState",["ImmutableObject","StickerConfig","PresenceState","StickerConstants","StickerImages","StickersDispatcher","StickerServerRequests","mixInEventEmitter"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){'use strict';var o={},p,q,r,s=null,t=0,u={},v=[],w=[],x=[],y=null,z=i.get();if(z)y=z.tray_pack_id;var aa=h.ShowStickerReplyNUX,ba=h.ShowStickerSearchNUXIndicator,ca=h.ShowStickerSearchNUXTooltip,da={onTrayDataReady:function(ga){if(!q)q=m.fetchTrayData(function(ha){v=ha.packs.map(function(ia){return ea(ia);});r=ha.mru;t=ha.num_new_packs;x=ha.tags;});q.then(ga);},onStoreDataReady:function(ga){if(!p)p=m.fetchStoreData(function(ha){w=ha.packs.map(function(ia){return ea(ia);});});p.then(ga);},onPackDataReady:function(ga,ha){if(!o[ga])o[ga]=m.fetchPackData(ga,function(ia){ea(ia);});o[ga].then(ha);},getPacksInTray:function(){return v;},getPacksInCommentsTray:function(){return v.filter(function(ga){return !ga.isMessengerOnly;});},getPackIDsInTray:function(){return v.map(function(ga){return ga.id;});},getPacksInStore:function(){return w;},getPack:function(ga){return u[ga];},getNumNewPacks:function(){return t;},getFeaturedTags:function(){return x;},resetNumNewPacks:function(){if(t){t=0;this.emit(this.NUM_NEW_PACKS_CHANGED,0);}},addMRUPack:function(){if(r){this._addPackToTray(r,false);r=null;}},addPack:function(ga){var ha=false;if(u[ga])ha=u[ga].isPromoted;m.addPack(ga,ha,function(ia){this._addPackToTray(ia,ha);}.bind(this));},removePack:function(ga){m.removePack(ga,function(ha){v=v.filter(function(ia){return ia.id!==ha;});u[ha]=g.set(u[ha],{isInTray:false});w=w.map(function(ia){return u[ia.id];});this.emit(this.PACKS_CHANGED,ha);}.bind(this));},setTrayPackID:function(ga){if(!(h.SearchPackNotSticky&&ga==j.SEARCH_PACK_ID)){y=ga;i.doSync();}this.emit(da.PACK_SELECTED,ga);},getTrayPackID:function(){return y;},shouldShowStickerReplyNUX:function(){return aa;},clearShowStickerReplyNUX:function(){aa=false;},shouldShowStickerSearchNUXIndicator:function(){return ba;},shouldShowStickerSearchNUXTooltip:function(){return ca;},clearShowStickerSearchNUXIndicator:function(){m.markSeenSearchNUX();ba=false;},_addPackToTray:function(ga,ha){ea(ga);u[ga.id]=g.set(u[ga.id],{isPurchased:true,isInTray:true,isPromoted:false});if(!ha){var ia=v.filter(function(ja){return ja.isMRU||ja.isSearch;}).length;v.splice(ia,0,u[ga.id]);}w=w.map(function(ja){return u[ja.id];});this.emit(this.PACKS_CHANGED,ga.id);},_addRecentlyUsedSticker:function(ga){for(var ha=0;ha<s.length;++ha)if(s[ha].id===ga.id){s.splice(ha,1);break;}s.unshift(ga);},getMRUStickerPack:function(ga){if(!s)s=ga;return s;},updateRecentlyUsed:function(ga){if(!s){this.addMRUPack();return;}this._addRecentlyUsedSticker(k.getSticker(ga));}};l.register(function(ga){if(ga.actions&&ga.actions.length){var ha=j.ActionTypes;ga.actions.forEach(function(ia){switch(ia.actionType){case ha.ADD_PACK:da.addPack(ia.packID);break;case ha.REMOVE_PACK:da.removePack(ia.packID);break;case ha.SELECT_PACK:da.setTrayPackID(ia.packID);break;case ha.RESET_NUM_NEW_PACKS:da.resetNumNewPacks();break;}});}});da.PACKS_CHANGED='StickerState/packsChanged';da.PACK_SELECTED='StickerState/packSelected';da.NUM_NEW_PACKS_CHANGED='StickerState/numNewPacksChanged';i.registerStateStorer(function(ga){ga.tray_pack_id=y;});function ea(ga){var ha=ga.id;if(!u[ha]){return (u[ha]=new g(ga));}else return (u[ha]=g.set(u[ha],ga));}var fa={};fa[da.PACK_SELECTED]=true;fa[da.PACKS_CHANGED]=true;fa[da.NUM_NEW_PACKS_CHANGED]=true;n(da,fa);e.exports=da;},null);
__d("DialogFitHeight",["CSS","DOM","Event","Style","SubscriptionsHandler","Vector","csx","cx","throttle"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){var p=450,q=100,r=67,s=67;function t(u){"use strict";this.$DialogFitHeight0=u;}t.prototype.enable=function(){"use strict";this.$DialogFitHeight1=new k();this.$DialogFitHeight1.addSubscriptions(this.$DialogFitHeight0.subscribe('beforeshow',this.$DialogFitHeight2.bind(this)),i.listen(window,'resize',o(this.$DialogFitHeight2.bind(this))));this.$DialogFitHeight3=h.find(this.$DialogFitHeight0.getRoot(),"._4-i2");g.addClass(this.$DialogFitHeight3,"_5pfh");this.$DialogFitHeight4=q;if(h.scry(this.$DialogFitHeight0.getRoot(),"._4-i0").length)this.$DialogFitHeight4+=r;if(h.scry(this.$DialogFitHeight0.getRoot(),"._5a8u").length)this.$DialogFitHeight4+=s;};t.prototype.disable=function(){"use strict";this.$DialogFitHeight1.release();this.$DialogFitHeight1=null;g.removeClass(this.$DialogFitHeight3,"_5pfh");};t.prototype.$DialogFitHeight2=function(){"use strict";var u=l.getViewportDimensions().y,v=u-this.$DialogFitHeight4;j.set(this.$DialogFitHeight3,'height',Math.max(p,v)+'px');this.$DialogFitHeight0.updatePosition();};e.exports=t;},null);
__d("StickerStoreController",["Bootloader","DialogFitHeight","DOM","Event","Keys","LayerFadeOnHide","React","XUIDialog.react","XUIDialogBody.react","XUISpinner.react","cx","requestAnimationFrame"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){'use strict';var s=688,t=null,u=null,v=m.createClass({displayName:'StoreLayer',getInitialState:function(){return {renderStore:function(){return (m.createElement(m.DOM.div,{className:"_5r5e"},m.createElement(p,{background:"light",size:"large"})));}};},componentDidMount:function(){g.loadModules(["StickerStore.react"],function(aa){this.setState({renderStore:function(){return (m.createElement(aa,{currentPackID:this.props.packID,onPackSelect:this._packSelected,shown:this.props.shown}));}.bind(this)});}.bind(this));},_packSelected:function(aa){this.setProps({packID:aa});},_onToggle:function(aa){r(this.setProps.bind(this,{shown:aa},null));},render:function(){return (m.createElement(n,{behaviors:{DialogFitHeight:h,LayerFadeOnHide:l},onToggle:this._onToggle,shown:this.props.shown,width:s},m.createElement(o,{className:"_5rq-"},this.state.renderStore())));}});function w(aa){var ba=i.create('div');i.appendContent(document.body,ba);u=m.renderComponent(m.createElement(v,{packID:aa,shown:true}),ba);}function x(){if(t)return;t=j.listen(document.body,'keydown',function(event){if(event.keyCode==k.ESC)z.hideStore();});}function y(){if(t){t.remove();t=null;}}var z={showStore:function(aa){if(!u){w(aa);}else u.setProps({shown:true,packID:aa});x();},hideStore:function(){u&&u.setProps({shown:false});y();}};e.exports=z;},null);
__d("StickersFlyoutPackSelector.react",["Animation","ImmutableObject","Locale","React","Image.react","StickerActions","StickerConfig","StickerConstants","StickerState","StickerStoreController","XUIBadge.react","cx","emptyFunction","fbt","ix"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u){'use strict';var v=4,w=200,x="Sticker Store",y=j.createClass({displayName:'StickersFlyoutPackSelector',propTypes:{numNewPacks:j.PropTypes.number,packs:j.PropTypes.arrayOf(j.PropTypes.instanceOf(h)).isRequired,onPackClick:j.PropTypes.func,selectedPackID:j.PropTypes.string,resetTagSelectorFunc:j.PropTypes.func},getInitialState:function(){return {animating:false,page:0};},getDefaultProps:function(){return {numNewPacks:0};},shouldComponentUpdate:function(aa,ba){return !ba.animating;},onFlyoutShown:function(){if(this.props.packs.length>0){var aa=this._calculatePageForPack(this.props.selectedPackID);if(this.state.page!==aa)this._setPage(aa,0);}},_calculatePageForPack:function(aa){for(var ba=0;ba<this.props.packs.length;ba++)if(this.props.packs[ba].id==aa)return ba<=v?0:Math.floor((ba-1)/v);return 0;},_setPage:function(aa,ba){if(this.state.animating)return;this.setState({animating:true,page:aa},function(){var ca=this.refs.positioner.getDOMNode(),da=this._calculatePosition(aa);new g(ca).to(da.reference,da.offset+'px').ondone(function(){return this.setState({animating:false});}.bind(this)).duration(ba).go();});},_calculatePosition:function(aa){var ba=this.refs.positioner.getDOMNode(),ca=ba.childNodes[aa].offsetLeft;if(i.isRTL()){var da=ba.offsetWidth,ea=ba.childNodes[aa].offsetWidth;return {reference:'right',offset:ca+ea-da};}return {reference:'left',offset:-ca};},_numPages:function(){return Math.max(1,Math.ceil((this.props.packs.length-1)/v));},_canGoPrev:function(){return this.state.page>0;},_canGoNext:function(){return this.state.page+1<this._numPages();},_goPrev:function(){this._canGoPrev()&&this._setPage(this.state.page-1,w);},_goNext:function(){this._canGoNext()&&this._setPage(this.state.page+1,w);},_openStore:function(){l.resetNumNewPacks();p.showStore();},render:function(){return (j.createElement(j.DOM.div,{className:"_5r85"},this._renderStoreButton(),this._renderPrevArrow(),this._renderNextArrow(),j.createElement(j.DOM.div,{className:"_5r88"},j.createElement(j.DOM.div,{className:"_5r89",ref:"positioner"},this._renderPages()))));},_selectPack:function(aa){var ba=o.getPack(aa);if(ba&&ba.isPromoted)l.addPack(aa);if(aa===n.SEARCH_PACK_ID)this.props.resetTagSelectorFunc();if(this.props.onPackClick){this.props.onPackClick(aa);}else l.selectPack(aa);},_renderPages:function(){var aa=this.props.packs.map(function(ea){return j.createElement(z,{key:ea.id,onClick:function(){return this._selectPack(ea.id);}.bind(this),pack:ea,selected:this.props.selectedPackID===ea.id});}.bind(this)),ba=[];for(var ca=0;ca<aa.length;ca+=v){var da=ca;ca===0&&ca++;ba.push(j.createElement(j.DOM.div,{className:"_5r81",key:ca},aa.slice(da,ca+v)));}return ba;},_renderStoreButton:function(){return (j.createElement(j.DOM.a,{'aria-label':x,className:"_5r86 rfloat",'data-hover':"tooltip",onClick:this._openStore},j.createElement(k,{className:"_5r87",src:u('/images/messaging/stickers/selector/store.png')}),this._renderJewel()));},_renderJewel:function(){var aa=this.props.numNewPacks;if(!aa)return null;return (j.createElement(q,{className:"rfloat _3fhs",count:aa,maxcount:9,type:"special"}));},_renderPrevArrow:function(){if(!this._canGoPrev())return null;return (j.createElement(j.DOM.a,{className:(("_37wu")+(' '+"lfloat")),onClick:this._goPrev},j.createElement(k,{className:"_5r84",src:u('/images/messaging/stickers/selector/leftarrow.png')})));},_renderNextArrow:function(){if(!this._canGoNext())return null;return (j.createElement(j.DOM.a,{className:(("_37wv")+(' '+"rfloat")),onClick:this._goNext},j.createElement(k,{className:"_5r84",src:u('/images/messaging/stickers/selector/rightarrow.png')})));}}),z=j.createClass({displayName:'PackIcon',propTypes:{pack:j.PropTypes.instanceOf(h).isRequired,selected:j.PropTypes.bool,onClick:j.PropTypes.func},getDefaultProps:function(){return {onClick:s};},render:function(){var aa=this.props.pack,ba=(("_5r8a")+(this.props.selected?' '+"_5r8b":''));return (j.createElement(j.DOM.a,{'aria-label':aa.name,className:ba,'data-id':aa.id,'data-hover':"tooltip",ref:"search_icon",onClick:function(){return this.props.onClick(aa.id);}.bind(this),tabIndex:"0"},j.createElement(k,{className:(("_5r8c")+(aa.isPromoted?' '+"_182h":'')+(m.WebStickerSearch?' '+"_1viy":'')),src:aa.icon}),j.createElement(k,{className:(("_5r8d")+(m.WebStickerSearch?' '+"_1viy":'')),src:aa.selectedIcon})));}});e.exports=y;},null);
__d("StickerSearch",["StickerConfig","StickerImages","StickerServerRequests","StickerState","createObjectFrom","getObjectValues"],function(a,b,c,d,e,f,g,h,i,j,k,l){'use strict';var m=100,n=1000,o=10000,p=g.StickerTriggerThreshold,q,r,s,t=null,u={},v={requestStickersForTags:function(w,x,y,z){r=y;var aa=w,ba=x.length>1;if(ba)aa=aa.concat(x);h.requestStickersForTags(aa,function(){if(r===y)z(this._getSortedStickersForTags(w,x,y,ba));}.bind(this));},requestStickersForQuery:function(w,x){r=w;i.getStickersForQuery(w,function(y){return r===w&&x(y.payload);});},_getSortedStickersForTags:function(w,x,y,z){var aa={},ba=this._getTypeaheadStickers(w,y,aa),ca=l(ba);if(z){var da=this._getIntersectionStickers(x,aa);ca=ca.concat(da.filter(function(ea){return !ba.hasOwnProperty(ea.id);}));}ca.map(function(ea){return h.cacheSticker(ea);});ca.sort(function(ea,fa){return aa[fa.id]-aa[ea.id];});return ca;},_getTypeaheadStickers:function(w,x,y){var z={},aa=h.getStickerTagsData();q=k(j.getPackIDsInTray());w.forEach(function(ba){aa[ba.id].forEach(function(ca){var da=ca.score+m;if(q[ca.packID])da+=n;if(ba.name===x)da+=o;if(!z[ca.id]||da>y[ca.id]){z[ca.id]=ca;y[ca.id]=da;}});});return z;},_getIntersectionStickers:function(w,x){var y=h.getStickerTagsData(),z=w.map(function(ba){return y[ba.id].map(function(ca){return ca.id;});}),aa=y[w[0].id].filter(function(ba){x[ba.id]=ba.score;for(var ca=1;ca<z.length;ca++)if(z[ca].indexOf(ba.id)===-1){return false;}else x[ba.id]+=y[w[ca].id].score;return true;});return aa;},prepareTagsData:function(){if(!s)s=i.fetchTagData(function(w){t=w;t.map(function(x){return u[x.name]=x;});});return s;},findTagForInput:function(w,x){var y=w.match(/\w+/g),z=p,aa=null;for(var ba=0;y!==null&&ba<y.length;ba++)if(u[y[ba]]&&u[y[ba]].sticker_count>z){z=u[y[ba]].sticker_count;aa=y[ba];}if(aa){h.requestStickersForTags([u[aa]],function(){var ca=h.getStickerTagsData()[u[aa].id];x(ca,aa);});}else x([],null);},getTagByName:function(w){return u[w];},getTags:function(){return t;}};e.exports=v;},null);
__d("StickersFlyoutStickerSelector.react",["Grid.react","Image.react","LegacyScrollableArea.react","React","Sticker.react","StickerConstants","StickerImages","StickerSearch","StickerState","XUISpinner.react","areEqual","cx","emptyFunction","fbt","ix","throttle"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){'use strict';var w=g.GridItem,x=320,y=278,z=l.MRU_STICKER_PACK,aa=64,ba=44,ca=112,da=j.createClass({displayName:'StickersFlyoutStickerSelector',propTypes:{height:j.PropTypes.number,onScroll:j.PropTypes.func,packID:j.PropTypes.string,userInput:j.PropTypes.string,allTagsLoaded:j.PropTypes.bool,typeaheadTags:j.PropTypes.array,singleWordTags:j.PropTypes.array},getDefaultProps:function(){return {isComments:false,onScroll:s};},getInitialState:function(){return {loading:false,stickers:[]};},componentDidMount:function(){if(this.props.typeaheadTags||this.props.singleWordTags){this.requestStickersForTags(this.props.typeaheadTags,this.props.singleWordTags,this.props.userInput);}else this.requestStickersForPack(this.props.packID);},componentWillReceiveProps:function(ea){if(ea.packID!==this.props.packID)this.requestStickersForPack(ea.packID);if(!q(ea.typeaheadTags,this.props.typeaheadTags)||!q(ea.singleWordTags,this.props.singleWordTags)){this.requestStickersForTags(ea.typeaheadTags,ea.singleWordTags,ea.userInput);}else if(!ea.allTagsLoaded&&ea.userInput!==this.props.userInput)this.requestStickersForQuery(ea.userInput,ea.userInput);},getScaledDimensions:function(ea,fa){var ga,ha,ia;if(fa>ea){ia=aa/fa;ga=ea*ia;ha=fa*ia;}else{ia=aa/ea;ga=ea*ia;ha=fa*ia;}return {height:Math.round(ga),width:Math.round(ha)};},requestStickersForTags:function(ea,fa,ga){this.setState({loading:true});n.requestStickersForTags(ea,fa,ga,function(ha){if(this.props.isComments)ha=ha.filter(function(ia){return !ia.isMessengerOnly;});this.isMounted()&&this.setState({loading:false,stickers:ha.slice(0,40)});}.bind(this));},requestStickersForQuery:function(ea){this.setState({loading:true});n.requestStickersForQuery(ea,function(fa){this.isMounted()&&this.setState({loading:false,stickers:fa});}.bind(this));},requestStickersForPack:function(ea){this.setState({loading:true});m.requestStickersForPack(ea,aa,function(fa){if(ea==z){fa=o.getMRUStickerPack(fa);if(this.props.isComments)fa=fa.filter(function(ga){return !ga.isMessengerOnly;});}this.setState({loading:false,stickers:fa});}.bind(this));},renderStickers:function(){var ea=this.state.stickers.map(function(fa){var ga=this.getScaledDimensions(fa.height,fa.width);return (j.createElement(w,{key:fa.id},j.createElement(j.DOM.div,{className:"_5r8h",'data-id':fa.id},j.createElement(k,{animationTrigger:"hover",className:"_5r8i",frameCount:fa.frameCount,frameRate:fa.frameRate||83,framesPerCol:fa.framesPerCol,framesPerRow:fa.framesPerRow,sourceHeight:ga.height,sourceURI:fa.sourceURI,sourceWidth:ga.width,spriteURI:fa.spriteURI,paddedSpriteURI:fa.paddedSpriteURI,stickerID:fa.id,style:{cursor:'pointer'}}))));},this);return ea;},_onScroll:function(){var ea=this.refs.stickerScrollable;if(ea){var fa=ea.getArea().getScrollTop();this.props.onScroll(fa);}},render:function(){if(this.state.loading){return (j.createElement(j.DOM.div,{className:"_e0r"},j.createElement(p,{size:"large"})));}else if(this.state.stickers.length===0){var ea=(x-ba*2-ca)/2+"px";return (j.createElement(j.DOM.div,{className:"_5jdt",style:{marginTop:ea}},j.createElement(h,{src:u("/images/messaging/stickers/icons/sad_face.png")}),j.createElement(j.DOM.p,null,"No Stickers to Show")));}return (j.createElement(i,{ref:"stickerScrollable",height:this.props.height||x,onScroll:v(this._onScroll,200),width:y,fade:true},j.createElement(j.DOM.div,{className:"_5r8k"},j.createElement(g,{cols:4,fixed:true},this.renderStickers()))));}});e.exports=da;},null);
__d("XUIError",["Bootloader","CSS","DataStore","DOM","Event","JSXDOM","Parent","Promise","cx","getActiveElement","invariant","isNode","memoize","merge"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){'use strict';var u='XUIError',v='data-xui-error',w="_1tp7";k.listen(document.documentElement,'focusin',function(event){var ja=m.byClass(event.getTarget(),w);if(ja){fa(ja);}else ga();});k.listen(document.documentElement,'focusout',function(event){ga();});var x=s(function(){return new n(function(ja,ka){g.loadModules(["ContextualDialog","ContextualLayerAutoFlip","LayerRefocusOnHide","React","ReactDescriptor"],function(la,ma,na,oa,pa){var qa={ContextualDialog:la,ContextualLayerAutoFlip:ma,LayerRefocusOnHide:na,React:oa,ReactDescriptor:pa};ja(t(qa,y(qa)));});});});function y(ja){var ka=ja.ContextualDialog,la=ja.ContextualLayerAutoFlip,ma=ja.LayerRefocusOnHide,na=l.div({className:"_1tp8"}),oa=(l.div({className:"_53ij _1tp9"},l.div({className:"_1tpa"}),na)),pa=new ka({addedBehaviors:[la],theme:{wrapperClassName:"_1tpb",arrowDimensions:{offset:12,length:16}}},oa);pa.disableBehavior(ma);pa.shouldSetARIAProperties(false);pa.setPosition('right');return {dialog:pa,dialogBodyNode:oa,dialogMessageNode:na};}var z=null;function aa(ja,ka){i.set(ja,u,ka);}function ba(ja){return t({message:ja.getAttribute(v)},i.get(ja,u));}function ca(ja){i.remove(ja,u);}var da=false,ea=false;function fa(ja){x().done(function(ka){var la=ka.React,ma=ka.ReactDescriptor,na=ka.dialog,oa=ka.dialogMessageNode,pa=ba(ja),qa=pa.message,ra=ma.isValidDescriptor(qa);if(da&&!ra)la.unmountComponentAtNode(oa);if(ra){la.renderComponent(qa,oa);}else{q(typeof qa==='string'||r(qa));j.setContent(oa,qa);}da=ra;na.setContext(ja).show();z=ja;});ea=true;}function ga(){if(!ea)return;x().done(function(ja){var ka=ja.React,la=ja.dialog,ma=ja.dialogMessageNode;if(!z)return;if(da){ka.unmountComponentAtNode(ma);da=false;}la.hide();z=null;});}function ha(ja){if(j.contains(ja,p()))fa(ja);}var ia={set:function(ja){var ka=ja.target,la=ja.message;q(la!==null);h.addClass(ka,w);aa(ka,{message:la});ha(ka);},clear:function(ja){h.removeClass(ja,w);ja.removeAttribute(v);ca(ja);if(ja===z)ga();},updatePosition:function(){if(!ea)return;x().done(function(ja){var ka=ja.dialog;if(z)ka.updatePosition();});},__setReactError:function(ja,ka){var la=ka.message;q(la!==null);aa(ja,{message:la});ha(ja);},__clearReactError:function(ja){ca(ja);if(ja===z)ga();}};e.exports=ia;},null);
__d("XUIError.react",["React","ReactDescriptor","XUIError","cx","joinClasses","merge","onlyChild"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){'use strict';var n="_1tp7",o=g.createClass({displayName:'ReactXUIError',componentDidMount:function(){if(this.props.message!=null)i.__setReactError(this.getDOMNode(),{message:this.props.message});},componentDidUpdate:function(){if(this.props.message==null){i.__clearReactError(this.getDOMNode());}else i.__setReactError(this.getDOMNode(),{message:this.props.message});},componentWillUnmount:function(){i.__clearReactError(this.getDOMNode());},render:function(){var p=m(this.props.children);if(this.props.message!=null)p=h.cloneAndReplaceProps(p,l(p.props,{className:k(p.props.className,n)}));return p;}});e.exports=o;},null);
__d("StickersFlyoutTagSelector.react",["BanzaiLogger","Grid.react","LegacyScrollableArea.react","Parent","React","Image.react","StickersFlyoutStickerSelector.react","StickerSearch","Toggler","XUIButton.react","XUICloseButton.react","XUITextInput.react","cx","debounce","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u){'use strict';var v=h.GridItem,w=320,x=278,y=44,z=t(function(ba){if(!ba)return;g.log('StickersLoggerConfig',{event:'search_sticker',searchtoken:ba});},1000),aa=k.createClass({displayName:'StickersFlyoutTagSelector',propTypes:{allTagsLoaded:k.PropTypes.bool,tags:k.PropTypes.array},getInitialState:function(){return {input:'',isScrolling:false,tagChosen:false,typeaheadTags:[],singleWordTags:[]};},getDefaultProps:function(){return {tags:[],trigger:null,isComments:false};},componentDidMount:function(){var ba=j.byClass(this.getDOMNode(),'uiToggle');if(ba)this._togglerSub=o.listen('show',ba,function(){this.isMounted()&&this.focusInput();}.bind(this));this.focusInput();this.selectTrigger(this.props.trigger);},componentWillUnmount:function(){this._togglerSub&&this._togglerSub.unsubscribe();},componentWillReceiveProps:function(ba){this.selectTrigger(ba.trigger);},focusInput:function(){this.refs.inputField.focusInput&&this.refs.inputField.focusInput();},_inputChanged:function(ba){var ca=this._normalizeInput(ba.target.value);if(this.props.allTagsLoaded){z(ba.target.value);var da=this.props.tags.filter(function(ga){return ga.name.indexOf(ca)===0;}),ea=ca.split(/\s+/),fa=ea.map(function(ga){return n.getTagByName(ga);}).filter(function(ga){return ga!==undefined;});if(fa.length!==ea.length)fa=[];this.setState({input:ba.target.value,tagChosen:false,typeaheadTags:da,singleWordTags:fa,isScrolling:false});}else this.setState({input:ba.target.value,tagChosen:false,isScrolling:false});},_normalizeInput:function(ba){return ba.trim().replace(/\s+/,' ').toLowerCase();},_handleResetButtonClick:function(ba){ba.preventDefault();this.reset();},reset:function(){this.setState(this.getInitialState());},renderContentArea:function(){if(this.state.tagChosen||this._normalizeInput(this.state.input).length>1){return this.renderStickers();}else return this.renderTags();},render:function(){return (k.createElement(k.DOM.div,{className:(("_217a")+(this.state.isScrolling?' '+"_1hg1":''))},k.createElement(k.DOM.div,{className:"_5jdr"},k.createElement(k.DOM.span,{className:"_5jds"}),k.createElement(r,{onChange:this._inputChanged,ref:"inputField",placeholder:"Search Stickers",value:this.state.input}),k.createElement(q,{size:"small",onClick:this._handleResetButtonClick,className:((this.state.input.length===0?"hidden_elem":''))})),this.renderContentArea()));},_capitalizeWords:function(ba){var ca=ba.split(" ");for(var da=0;da<ca.length;da++){var ea=ca[da].charAt(0).toUpperCase();ca[da]=ea+ca[da].substr(1);}return ca.join(" ");},selectTag:function(ba){g.log('StickersLoggerConfig',{event:'select_tag',tagid:ba.id});this.setState({tagChosen:true,typeaheadTags:[ba],singleWordTags:[],input:this._capitalizeWords(ba.name)});this.focusInput();},selectTrigger:function(ba){if(ba!==null){var ca=n.getTagByName(ba);this.setState({tagChosen:true,typeaheadTags:[ca],singleWordTags:[],input:this._capitalizeWords(ca.name)});this.props.resetTrigger();}},_onScroll:function(ba){this.setState({isScrolling:ba});},renderStickers:function(){var ba=this._normalizeInput(this.state.input);return (k.createElement(m,{ref:"selector",height:w-y,userInput:ba,typeaheadTags:this.state.typeaheadTags,singleWordTags:this.state.singleWordTags,onScroll:this._onScroll,allTagsLoaded:this.props.allTagsLoaded,isComments:this.props.isComments}));},renderTags:function(){var ba=this.props.tags.filter(function(ca){return ca.is_featured&&ca.sourceURI!==null;}).sort(function(ca,da){return ca.order-da.order;}).map(function(ca,da){return k.createElement(v,{key:da},k.createElement(k.DOM.div,{className:(("_t5c")+(da<2?' '+"_1b27":'')+(da%2===0?' '+"_t5d":'')+(da%2!==0?' '+"_t5e":''))},k.createElement(p,{image:k.createElement(l,{src:ca.sourceURI}),label:ca.name,onClick:this.selectTag.bind(this,ca),className:"_5jdu",style:{background:'#'+ca.color_code},disabled:this._normalizeInput(this.state.input).length===1})));}.bind(this));return (k.createElement(i,{height:w-y,width:x-16,shadow:true,fade:true,className:"_5jei"},k.createElement(h,{spacing:"pas",cols:2,fixed:true,ref:"grid"},ba)));}});e.exports=aa;},null);
__d("StickersFlyout.react",["BanzaiLogger","Event","Keys","MessagesEmoticons.react","Parent","React","StickersFlyoutPackSelector.react","StickersFlyoutStickerSelector.react","StickerActions","StickerConstants","StickerConfig","StickersFlyoutTagSelector.react","StickerSearch","StickerState","SubscriptionsHandler","Toggler","XUISpinner.react","arrayContains","cx"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y){'use strict';var z=l.createClass({displayName:'StickersFlyout',propTypes:{isComments:l.PropTypes.bool,onStickerSelect:l.PropTypes.func.isRequired,onEmoticonSelect:l.PropTypes.func,onShown:l.PropTypes.func,onHidden:l.PropTypes.func,onEscKeyDown:l.PropTypes.func,onPackSelect:l.PropTypes.func,packID:l.PropTypes.string,shown:l.PropTypes.bool,trigger:l.PropTypes.string},getDefaultProps:function(){return {isComments:false,packID:t.getTrayPackID(),shown:false,trigger:null};},getInitialState:function(){return {allTagsLoaded:false,dataReady:false,numNewPacks:0,tags:[]};},componentDidMount:function(){if(q.LoadStickerEarly&&!this.state.dataReady)this.loadTrayData();var aa=k.byClass(this.getDOMNode(),'uiToggle');this._subscriptions=new u();if(aa){this._subscriptions.addSubscriptions(v.listen('show',aa,this._onShownWrapper),v.listen('hide',aa,this._onHidden));}else if(!q.LoadStickerEarly&&this.props.shown&&!this.state.dataReady)this.loadTrayData();this._subscriptions.addSubscriptions(h.listen(this.getDOMNode(),'keydown',this._onKeyDown),t.addListener(t.PACKS_CHANGED,this.packsUpdated),t.addListener(t.NUM_NEW_PACKS_CHANGED,function(ba){this.setState({numNewPacks:ba});}.bind(this)));},_onShownWrapper:function(){if(this.props.onShown){this.props.onShown(this._onShown);}else this._onShown();},_onShown:function(){g.log('StickersLoggerConfig',{event:'open_tray'});if(!q.LoadStickerEarly&&!this.state.dataReady)this.loadTrayData();if(q.SearchPackNotSticky&&this.props.packID==p.SEARCH_PACK_ID&&!this.refs.tagSelector.state.tagChosen){this.resetPackFromSearch();}else if(this.props.packID===p.SEARCH_PACK_ID)this.refs.tagSelector.focusInput();this.refs.packSelector.onFlyoutShown();},_onHidden:function(){this.resetTagSelector();this.props.onHidden&&this.props.onHidden();},resetPackFromSearch:function(){o.selectPack(t.getTrayPackID());},componentWillUnmount:function(){this._subscriptions.release();},componentWillReceiveProps:function(aa){if(!this.state.dataReady&&aa.shown)this.loadTrayData();},componentDidUpdate:function(aa){if(!aa.shown&&this.props.shown){this._onShown();}else if(aa.shown&&!this.props.shown)this._onHidden();if(this.props.packID&&this.props.packID!=aa.packID)g.log('StickersLoggerConfig',{event:'select_pack',packid:this.props.packID});},_onKeyDown:function(event){if(event.keyCode===i.ESC&&this.props.onEscKeyDown){this.props.onEscKeyDown();event.kill();}},resetTagSelector:function(){this.refs.tagSelector&&this.refs.tagSelector.reset();},loadTrayData:function(){t.onTrayDataReady(function(){var aa=t.getNumNewPacks();this.setState({dataReady:true,numNewPacks:aa,tags:s.getTags()||t.getFeaturedTags()});var ba=t.getPacksInTray()[0].id,ca=this.props.packID;if(!ca||!x(t.getPackIDsInTray(),ca))o.selectPack(ba);}.bind(this));s.prepareTagsData().then(function(){return this.setState({allTagsLoaded:true,tags:s.getTags()});}.bind(this));},loadPack:function(){if(!this.state.dataReady)return (l.createElement(l.DOM.div,{className:"_e0r"},l.createElement(w,{size:"large"})));if(this.props.packID==='emoticons')return (l.createElement(l.DOM.div,{className:"_5r8l",'data-id':this.props.packID},l.createElement(j,{onEmoticonSelect:this.props.onEmoticonSelect})));if(this.props.packID===p.SEARCH_PACK_ID&&q.WebStickerSearch)return (l.createElement(l.DOM.div,{className:"_5r8l"},l.createElement(r,{ref:"tagSelector",allTagsLoaded:this.state.allTagsLoaded,tags:this.state.tags,className:"fbStickersFlyoutTagSelector",trigger:this.props.trigger,resetTrigger:function(){return this.setProps({trigger:null});}.bind(this),isComments:this.props.isComments})));return (l.createElement(l.DOM.div,{className:"_5r8l",'data-id':this.props.packID},l.createElement(n,{ref:"selector",packID:this.props.packID,isComments:this.props.isComments})));},packsUpdated:function(){var aa=t.getPackIDsInTray();if(!x(aa,this.props.packID)){o.selectPack(aa[0]);return;}this.forceUpdate(null);},selectedSticker:function(event){var aa=k.byClass(event.target,"_5r8h");if(aa){var ba=aa.getAttribute('data-id');t.updateRecentlyUsed(ba);this.props.onStickerSelect(ba,event);t.clearShowStickerReplyNUX();}},render:function(){var aa=this.props.isComments?t.getPacksInCommentsTray():t.getPacksInTray();return (l.createElement(l.DOM.div,{className:"_5r8f"},l.createElement(l.DOM.div,{className:"_5r8e",tabIndex:"0"},l.createElement(m,{ref:"packSelector",numNewPacks:this.state.numNewPacks,onPackClick:this.props.onPackSelect,selectedPackID:this.props.packID,packs:aa,resetTagSelectorFunc:this.resetTagSelector})),l.createElement(l.DOM.div,{className:"_5r8m",onClick:this.selectedSticker},this.loadPack())));}});e.exports=z;},null);
__d("XStickerAssetControllerURIBuilder",["XControllerURIBuilder"],function(a,b,c,d,e,f){e.exports=b("XControllerURIBuilder").create("\/stickers\/asset\/",{sticker_id:{type:"Int",required:true},image_type:{type:"Enum"}});},null);
__d("XLinkshimLogControllerURIBuilder",["XControllerURIBuilder"],function(a,b,c,d,e,f){e.exports=b("XControllerURIBuilder").create("\/si\/ajax\/l\/render_linkshim_log\/",{u:{type:"String",required:true},h:{type:"String",required:true},render_verification:{type:"Bool"},enc:{type:"String"},d:{type:"String"}});},null);
__d("LinkshimHandler",["Event","LinkshimAsyncLink","LinkshimHandlerConfig","URI","XLinkshimLogControllerURIBuilder","shield"],function(a,b,c,d,e,f,g,h,i,j,k,l){var m={setUpLinkshimHandling:function(s){try{var u=j(s.getAttribute('href')),v=n(u);if(v&&o(u)){g.listen(s,'mouseover',l(h.swap,null,s,v));var w=q(u);g.listen(s,'click',function(){if(i.supports_meta_referrer){h.referrer_log(s,w,p(u).toString());}else h.swap(s,u);});}}catch(t){}}};function n(s){return s.getQueryData().u?new j(s.getQueryData().u):null;}function o(s){return s.getQueryData().hasOwnProperty('s');}function p(s){var t=s.getQueryData().hasOwnProperty('enc')?s.getQueryData().enc:'';return (new k()).setString('u',s.getQueryData().u).setString('h',s.getQueryData().h).setBool('render_verification',s.getQueryData().hasOwnProperty('render_verification')).setString('enc',t).getURI();}function q(s){var t;if(r()){t=j(s).addQueryData({render_verification:true});}else t=n(s);return t;}function r(){var s=i.render_verification_rate||0;return Math.floor(Math.random()*s+1)===s;}e.exports=m;},null);
__d("MercuryAttachmentRenderer",["MercuryAttachmentTemplates","MercuryAttachmentAudioClip.react","Bootloader","ChatAnimatedGifs","SyncRequest.react","CSS","MercuryConstants","DOM","Event","JSXDOM","MercuryAttachment","MercuryAttachmentType","MercuryAttachmentVideo.react","MercuryParticipants","ProgressBar","React","Sticker.react","StickerAssetType","Style","URI","UserAgent_DEPRECATED","cx","endsWith","invariant","tx","updatePhotoProgressBar","XStickerAssetControllerURIBuilder","OrionMercuryAttachment","MercuryMessages"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa,ga){"use strict";var ha=b('OrionMercuryAttachment').module,ia=b('MercuryMessages').get(),ja=aa.ie()<=8;function ka(na,oa){var pa=g[oa].build().setNodeContent('filename',na.name),qa=pa.getNode('link');qa.setAttribute('href',na.url);na.rel&&qa.setAttribute('rel',na.rel);l.addClass(pa.getRoot(),q.getAttachIconClass(na.icon_type));return pa;}function la(na,oa){var pa=g[oa].build().setNodeContent('filename',na.name);l.addClass(pa.getRoot(),q.getAttachIconClass(na.icon_type));return pa;}var ma={renderAttachment:function(na,oa,pa,qa,ra,sa){var ta=100,ua=na?160:400,va=null,wa=null,xa=m.MercurySupportedShareType;if(this.isErrorAttachment(oa))va=ma.renderError(oa);if(this.isShareAttachment(oa)&&oa.share_xhp)if(oa.share_data_type===xa.FB_BROWSE_QUERY||!na)wa=ma.renderShareXHP(oa,pa.id);if(this.isStickerAttachment(oa))wa=ma.renderSticker(oa,pa,na,sa);if(!wa&&this.isShareAttachment(oa)){var ya=oa.share_data_type;switch(ya){case xa.FB_PHOTO:wa=ma.renderPreview(oa,pa,qa,ra);break;case xa.FB_VIDEO:wa=ma.renderVideoThumb(oa);break;case xa.FB_MUSIC_ALBUM:case xa.FB_SONG:case xa.FB_PLAYLIST:case xa.FB_MUSICIAN:case xa.FB_RADIO_STATION:wa=ma.renderMusic(oa);break;case xa.EXTERNAL:case xa.FB_TEMPLATE:case xa.FB_SOCIAL_REPORT_PHOTO:wa=ma.renderExternalLink(oa);break;case xa.FB_COUPON:case xa.FB_EVENT:wa=ma.renderChatXHP(oa);break;case xa.FB_SOCIAL_RESOLUTION:case xa.FB_STATUS:wa=ma.renderSocialResolution(oa);break;case xa.FB_SYNC_REQUEST:wa=ma.renderSyncRequest(oa);break;case xa.FB_OPEN_GRAPH:wa=ma.renderOpenGraph(oa);break;case xa.FB_ORION:if(ha)wa=ma.renderOrionMercuryAttachment(oa);break;default:if(oa.name)wa=ma.renderShareLink(oa,pa&&pa.id,na);break;}}if(!wa&&oa.preview_loading)wa=ma.renderPreview(oa,pa,qa,ra);if(!wa&&this.isVideoAttachment(oa)){wa=n.create('div');v.renderComponent(ma.renderVideo(oa,na),wa);}if(!wa&&oa.preview_url)wa=ma.renderPreview(oa,pa,qa,ra);if(!wa&&this.isFileAttachment(oa))if(oa.metadata&&oa.metadata.type==m.MercuryAttachmentAudioClip){wa=n.create('div');var za=ma.renderAudioClip(oa,pa.message_id,ta,ua);v.renderComponent(za,wa);}else wa=na?ma.renderFileLink(oa):ma.renderExtendedFileLink(oa);return {error:va,content:wa,bubblePreferred:this.isBubblePreferred(oa)};},isBubblePreferred:function(na){return !this.isStickerAttachment(na)&&!this.isSyncRequestAttachment(na);},renderError:function(na){var oa=g[':fb:mercury:attachment:error'].build();n.appendContent(oa.getNode('error'),na.error_msg);return oa.getRoot();},renderSocialResolution:function(na){var oa=g[':fb:mercury:attachment:social-resolution'].build();oa.setNodeContent('post',na.share_xhp);return oa.getRoot();},renderChatXHP:function(na){var oa=g[':fb:mercury:attachment:social-resolution'].build();oa.setNodeContent('post',na.chat_xhp);return oa.getRoot();},renderOpenGraph:function(na){var oa=na.share_xhp.cloneNode(true);if(aa.firefox())y.set(oa,'minWidth','180px');return oa;},renderExternalLink:function(na){var oa=g[':fb:mercury:attachment:external-link'].build().setNodeContent('name',na.name);na.base_url&&oa.setNodeContent('shortLink',na.base_url);var pa=oa.getNode('preview'),qa=oa.getNode('image-link');qa.setAttribute('href',na.url);na.rel&&qa.setAttribute('rel',na.rel);if(na.preview_url){var ra=oa.getNode('preview-image'),sa=na.preview_url,ta=z(j.getRawUrlFromSafeUrl(sa));if(ca(ta.getPath(),'.gif')){sa=z('/animated.php').setSecure(true).setDomain('www.fbsbx.com').addQueryData('url',ta.toString());l.addClass(pa,"_dri");if(na.name&&na.name.__html==ta.toString())oa.setNodeContent('name','');}ra.setAttribute('src',sa);l.addClass(pa,na.preview_class);l.show(ra);}else{l.addClass(oa.getRoot(),'noMedia');l.hide(pa);}oa.getNode('name').setAttribute('href',na.url);d(['LinkshimHandler'],function(ua){ua.setUpLinkshimHandling(oa.getNode('name'));ua.setUpLinkshimHandling(oa.getNode('image-link'));});if(na.rel)oa.getNode('name').setAttribute('rel',na.rel);return oa.getRoot();},renderFileLink:function(na){var oa=null;if(na.url===''){oa=':fb:mercury:attachment:file-name';return la(na,oa).getRoot();}else{oa=':fb:mercury:attachment:file-link';return ka(na,oa).getRoot();}},renderAudioClip:function(na,oa,pa,qa){var ra=na.metadata.duration/1000,sa=200;if(pa&&qa)if(ra<5){sa=pa;}else sa=(1-Math.pow(10,(ra-5)/-30))*(qa-pa)+pa;return h({src:na.url,duration:na.metadata.duration/1000,showHelp:false,width:sa});},renderVideo:function(na,oa){var pa={height:na.preview_height,width:na.preview_width},qa=oa?{width:160,height:120}:{width:266,height:200};return s({duration:na.metadata.duration,name:na.name,size:qa,thumbnailSize:pa,thumbnail:na.thumbnail_url,videoID:na.metadata.fbid});},renderExtendedFileLink:function(na){var oa=null;if(na.url===''){oa=':fb:mercury:attachment:file-name';return la(na,oa).getRoot();}oa=':fb:mercury:attachment:extended-file-link';var pa=ka(na,oa);if(na.open_url){var qa=pa.getNode('openLinkContainer');l.show(qa);var ra=pa.getNode('openFile');ra.setAttribute('href',na.open_url);}var sa=pa.getNode('downloadFile');sa.setAttribute('href',na.url);na.rel&&sa.setAttribute('rel',na.rel);return pa.getRoot();},renderMusic:function(na){var oa=g[':fb:mercury:attachment:music'].build().setNodeContent('filename',na.name),pa=oa.getNode('link');pa.setAttribute('href',na.url);pa.setAttribute('target','_blank');na.rel&&pa.setAttribute('rel',na.rel);var qa=oa.getNode('image-link');qa.setAttribute('href',na.url);na.rel&&qa.setAttribute('rel',na.rel);var ra=oa.getNode('preview-image');ra.setAttribute('src',na.preview_url);l.show(ra);l.addClass(oa.getNode('icon_link'),'MercuryMusicIcon');return oa.getRoot();},renderSyncRequest:function(na){var oa=k(na.metadata),pa=n.create('div');v.renderComponent(oa,pa);return pa;},renderOrionMercuryAttachment:function(na){var oa=ha(na.metadata),pa=n.create('div');v.renderComponent(oa,pa);return pa;},resizeContain:function(na,oa){var pa=na.width/na.height,qa=oa.width/oa.height;if(qa<pa){return {width:Math.min(na.height*qa,oa.width),height:Math.min(na.height,oa.height)};}else return {width:Math.min(na.width,oa.width),height:Math.min(na.width/qa,oa.height)};},renderPreview:function(na,oa,pa,qa){var ra=g[':fb:mercury:attachment:preview'].build(),sa=ra.getNode('image-link');if(na){if(na.url){var ta=new z(na.url).getQueryData().uri;if(ta&&na.rel==='async'){sa.setAttribute('href',ta);sa.setAttribute('ajaxify',na.url);}else sa.setAttribute('href',na.url);}na.rel&&sa.setAttribute('rel',na.rel);var ua;if(na.preview_uploading){var va=ra.getNode('cancel-button-container');l.show(va);var wa=ra.getNode('cancel-button'),xa=o.listen(wa,'click',function(){na.upload_canceled(na.upload_id);l.hide(ra.getRoot());xa.remove();});na.on_success(function(event,eb){if(eb.upload_id==na.upload_id){l.hide(va);xa.remove();}});var ya=ra.getNode('progress-bar'),za=new u(ya),ab=ra.getNode('progress-bar-container');da(na.upload_id);na.on_progress(function(event,eb){if(eb.upload_id==na.upload_id){l.removeClass(ab,"_395w");l.show(ab);fa(za,eb.event);}});if(na.on_resizing_progress)na.on_resizing_progress(function(event,eb){if(eb.upload_id==na.upload_id){l.addClass(ab,"_395w");l.show(ab);za.setPosition(100*eb.event.written/eb.event.total);}});l.addClass(sa,"_57jm");if(pa>=176){ua='/images/photos/dots_large.png';}else if(pa>=86){ua='/images/photos/dots_medium.png';}else ua='/images/photos/dots_small.png';y.set(sa,'width',pa+'px');y.set(sa,'max-width',pa+'px');if(na.preview_width&&na.preview_height)y.set(sa,'padding-bottom',((na.preview_height/na.preview_width)*100)+'%');}else if(na.preview_loading){l.addClass(sa,"_5xdv");if(qa==='contain'&&na.preview_width&&na.preview_height){y.set(sa,'width',na.preview_width+'px');y.set(sa,'height',na.preview_height+'px');}if(qa==='cover'&&!ja)l.addClass(sa,"_55pj");}else if(na.metadata&&na.metadata.fbid){ua=z('/ajax/mercury/attachments/photo.php').addQueryData({fbid:na.metadata.fbid,request_user_id:na.metadata.pageid,mode:qa,width:pa,height:pa}).toString();var bb=sa.getAttribute('ajaxify');sa.removeAttribute('ajaxify');sa.removeAttribute('rel');o.listen(sa,'click',function(event){event.prevent();i.loadModules(["MessagesViewer"],function(eb){eb.bootstrapWithConfig({src:ua,endpoint:bb,fbid:na.metadata.fbid,dimensions:na.metadata.dimensions,disablePaging:oa&&oa.attachments.length==1},sa);});});}else ua=z(na.preview_url).addQueryData({mode:qa,width:pa,height:pa}).toString();var cb=ra.getNode('preview-image');if(ua){if(qa==='contain'&&na.preview_width&&na.preview_height){var db=ma.resizeContain({width:pa,height:pa},{width:na.preview_width,height:na.preview_height});cb.setAttribute('width',db.width);cb.setAttribute('height',db.height);}if(na.preview_uploading||(qa==='cover'&&!ja)){l.addClass(sa,"_55pj");y.set(sa,'backgroundImage','url('+ua+')');}else{cb.onload=function(){cb.removeAttribute('width');cb.removeAttribute('height');};cb.setAttribute('src',ua);}}if(oa)this.renderReportRespondLink(ra.getRoot(),na,oa.message_id);}return ra.getRoot();},renderShareLink:function(na,oa,pa){var qa=g[':fb:mercury:attachment:share-link'].build().setNodeContent('name',na.name),ra=qa.getNode('link');ra.setAttribute('href',na.url);na.rel&&ra.setAttribute('rel',na.rel);return qa.getRoot();},renderVideoThumb:function(na){var oa=g[':fb:mercury:attachment:video-thumb'].build(),pa=oa.getNode('thumb');pa.setAttribute('href',na.url);pa.setAttribute('rel',na.rel);var qa=n.find(oa.getRoot(),'img');qa.src=na.preview_url;return oa.getRoot();},renderShareXHP:function(na,oa){var pa=n.create('div');if(na){n.appendContent(pa,na.share_xhp);this.renderReportRespondLink(pa,na,oa);}return pa;},renderSticker:function(na,oa,pa,qa){var ra=pa?'chatScrolled/':'messengerScrolled/';ra+=oa.thread_id;var sa=n.create('div');l.addClass(sa,'stickerContainer');var ta=null;if(na.metadata.stickerID)ta=na.metadata.stickerID.toString();var ua=null;if(na.metadata.packID)ua=na.metadata.packID.toString();var va=new ga().setInt('sticker_id',ta),wa=null,xa=null;if(window.devicePixelRatio&&window.devicePixelRatio>1){xa=na.metadata.paddedSpriteURI2x;wa=na.metadata.spriteURI2x;}else{xa=na.metadata.paddedSpriteURI;wa=na.metadata.spriteURI;}var ya=w({animationTrigger:'hover',className:'mvs',frameCount:na.metadata.frameCount||1,frameRate:na.metadata.frameRate||83,framesPerCol:na.metadata.framesPerCol||1,framesPerRow:na.metadata.framesPerRow||1,onStickerClick:qa,packID:ua,paddedSpriteURI:xa,sourceHeight:na.metadata.height,sourceURI:va.setEnum('image_type',x.IMAGE).getURI().toString(),sourceWidth:na.metadata.width,spriteURI:wa,stickerID:ta,subscribedThreadID:ra});v.renderComponent(ya,sa);return sa;},renderReportRespondLink:function(na,oa,pa){if(!oa.is_social_report_attachment)return null;switch(oa.share_data_type){case m.MercurySupportedShareType.FB_PHOTO:break;case m.MercurySupportedShareType.FB_SOCIAL_REPORT_PHOTO:return null;default:return null;}var qa=null;if(pa)qa=ia.getMessagesFromIDs([pa])[0];if(!qa)return null;if(qa.author===t.user)return null;var ra=null;t.get(qa.author,function(sa){ra=n.create('a',{rel:'dialog-post',className:"_z6l",id:'respond-link',ajaxify:z('/ajax/report/social_resolution/post/').setQueryData({attachment_fbid:oa.attach_id,post_fbid:oa.shared_object_id,sender_id:t.getUserID(sa.id)}).toString()});n.setContent(ra,ea._("Respond to {name}'s request",{name:sa.name}));n.appendContent(na,ra);});},renderPhotoAttachments:function(na,oa,pa,qa){var ra=na.length;if(!ra)return null;var sa=p.div({className:"_55pk"});if(ra===1){var ta=ma.renderPreview(na[0],oa,pa,'contain');n.appendContent(sa,ta);return sa;}var ua=(ra==2||ra==4)?2:3,va=(pa-(ua-1)*qa)/ua,wa=Math.ceil(ra/ua),xa=wa*va+(wa-1)*qa,ya=(p.div({className:"_55pm",style:'padding-bottom: '+(xa/pa*100)+'%;'}));n.appendContent(sa,ya);for(var za=0;za<ra;++za){var ab=ma.renderPreview(na[za],oa,va,'cover'),bb=za%ua,cb=Math.floor(za/ua);l.addClass(ab,"_55pn");y.apply(ab,{width:(va/pa*100)+'%',left:((bb*(va+qa))/pa*100)+'%',top:((cb*(va+qa))/xa*100)+'%'});n.appendContent(ya,ab);}return sa;},isPhotoAttachment:function(na){return na.attach_type==r.PHOTO||(na.attach_type==r.FILE&&na.preview_url);},isVideoAttachment:function(na){return na.attach_type==r.VIDEO;},isShareAttachment:function(na){return na.attach_type==r.SHARE;},isFileAttachment:function(na){return na.attach_type==r.FILE;},isErrorAttachment:function(na){return na.attach_type==r.ERROR;},isStickerAttachment:function(na){return na.attach_type==r.STICKER;},isSyncRequestAttachment:function(na){var oa=m.MercurySupportedShareType;return this.isShareAttachment(na)&&na.share_data_type==oa.FB_SYNC_REQUEST;},booleanLexicographicComparator:function(na){return function(oa,pa){for(var qa=0;qa<na.length;++qa){var ra=na[qa](oa),sa=na[qa](pa);if(ra&&!sa){return -1;}else if(!ra&&sa)return 1;}return 0;};}};e.exports=ma;},null);
__d("DOMHyperlink",["Env","JSXDOM","TransformTextToDOMMixin","UntrustedLink","URI","URLScraper","isFacebookURI","copyProperties","cx"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){var p={MAX_ITEMS:40,match:function(q,r){var s=l.match(q);if(!s)return false;var t=q.indexOf(s),u=t+s.length;return {startIndex:t,endIndex:u,element:this._element(s,r)};},_element:function(q,r){var s=q,t=s.replace(/"/g,'%22');if(!(/^[a-z][a-z0-9\-+.]+:\/\//i.test(q)))t='http://'+t;if(!k.isValidURI(t))return s;var u=h.a({className:"_553k",href:t,target:"_blank",rel:"nofollow"},s);if(r&&!m(k(t)))u.onmousedown=function(v){j.bootstrap(this,g.lhsh,v);};return u;}};e.exports=n(p,i);},null);
__d("MercuryMessageRenderer",["DOM","DOMEmoji","DOMEmote","DOMHyperlink","JSXDOM","transformTextToDOM"],function(a,b,c,d,e,f,g,h,i,j,k,l){var m={formatMessageBody:function(p,q,r){var s=(p||'').replace(/\s+$/,'');if(!q)return o(s,false,r);var t=Object.keys(q).map(function(w){return window.parseInt(w);}).sort(function(w,x){return w-x;}),u=[],v=0;t.forEach(function(w){var x=s.slice(v,w);if(x)u.push(o(x,false,r));v=w+q[w].length;var y=s.slice(w,v);if(y)u.push(o(y,true,r));});if(v<s.length)u.push(o(s.slice(v),false,r));return u.length===0?null:u.length===1?u[0]:g.create('span',{},u);}};function n(p,q){var r=p.replace(/\r\n?/g,'\n').split(/\n{2,}/);return r.filter(function(s){return s.length;}).map(function(s){return k.p(null,q(s));});}function o(p,q,r){if(p.length===0&&!q)return null;var s=function(t){return l(t,[j.params(true),h,i]);};return (k.span({className:q?'highlight':null},r?n(p,s):s(p)));}e.exports=m;},null);
__d("MercuryAttachments.react",["MercuryAttachmentRenderer","DOM","Event","ImmutableObject","React","SubscriptionsHandler","arraySort","cx","emptyFunction","joinClasses"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){'use strict';var q=176,r=4,s=k.createClass({displayName:'MercuryAttachments',propTypes:{message:k.PropTypes.instanceOf(j).isRequired,attachments:k.PropTypes.array.isRequired,isChat:k.PropTypes.bool,onImageLoad:k.PropTypes.func,onStickerClick:k.PropTypes.func},getDefaultProps:function(){return {isChat:false,onImageLoad:o,onStickerClick:o};},componentDidMount:function(){this._subscriptionsHandler=new l();this.renderAttachments();},componentDidUpdate:function(){this.renderAttachments();},componentWillUnmount:function(){this._subscriptionsHandler.release();},render:function(){var t=this.props.attachments.filter(g.isPhotoAttachment).length>0;return (k.createElement(k.DOM.div,Object.assign({},this.props,{className:p(this.props.className,(("_5h9y")+(t?' '+"_zl6":'')))})));},renderAttachments:function(){var t=this.getDOMNode();h.empty(t);var u=this.props.message,v=m(this.props.attachments,g.booleanLexicographicComparator([g.isPhotoAttachment,g.isShareAttachment,g.isFileAttachment,g.isErrorAttachment])),w=g.renderPhotoAttachments(v.filter(g.isPhotoAttachment),u,q,r);w&&h.appendContent(t,w);for(var x=0;x<v.length;x++){var y=v[x];if(g.isPhotoAttachment(y))continue;var z=g.renderAttachment(this.props.isChat,y,u,null,null,this.props.onStickerClick);z.error&&h.appendContent(t,z.error);z.content&&h.appendContent(t,z.content);}h.scry(t,'img').forEach(function(aa){this._subscriptionsHandler.addSubscriptions(i.listen(aa,'load',function(){this.props.onImageLoad(aa);}.bind(this)));}.bind(this));}});e.exports=s;},null);
__d("MercuryLogMessageRenderer",["MercuryAttachmentRenderer","CSS","DOM","HovercardLink","MercuryLogMessageType","MercuryParticipants","React","Image.react","TooltipLink.react","cx","fbt","ix"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){var s={renderText:function(la,ma){switch(la.log_message_type){case k.SUBSCRIBE:u(la,ma);break;case k.UNSUBSCRIBE:z(la,ma);break;case k.VIDEO_CALL:aa(la,ma);break;case k.PHONE_CALL:ca(la,ma);break;case k.THREAD_NAME:da(la,ma);break;case k.THREAD_IMAGE:ea(la,ma);break;case k.WALLPAPER:fa(la,ma);break;case k.SERVER_ERROR:ga(la,ma);break;}},renderIcon:function(la){return (m.createElement(n,{className:t(la),src:r('images/spacer.gif')}));},renderLegacy:function(la,ma,na,oa){t(oa).split(' ').forEach(function(pa){return pa&&h.addClass(la,pa);});this.renderText(oa,function(pa){m.renderComponent(m.createElement(m.DOM.span,null,pa),ma);});this.renderAttachmentLegacy(na,oa);},renderAttachmentLegacy:function(la,ma){if(ma.log_message_type==k.THREAD_IMAGE){var na=ma.log_message_data.image;if(na){var oa=g.renderPreview(na.preview_url?na:null);i.setContent(la,oa);h.addClass(oa,"_z6a");h.show(la);}}}};e.exports=s;function t(la){var ma=la.log_message_type,na=la.log_message_data;return (("_5wzu")+(ma==k.SUBSCRIBE?' '+"_5wzj":'')+(ma==k.UNSUBSCRIBE?' '+"_5wzk":'')+(ma==k.THREAD_NAME?' '+"_5wzl":'')+(ma==k.THREAD_IMAGE?' '+"_5wzm":'')+(ma==k.VIDEO_CALL&&(na.answered||ka(la))?' '+"_5wzn":'')+(ma==k.VIDEO_CALL&&!(na.answered||ka(la))?' '+"_5wzo":'')+(ma==k.PHONE_CALL&&na.answered?' '+"_5wzp":'')+(ma==k.PHONE_CALL&&!na.answered?' '+"_5wzq":'')+(ma==k.SERVER_ERROR?' '+"_5wzr":''));}function u(la,ma){var na=ja(la.log_message_data.added_participants);switch(na.length){case 1:v(la,ma,na);break;case 2:w(la,ma,na);break;case 3:x(la,ma,na);break;default:y(la,ma,na);break;}}function v(la,ma,na){var oa=[la.author,na[0]];l.getMulti(oa,function(pa){if(la.author==l.user){ma(q._("You added {subscriber1}.",[q.param("subscriber1",ia(pa[na[0]]))]));}else if(na[0]==l.user){ma(q._("{actor} added you.",[q.param("actor",ia(pa[la.author]))]));}else ma(q._("{actor} added {subscriber1}.",[q.param("actor",ia(pa[la.author])),q.param("subscriber1",ia(pa[na[0]]))]));});}function w(la,ma,na){var oa=[la.author].concat(na);l.getMulti(oa,function(pa){if(la.author==l.user){ma(q._("You added {subscriber1} and {subscriber2}.",[q.param("subscriber1",ia(pa[na[0]])),q.param("subscriber2",ia(pa[na[1]]))]));}else if(na[0]==l.user){ma(q._("{actor} added you and {subscriber2}.",[q.param("actor",ia(pa[la.author])),q.param("subscriber2",ia(pa[na[1]]))]));}else ma(q._("{actor} added {subscriber1} and {subscriber2}.",[q.param("actor",ia(pa[la.author])),q.param("subscriber1",ia(pa[na[0]])),q.param("subscriber2",ia(pa[na[1]]))]));});}function x(la,ma,na){var oa=[la.author].concat(na);l.getMulti(oa,function(pa){if(la.author==l.user){ma(q._("You added {subscriber1}, {subscriber2} and {subscriber3}.",[q.param("subscriber1",ia(pa[na[0]])),q.param("subscriber2",ia(pa[na[1]])),q.param("subscriber3",ia(pa[na[2]]))]));}else if(na[0]==l.user){ma(q._("{actor} added you, {subscriber2} and {subscriber3}.",[q.param("actor",ia(pa[la.author])),q.param("subscriber2",ia(pa[na[1]])),q.param("subscriber3",ia(pa[na[2]]))]));}else ma(q._("{actor} added {subscriber1}, {subscriber2} and {subscriber3}.",[q.param("actor",ia(pa[la.author])),q.param("subscriber1",ia(pa[na[0]])),q.param("subscriber2",ia(pa[na[1]])),q.param("subscriber3",ia(pa[na[2]]))]));});}function y(la,ma,na){var oa=[la.author].concat(na);l.getMulti(oa,function(pa){function qa(sa){var ta=m.createElement(m.DOM.div,null,sa.map(function(ua){return m.createElement(m.DOM.div,null,ua.name);}));return (m.createElement(o,{alignH:"center",position:"above",tooltip:ta},q._("{num} more",[q.param("num",sa.length)])));}var ra=na.map(function(sa){return pa[sa];});if(la.author==l.user){ma(q._("You added {subscriber1}, {subscriber2} and {more_people}.",[q.param("subscriber1",ia(ra[0])),q.param("subscriber2",ia(ra[1])),q.param("more_people",qa(ra.slice(2)))]));}else if(na[0]==l.user){ma(q._("{actor} added you, {subscriber2} and {more_people}.",[q.param("actor",ia(pa[la.author])),q.param("subscriber2",ia(ra[1])),q.param("more_people",qa(ra.slice(2)))]));}else ma(q._("{actor} added {subscriber1}, {subscriber2} and {more_people}.",[q.param("actor",ia(pa[la.author])),q.param("subscriber1",ia(ra[0])),q.param("subscriber2",ia(ra[1])),q.param("more_people",qa(ra.slice(2)))]));});}function z(la,ma){var na=[la.author],oa=la.log_message_data.removed_participants,pa;if(oa.length===1){pa=oa[0];na.push(pa);}l.getMulti(na,function(qa){var ra=qa[la.author],sa=qa[pa];if(la.author==l.user){if(!pa||pa==la.author){ma("You left the conversation.");}else ma(q._("You removed {name} from the conversation.",[q.param("name",ia(sa))]));}else if(!pa||pa==la.author){ma(q._("{actor} left the conversation.",[q.param("actor",ia(ra))]));}else if(pa==l.user){ma(q._("{actor} removed you from the conversation.",[q.param("actor",ia(ra))]));}else ma(q._("{actor} removed {name} from the conversation.",[q.param("actor",ia(ra)),q.param("name",ia(sa))]));});}function aa(la,ma){if(ka(la)){ba(la,ma);return;}var na=la.log_message_data.caller,oa=la.log_message_data.callee,pa=[na,oa];l.getMulti(pa,function(qa){var ra=ha(qa[oa]);if(na==l.user){if(la.log_message_data.answered){ma(q._("You called {firstname}.",[q.param("firstname",ra)]));}else ma(q._("{firstname} missed a call from you.",[q.param("firstname",ra)]));}else{var sa=ha(qa[na]);if(la.log_message_data.answered){ma(q._("{firstname} called you.",[q.param("firstname",sa)]));}else ma(q._("You missed a call from {firstname}.",[q.param("firstname",sa)]));}});}function ba(la,ma){l.get(la.log_message_data.callee,function(na){var oa=ha(na);switch(la.log_message_data.event_name){case 'installing':ma(q._("{firstname} is setting up video calling...",[q.param("firstname",oa)]));break;case 'installed':ma(q._("{firstname} finished setting up video calling.",[q.param("firstname",oa)]));break;case 'install_canceled':ma("You canceled the video calling installation.");break;}});}function ca(la,ma){var na=la.log_message_data.caller,oa=la.log_message_data.callee,pa=[na,oa];l.getMulti(pa,function(qa){if(na==l.user){var ra=ha(qa[oa]);if(la.log_message_data.answered){ma(q._("You called {firstname}.",[q.param("firstname",ra)]));}else ma(q._("{firstname} missed a call from you.",[q.param("firstname",ra)]));}else{var sa=ha(qa[na]);if(la.log_message_data.answered){ma(q._("{firstname} called you.",[q.param("firstname",sa)]));}else ma(q._("You missed a call from {firstname}.",[q.param("firstname",sa)]));}});}function da(la,ma){var na=la.log_message_data.name;if(la.author==l.user){if(na){ma(q._("You named the conversation: {name}.",[q.param("name",m.createElement(m.DOM.span,{className:"_5wzs"},na))]));}else ma("You removed the conversation name.");}else l.get(la.author,function(oa){var pa=ia(oa);if(na){ma(q._("{actor} named the conversation: {name}.",[q.param("actor",pa),q.param("name",m.createElement(m.DOM.span,{className:"_5wzs"},na))]));}else ma(q._("{actor} removed the conversation name.",[q.param("actor",pa)]));});}function ea(la,ma){if(la.author==l.user){if(la.log_message_data.image){ma("You changed the conversation picture.");}else ma("You removed the conversation picture.");}else l.get(la.author,function(na){var oa=ia(na);if(la.log_message_data.image){ma(q._("{actor} changed the conversation picture.",[q.param("actor",oa)]));}else ma(q._("{actor} removed the conversation picture.",[q.param("actor",oa)]));});}function fa(la,ma){if(la.author==l.user){ma("You changed the wallpaper.");}else l.get(la.author,function(na){var oa=ia(na);ma(q._("{actor} changed the wallpaper.",[q.param("actor",oa)]));});}function ga(la,ma){ma("We were unable to fetch previous messages in this conversation.");}function ha(la){return ia(la,true);}function ia(la,ma){var na=la.fbid,oa=j.constructEndpoint({id:na});if(la.href)return (m.createElement(m.DOM.a,{className:"_5wzt",href:la.href,'data-hovercard':oa},ma?la.short_name:la.name));return la.name;}function ja(la){var ma=la.indexOf(l.user);if(ma>0){var na=la.filter(function(oa){return oa!==l.user;});return [l.user].concat(na);}return la;}function ka(la){return la.log_message_data.event_name==='installing'||la.log_message_data.event_name==='installed'||la.log_message_data.event_name==='install_canceled';}},null);
__d("MercuryTypingReceiver",["Arbiter","ChannelConstants","MercuryActionTypeConstants","MercuryConfig","MercuryParticipants","MercuryPayloadSource","TypingStates","mixInEventEmitter","setTimeoutAcrossTransitions","MercuryServerRequests","MercuryThreads"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){var p=b('MercuryServerRequests').get(),q=b('MercuryThreads').get(),r,s={},t=30000,u={};n(u,{'state-changed':true});function v(ba){var ca=s[ba]||{},da=Object.keys(ca);da.sort(function(ea,fa){return ca[ea]-ca[fa];});return da;}function w(){r=null;var ba=Date.now(),ca={},da=false;for(var ea in s){var fa=false;for(var ga in s[ea]||{})if(s[ea][ga]<ba-t){delete s[ea][ga];fa=true;}else da=true;if(fa)ca[ea]=v(ea);}for(var ha in ca){y(ca);break;}if(da)r=o(w,3000);}function x(ba,ca){if(ba in s)if(ca in s[ba]){delete s[ba][ca];z(ba);}}function y(ba){u.releaseHeldEventType('state-changed');u.emitAndHold('state-changed',ba);}function z(ba){var ca={};ca[ba]=v(ba);y(ca);}function aa(ba){var ca=j.MercuryFBIDGK?ba.thread_fbid:ba.thread;if(ca)return p.getClientThreadIDNow(ca);if(ba.type==='typ')return q.getThreadIdForUser(ba.from);return null;}g.subscribe([h.getArbiterType('typ'),h.getArbiterType('ttyp')],function(ba,ca){var da=ca.obj,ea=aa(da);if(ea){var fa=k.getIDForUser(da.from);if(da.st==m.TYPING){s[ea]=s[ea]||{};var ga=s[ea][fa];s[ea][fa]=Date.now();if(!r)r=o(w,3000);!ga&&z(ea);}else if(da.st==m.INACTIVE)x(ea,fa);}});p.subscribe('update-typing-state',function(ba,ca){var da=ca.payload_source;if(da!=l.CLIENT_CHANNEL_MESSAGE)return;var ea=ca.actions;if(!ea||!ea.length)return;var fa=i.USER_GENERATED_MESSAGE;ea.forEach(function(ga){if(ga.action_type==fa&&ga.author!=k.user)x(ga.thread_id,ga.author);});});e.exports=u;},null);
__d("MercuryIndicatorController",["ArbiterMixin","DOM","MercuryActionTypeConstants","MercuryDelayedRoger","MercuryMessageSourceTags","MercuryParticipants","MercuryRoger","MercuryTypingReceiver","arrayContains","copyProperties","formatDate","removeFromArray","tx","MercuryThreads"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){var t=b('MercuryThreads').get(),u=[];function v(w){this._threadID=w;this._canonicalUser=t.getCanonicalUserInThread(w);u.push(this);}p(v.prototype,g,{destroy:function(){r(u,this);},setLastMessage:function(w){this._lastMsg=w;this._handleStateChange();},_informStateChanged:function(w){if(w.activity=='none'&&this._currentActivity=='none')return;if(this._lastMsg&&l.isAuthor(this._lastMsg.author))w.self_authored=true;this._currentActivity=w.activity;this.inform('state-changed',w);},_notifySentFrom:function(){var w,x,y=this._lastMsg.location_text,z=this._lastMsg.source_tags||[];if(y){w=s._("Sent from {location}",{location:y});x='sentFromMobile';}else if(o(z,k.MESSENGER)){w=h.create('a',{href:'/mobile/messenger','class':'fcg',target:'_blank'},"Sent from Messenger");x='sentFromMobile';}else if(o(z,k.MOBILE)){w=h.create('a',{href:'/mobile','class':'fcg',target:'_blank'},"Sent from Mobile");x='sentFromMobile';}else if(o(z,k.EMAIL)){w="Sent from email";x='sentFromEmail';}else{this._informStateChanged({activity:'none'});return;}this._informStateChanged({activity:x,text:w});},_notifySeenTimestamp:function(w){var x=m.getSeenTimestamp(this._threadID,w[0])*.001,y=Date.now()*.001,z;if(x<y-518400){z='M j';}else if(x<y-86400){z='D g:ia';}else z='g:ia';this._informStateChanged({activity:'seen-timestamp',text:s._("Seen {timestamp}",{timestamp:q(x,z)})});},_checkNamesForCollision:function(w,x){var y=false;l.getMulti(w,function(z){function aa(da){if(typeof z[da]!=="undefined"){return z[da].short_name.toLowerCase();}else return da;}var ba=x.map(aa),ca=w.map(aa);y=ba.some(function(da){return ca.indexOf(da)!==ca.lastIndexOf(da);});});return y;},_notifySeenBy:function(w){var x=this._lastMsg,y=true;l.getMulti(w,function(z){y=false;if(this._lastMsg!=x)return;var aa=t.getThreadMetaNow(this._threadID),ba=aa?aa.participants.length:0,ca=w.length+(x.author!=l.user),da,ea=false,fa=false,ga=ba>2&&ca>=ba-1;if(!(ga)&&ba>0)fa=this._checkNamesForCollision(aa.participants,w);if(ga){da="Seen by everyone";}else if(w.length==1){da=s._("Seen by {user}",{user:z[w[0]].short_name});}else if(w.length==2){da=s._("Seen by {user1}, {user2}",{user1:z[w[0]].short_name,user2:z[w[1]].short_name});}else if(w.length==3){da=s._("Seen by {user1}, {user2}, {user3}",{user1:z[w[0]].short_name,user2:z[w[1]].short_name,user3:z[w[2]].short_name});}else if(w.length>3){var ha=Object.keys(z).length-2,ia=s._("{num} more",{num:ha}),ja=h.create('span',{className:'more'},ia);da=h.tx._("Seen by {user1}, {user2}, {=num more link}",{user1:z[w[0]].short_name,user2:z[w[1]].short_name,'=num more link':ja});ea=true;}ea=ea||fa;this._informStateChanged({activity:'seen-by',text:da,seenBy:w,hasNameCollision:fa,tooltip:ea});}.bind(this));y&&this._informStateChanged({activity:'none'});},_notifyTyping:function(w){var x=this._lastMsg,y=true;l.getMulti(w,function(z){y=false;if(this._lastMsg!=x)return;var aa=t.getThreadMetaNow(this._threadID),ba=aa?aa.participants.length:0,ca,da=false;if(ba>2&&w.length>=ba-1){ca="Everyone is typing...";}else if(w.length==1){ca=s._("{name} is typing...",{name:z[w[0]].short_name});}else if(w.length==2){ca=s._("{user1} and {user2} are typing...",{user1:z[w[0]].short_name,user2:z[w[1]].short_name});}else if(w.length==3){ca=s._("{user1}, {user2}, and {user3} are typing...",{user1:z[w[0]].short_name,user2:z[w[1]].short_name,user3:z[w[2]].short_name});}else if(w.length>3){var ea=Object.keys(z).length-2,fa=s._("{num} more",{num:ea}),ga=h.create('a',{href:'#'},fa);ca=h.tx._("{user1}, {user2}, and {=num more link} are typing...",{user1:z[w[0]].short_name,user2:z[w[1]].short_name,'=num more link':ga});da=true;}this._informStateChanged({activity:'typing',text:ca,typing:w,tooltip:da});}.bind(this));y&&this._informStateChanged({activity:'none'});},_handleStateChange:function(){var w=i.LOG_MESSAGE;if(!this._lastMsg||this._lastMsg.action_type==w){this._informStateChanged({activity:'none'});return;}if(this._typing&&this._typing.length){this._notifyTyping(this._typing);return;}if(this._canonicalUser&&this._lastMsg.author!=l.user){this._notifySentFrom();return;}var x=j.getSeenBy(this._threadID,true);if(x.length)if(this._canonicalUser){this._notifySeenTimestamp(x);return;}else{this._notifySeenBy(x);return;}this._informStateChanged({activity:'none'});}});n.addRetroactiveListener('state-changed',function(w){u.forEach(function(x){var y=w[x._threadID];if(y!==undefined){x._typing=y;x._handleStateChange();}});});j.subscribe('state-changed',function(w,x){u.forEach(function(y){x[y._threadID]&&y._handleStateChange();});});e.exports=v;},null);
__d("MercuryLastMessageIndicator.react",["DOM","MercuryIndicatorController","MercuryParticipants","ReactPropTypes","React","Tooltip","cx","emptyFunction","joinClasses","startsWith"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){var q=k.createClass({displayName:'MercuryLastMessageIndicator',propTypes:{hideTyping:j.bool,indicatorWillShow:j.func,indicatorDidShow:j.func,lastMessage:j.object,threadID:j.string.isRequired},getDefaultProps:function(){return {indicatorWillShow:n,indicatorDidShow:n};},getInitialState:function(){return {data:{}};},componentDidMount:function(){this._setup(this.props);},componentWillReceiveProps:function(r){if(r.threadID!=this.props.threadID){this._destroy();this._setup(r);}else if(r.lastMessage!=this.props.lastMessage)this._controller.setLastMessage(r.lastMessage);},componentWillUpdate:function(r,s){if(this.isVisible(r,s))this.props.indicatorWillShow();},componentDidUpdate:function(){if(!this.isVisible())return;this.setText();this.setTooltip();this.props.indicatorDidShow();},componentWillUnmount:function(){this._destroy();},render:function(){return (k.createElement(k.DOM.div,{className:this.getRootClass()},k.createElement(k.DOM.div,{className:"_510h"}),k.createElement(k.DOM.span,{className:"_510f",ref:"text"},"")));},getRootClass:function(){var r=(("_510g")+(this.state.data.self_authored?' '+"_510e":'')),s=this.state.data.activity,t=null;if(p(s,'seen')){t='seen';}else if(s=='typing'){t=this.props.hideTyping?null:s;}else t=s;return o(r,t,this.props.className);},isVisible:function(r,s){r=r||this.props;s=s||this.state;return (s.data&&s.data.activity!='none'&&!(r.hideTyping&&s.data.activity=='typing'));},setText:function(){if(this.state.data.text)g.setContent(this.refs.text.getDOMNode(),this.state.data.text);},setTooltip:function(){if(this.state.data.activity=='seen-by'&&this.state.data.tooltip)i.getMulti(this.state.data.seenBy,function(r){var s=g.create('div',null,this.state.data.seenBy.map(function(t){return g.create('div',null,r[t].name);}));l.set(this.state.data.hasNameCollision?this.getDOMNode():g.find(this.getDOMNode(),'span.more'),s,'above','center');}.bind(this));},_setup:function(r){this._controller=new h(r.threadID);this._subscription=this._controller.subscribe('state-changed',function(s,t){return this.setState({data:t});}.bind(this));r.lastMessage&&this._controller.setLastMessage(r.lastMessage);},_destroy:function(){this._subscription.unsubscribe();this._controller.destroy();},setLastMessage:function(r){this.setProps({lastMessage:r});}});e.exports=q;},null);
__d("Token",["CSS","DataStore","DOM","Locale","UnicodeBidi","tx"],function(a,b,c,d,e,f,g,h,i,j,k,l){function m(n,o){"use strict";this.info=n;this.paramName=o;}m.prototype.getInfo=function(){"use strict";return this.info;};m.prototype.getText=function(){"use strict";return this.info.text;};m.prototype.getValue=function(){"use strict";return this.info.uid;};m.prototype.isFreeform=function(){"use strict";return !!this.info.freeform;};m.prototype.setSelected=function(n){"use strict";g.conditionClass(this.getElement(),'uiTokenSelected',n);return this;};m.prototype.getElement=function(){"use strict";if(!this.element)this.setElement(this.createElement());return this.element;};m.prototype.setElement=function(n){"use strict";h.set(n,'Token',this);this.element=n;return this;};m.prototype.isRemovable=function(){"use strict";return g.hasClass(this.element,'removable');};m.prototype.getTextDirection=function(){"use strict";var n=k.isDirectionRTL(this.getText()),o=j.isRTL();if(n&&!o)return 'rtl';if(!n&&o)return 'ltr';return null;};m.prototype.createElement=function(n,o){"use strict";var p=this.paramName,q=this.getText(),r=this.getValue(),s=i.create('a',{href:'#','aria-label':l._("Remove {item}",{item:q}),className:'remove uiCloseButton uiCloseButtonSmall'});if(n)g.addClass(s,'uiCloseButtonSmallGray');var t=i.create('input',{type:'hidden',value:r,name:p+'[]',autocomplete:'off'}),u=i.create('input',{type:'hidden',value:q,name:'text_'+p+'[]',autocomplete:'off'}),v={className:'removable uiToken'},w=this.getTextDirection();if(w!==null)v.dir=w;var x=i.create('span',v,[q,t,u,s]);if(n)g.addClass(x,'uiTokenGray');if(o){var y=i.create('i',{className:o});i.prependContent(x,y);}return x;};e.exports=m;},null);
__d("WeakToken",["CSS","Token"],function(a,b,c,d,e,f,g,h){for(var i in h)if(h.hasOwnProperty(i))k[i]=h[i];var j=h===null?null:h.prototype;k.prototype=Object.create(j);k.prototype.constructor=k;k.__superConstructor__=h;function k(){"use strict";if(h!==null)h.apply(this,arguments);}k.prototype.createElement=function(){"use strict";var l=j.createElement.call(this,true,'UFIWeakReferenceIcon');g.addClass(l,'uiTokenWeakReference');return l;};e.exports=k;},null);
__d("Tokenizer",["Arbiter","ArbiterMixin","CSS","DataStore","DOM","DOMQuery","Event","Focus","Input","Keys","Parent","StickyPlaceholderInput","Style","TextMetrics","Token","UserAgent_DEPRECATED","WeakToken","copyProperties","createObjectFrom","emptyFunction","mixin"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa){var ba=20,ca=aa(h);for(var da in ca)if(ca.hasOwnProperty(da))fa[da]=ca[da];var ea=ca===null?null:ca.prototype;fa.prototype=Object.create(ea);fa.prototype.constructor=fa;fa.__superConstructor__=ca;function fa(ga,ha){"use strict";this.element=ga;this.typeahead=ha;this.input=ha.getCore().getElement();j.set(this.element,'Tokenizer',this);}fa.prototype.init=function(ga,ha,ia,ja){"use strict";this.init=z;this.tokenarea=ga;this.paramName=ha;if(!this.placeholder)this.placeholder=this.input.getAttribute('data-placeholder')||'';x(this,ja||{});this.initEvents();this.initTypeahead();this.reset(ia);this.initBehaviors();setTimeout(this.adjustWidth.bind(this),0);g.inform('Tokenizer/init',this,g.BEHAVIOR_PERSISTENT);this.inform('init',{tokens:this.getTokens()});};fa.prototype.reset=function(ga){"use strict";this.tokens=[];this.unique={};if(ga){this.populate(ga);}else k.empty(this.tokenarea);this.updateTokenarea();};fa.prototype.populate=function(ga){"use strict";var ha=[];this.tokens=this.getTokenElements().map(function(ia,ja){var ka=ga[ja];ha.push(this._tokenKey(ka));return this.createToken(ka,ia);},this);this.unique=y(ha,this.tokens);};fa.prototype.getElement=function(){"use strict";return this.element;};fa.prototype.getTypeahead=function(){"use strict";return this.typeahead;};fa.prototype.getInput=function(){"use strict";return this.input;};fa.prototype.initBehaviors=function(){"use strict";this.behaviors=this.behaviors||[];if(this.behaviors instanceof Array){this.behaviors.forEach(function(ia){ia.behavior(this,ia.config);}.bind(this));}else for(var ga in (this.behaviors||{})){var ha=window.TokenizerBehaviors&&window.TokenizerBehaviors[ga];ha.call(null,this,this.behaviors[ga]);}};fa.prototype.initTypeahead=function(){"use strict";var ga=this.typeahead.getCore();ga.resetOnSelect=true;ga.setValueOnSelect=false;ga.preventFocusChangeOnTab=true;if(this.inline){var ha=this.typeahead.getView();i.addClass(ha.getElement(),'uiInlineTokenizerView');}this.typeahead.subscribe('select',function(ia,ja){var ka=ja.selected;if('uid' in ka){this.updateInput();this.addToken(this.createToken(ka));}}.bind(this));this.typeahead.subscribe('blur',this.handleBlur.bind(this));};fa.prototype.handleBlur=function(event){"use strict";this.inform('blur',{event:event});this.updatePlaceholder();};fa.prototype.initEvents=function(){"use strict";var ga=this.handleEvents.bind(this),ha=v.firefox()<4?'keypress':'keydown';m.listen(this.tokenarea,{click:ga,keydown:ga});m.listen(this.input,'paste',this.paste.bind(this));m.listen(this.input,ha,this.keydown.bind(this));};fa.prototype.handleEvents=function(event){"use strict";var ga=event.getTarget(),ha=ga&&this.getTokenElementFromTarget(ga);if(!ha)return;if(event.type!='keydown'||m.getKeyCode(event)==p.RETURN)this.processEvents(event,ga,ha);};fa.prototype.processEvents=function(event,ga,ha){"use strict";if(q.byClass(ga,'remove')){var ia=ha.nextSibling;ia=ia&&l.scry(ha.nextSibling,'.remove')[0];var ja=this.getTokenFromElement(ha);ja=this.addTokenData(ja,ga);this.removeToken(ja);this.focusOnTokenRemoval(event,ia);event.kill();}};fa.prototype.focusOnTokenRemoval=function(event,ga){"use strict";n.set(event.type=='keydown'&&ga||this.input);};fa.prototype.addTokenData=function(ga,ha){"use strict";return ga;};fa.prototype.keydown=function(event){"use strict";this.inform('keydown',{event:event});var ga=m.getKeyCode(event),ha=this.input;if(this.inline&&ga==p.BACKSPACE&&o.isEmpty(ha)){var ia=this.getLastToken();if(ia&&ia.isRemovable())this.removeToken(ia);}this.updateInput();};fa.prototype.paste=function(event){"use strict";this.inform('paste',{event:event});this.updateInput(true);};fa.prototype.focusInput=function(){"use strict";n.set(this.input);};fa.prototype.updateInput=function(ga){"use strict";if(!this.inline)return;setTimeout(function(){this.adjustWidth(this.input.value);if(ga)this.input.value=this.input.value;}.bind(this),20);r.setPlaceholderText(this.input,'');this.inform('resize');};fa.prototype.setPlaceholder=function(ga){"use strict";this.placeholder=ga;if(this.stickyPlaceholder)r.setPlaceholderText(this.input,ga);this.updatePlaceholder();};fa.prototype.updatePlaceholder=function(){"use strict";if(!this.inline||this.input.value)return;var ga=!this.tokens.length,ha='';if(ga||this.stickyPlaceholder){this.adjustWidth(this.placeholder);ha=this.placeholder;}else this.adjustWidth(this.input.value);r.setPlaceholderText(this.input,ha);};fa.prototype.adjustWidth=function(ga){"use strict";if(!this.inline||!this._getIsInDOM())return;if(!ga&&this.input.value==='')ga=this.placeholder;var ha=ba;if(ga!==this.placeholder||!this.getTokens().length||this.stickyPlaceholder){var ia=s.getFloat(this.getElement(),'width'),ja=this._getMetrics().measure(ga);ha=ja.width+this._getWidthOffset()+10;ha=(ha>=ia)?ia:ha;}s.set(this.input,'width',ha+'px');this.inform('resize');};fa.prototype.getToken=function(ga){"use strict";return this.unique[ga]||null;};fa.prototype.getTokens=function(){"use strict";return this.tokens||[];};fa.prototype.getTokenElements=function(){"use strict";return l.scry(this.tokenarea,'span.uiToken');};fa.prototype.getTokenElementFromTarget=function(ga){"use strict";return q.byClass(ga,'uiToken');};fa.prototype.getTokenFromElement=function(ga){"use strict";return j.get(ga,'Token');};fa.prototype.getTokenValues=function(){"use strict";if(!this.tokens)return [];return this.tokens.map(function(ga){return ga.getValue();});};fa.prototype.getFirstToken=function(){"use strict";return this.tokens[0]||null;};fa.prototype.getLastToken=function(){"use strict";return this.tokens[this.tokens.length-1]||null;};fa.prototype.hasMaxTokens=function(){"use strict";return this.maxTokens&&this.maxTokens<=this.tokens.length;};fa.prototype.createToken=function(ga,ha){"use strict";var ia=this.getToken(this._tokenKey(ga));if(!ia)ia=ga.weak_reference?new w(ga,this.paramName):new u(ga,this.paramName);ha&&ia.setElement(ha);return ia;};fa.prototype.addToken=function(ga){"use strict";if(this.hasMaxTokens())return;var ha=this._tokenKey(ga.getInfo());if(ha in this.unique)return;this.unique[ha]=ga;this.tokens.push(ga);this.insertToken(ga);this.updateTokenarea();this.inform('addToken',ga);this.inform('changeTokens');g.inform('Form/change',{node:this.element});};fa.prototype.insertToken=function(ga){"use strict";k.appendContent(this.tokenarea,ga.getElement());};fa.prototype.removeToken=function(ga){"use strict";if(!ga)return;var ha=this.tokens.indexOf(ga);if(ha<0)return;this.tokens.splice(this.tokens.indexOf(ga),1);delete this.unique[this._tokenKey(ga.getInfo())];k.remove(ga.getElement());this.updateTokenarea();this.inform('removeToken',ga);this.inform('changeTokens');g.inform('Form/change',{node:this.element});};fa.prototype.removeAllTokens=function(){"use strict";this.reset();this.inform('changeTokens');this.inform('removeAllTokens');};fa.prototype.updateTokenarea=function(){"use strict";var ga=this.typeahead.getCore(),ha=this.getTokenValues();if(this.excludeDuplicates){this._exclusions||(this._exclusions=ga.getExclusions());ga.setExclusions(ha.concat(this._exclusions));}ga.setEnabled(!this.hasMaxTokens());this.updateTokenareaVisibility();this.updatePlaceholder();this.inform('resize');};fa.prototype.updateTokenareaVisibility=function(){"use strict";i.conditionShow(this.tokenarea,this.tokens.length!==0);};fa.prototype._tokenKey=function(ga){"use strict";return ga.uid+(ga.freeform?':':'');};fa.prototype._getWidthOffset=function(){"use strict";if(this._widthOffset===null){var ga=this.input.clientWidth,ha=s.getFloat(this.input,'width');if(ga==ha){this._widthOffset=s.getFloat(this.input,'paddingLeft')+s.getFloat(this.input,'paddingRight');}else this._widthOffset=0;}return this._widthOffset;};fa.prototype._getMetrics=function(){"use strict";if(!this._metrics)this._metrics=new t(this.input,this.inline);return this._metrics;};fa.prototype._getIsInDOM=function(){"use strict";return this._isInDOM||(this._isInDOM=l.contains(document.body,this.input));};fa.getInstance=function(ga){"use strict";var ha=q.byClass(ga,'uiTokenizer');return ha?j.get(ha,'Tokenizer'):null;};fa.init=function(ga,ha){"use strict";ga.init(ha.tokenarea,ha.param_name,ha.initial_info,ha.options);};x(fa.prototype,{inline:false,maxTokens:null,excludeDuplicates:true,placeholder:'',_widthOffset:null,_metrics:null});e.exports=fa;},null);
__d("MercuryTypeahead",["Event","ArbiterMixin","DOM","DOMDimensions","Input","Keys","MercuryTypeaheadTemplates","Tokenizer","Typeahead","TypeaheadCore","copyProperties","cx"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){var s=function(t,u){this._domElement=null;this._typeahead=null;this._tokenizer=null;this._placeholder='';this._exclusions=[];this._viewNodeOrID=null;this._viewOptions={renderer:'compact',autoSelect:true};this._tokenizerBehaviors=[];this._heightPrev=null;this._dataSource=t;this._view=u;};q(s.prototype,h);q(s.prototype,{setPlaceholder:function(t){this._placeholder=t;return this;},setExcludedParticipantsFromThreadMeta:function(t){if(!t)return;if(!t.former_participants){this.setExcludedParticipants(t.participants);return;}var u=t.former_participants.filter(function(v){return v.is_friend===false;}).map(function(v){return v.id;});this.setExcludedParticipants(u.concat(t.participants));},setExcludedParticipants:function(t){this._exclusions=[];t.forEach(function(u){var v=u.indexOf(':');if(u.substr(0,v)=='fbid')this._exclusions.push(u.substr(v+1));}.bind(this));return this;},setViewNodeID:function(t){this._viewNodeOrID=t;},setViewNode:function(t){this._viewNodeOrID=t;},setFullWidthView:function(t){var u=i.create('div',{className:"_4ck uiTypeaheadView"});i.setContent(t,u);this.setViewNode(u);},setViewOption:function(t,u){this._viewOptions[t]=u;},addTokenizerBehavior:function(t){this._tokenizerBehaviors.push(t);},build:function(t){if(this._domElement)return;var u=m[':fb:mercury:tokenizer'].build(),v=m[':fb:mercury:typeahead'].build();this._domElement=u.getRoot();i.appendContent(this._domElement,v.getRoot());var w=v.getNode('textfield');k.setPlaceholder(w,this._placeholder);w.setAttribute('data-placeholder',this._placeholder);this._input=w;var x={node_id:this._viewNodeOrID,ctor:this._view,options:this._viewOptions},y={ctor:p,options:{setValueOnSelect:true}};this._typeahead=new o(this._dataSource,x,y,v.getRoot());this._typeahead.init();var z={inline:true,behaviors:this._tokenizerBehaviors};this._tokenizer=new n(this._domElement,this._typeahead);this._tokenizer.init(u.getNode('tokenarea'),'participants',[],z);this._tokenizer.subscribe(['addToken','removeToken','removeAllTokens'],this._tokensChanged.bind(this));this._tokenizer.subscribe('resize',function(){this.inform('resize');}.bind(this));g.listen(w,'focus',function(){this._resetDataSource();this._typeahead.init();}.bind(this));g.listen(this._domElement,'click',this.focus.bind(this));g.listen(w,'keydown',this.keydown.bind(this));this._heightPrev=j.getElementDimensions(this._domElement).height;},getElement:function(){return this._domElement;},getSelectedParticipantIDs:function(){var t=[];if(this._tokenizer)(this._tokenizer.getTokenValues()||[]).forEach(function(u){t.push('fbid:'+u);});return t;},getTokens:function(){var t=[];if(this._tokenizer)t=this._tokenizer.getTokens();return t;},getTokenizer:function(){return this._tokenizer;},keydown:function(event){if(this._tokenizer.inline&&event.keyCode==l.ESC){if(k.isEmpty(this._input)){var t=this._tokenizer.getLastToken();if(t&&t.isRemovable())this._tokenizer.removeToken(t);}else this._typeahead.getCore().reset();return false;}if(k.isEmpty(this._input)&&this._tokenizer.inline&&event.keyCode===l.RETURN){event.preventDefault();return this.inform('tokens-return');}},reset:function(){this._tokenizer&&this._tokenizer.removeAllTokens();this._typeahead&&this._typeahead.getCore().reset();},focus:function(){this._tokenizer&&this._tokenizer.focusInput();},getTypeahead:function(){return this._typeahead;},_resetDataSource:function(){this._dataSource.setExclusions(this._exclusions);},_tokensChanged:function(){this.inform('tokens-changed');}});e.exports=s;},null);
__d("MercuryReadOnlyReason",["React","fbt"],function(a,b,c,d,e,f,g,h){var i={getReason:function(j){if(j.has_email_participant){return (h._("Sorry, this conversation isn't active anymore because messages can no longer be sent to email addresses. Messages sent to facebook.com email addresses will now be forwarded to primary email addresses, so you can continue this conversation over email. {Learn more}.",[h.param("Learn more",g.createElement(g.DOM.a,{href:"/help/224049364288051"},"Learn more"))]));}else return ("You cannot reply to this conversation.");},getEarlyWarning:function(j){if(!j.has_email_participant)return null;return (h._("We're sorry, but soon you won't be able to reply to this conversation because it includes email addresses. Please message these people through their Facebook accounts or switch over to your email account to keep this conversation going. {Learn more}.",[h.param("Learn more",g.createElement(g.DOM.a,{href:"/help/703286543026907"},"Learn more"))]));}};e.exports=i;},null);
__d("MercurySheetPolicy",[],function(a,b,c,d,e,f){var g={canReplaceOpenSheet:function(h,i){if(h.isSheetWithInput&&h.isSheetWithInput())return i.getType()!=h.getType()&&i.isSheetWithInput&&i.isSheetWithInput();if(h.getType()==i.getType())return false;if(h.isPermanent()&&!i.isPermanent())return false;return true;}};e.exports=g;},null);
__d("MercurySheetView",["Animation","ArbiterMixin","MercurySheetPolicy","CSS","DOM","Style","MercurySheetTemplates","Vector","copyProperties","cx","setTimeoutAcrossTransitions"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){var r=5000,s=function(t,u,v){this._threadID=t;this._rootElement=u;this._tabMainElement=v;this._openSheet=null;};o(s.prototype,h,{destroy:function(){k.empty(this._rootElement);},_openCommon:function(t,u){if(this._openSheet&&!i.canReplaceOpenSheet(this._openSheet,t)){if(t.couldNotReplace)t.couldNotReplace();return;}this.clear(function(){this._openSheet=t;var v=m[':fb:mercury:tab-sheet:loading'].build().getRoot();k.setContent(this._rootElement,v);j.show(v);j.show(this._rootElement);t.render();if(u){j.addClass(this._tabMainElement,'sheetSlide');j.addClass(this._tabMainElement,"_1sk4");var w=n.getElementDimensions(this._rootElement).y;l.set(this._rootElement,'bottom',w+'px');this.resize();this._animation=new g(this._rootElement).to('bottom',0).duration(150).ease(g.ease.both).ondone(function(){j.removeClass(this._tabMainElement,'sheetSlide');j.removeClass(this._tabMainElement,"_1sk4");this.resize();}.bind(this)).go();}else this.resize();if(!t.isPermanent()){var x=r;if(t.getCloseTimeout)x=t.getCloseTimeout();var y=this.getAutoCloseCallback(t);this._sheetCloseHandler=q(this.close.bind(this,t,y),x);if(t.timeoutCanBeReset)t.setResetTimeoutCallback(this.resetTimeout.bind(this));}}.bind(this));},getAutoCloseCallback:function(t){if(!t.autoCloseCallback)return null;return t.autoCloseCallback.bind(t);},resetTimeout:function(t,u){clearTimeout(this._sheetCloseHandler);var v=this.getAutoCloseCallback(t);this._sheetCloseHandler=q(this.close.bind(this,t,v),u);},set:function(t){return this._openCommon(t,false);},open:function(t){return this._openCommon(t,true);},close:function(t,u){if(this._openSheet!=t)return;if(!this._openSheet){u&&u();return;}if(this._animation)this._animation.stop();if(this._sheetCloseHandler){clearTimeout(this._sheetCloseHandler);this._sheetCloseHandler=null;}j.addClass(this._tabMainElement,'sheetSlide');j.addClass(this._tabMainElement,"_1sk4");var v=n.getElementDimensions(this._rootElement).y;this.resize();this._animation=new g(this._rootElement).to('bottom',v+'px').duration(100).ease(g.ease.begin).ondone(function(){k.empty(this._rootElement);j.hide(this._rootElement);j.removeClass(this._tabMainElement,'sheetSlide');j.removeClass(this._tabMainElement,"_1sk4");this._openSheet=null;this.resize();u&&u();}.bind(this)).go();},clear:function(t){this.close(this._openSheet,t);},resize:function(){this.inform('resize');}});e.exports=s;},null);
__d("MessagesEmoticonView",["DOM","EmoticonsList","Event","Focus","InputSelection","Keys","Parent","SubscriptionsHandler","TextAreaControl","Toggler","UserAgent_DEPRECATED","copyProperties","cx","endsWith","startsWith"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u){var v=h.symbols;function w(z){return m.byClass(z,"_5r8h");}function x(z,aa,ba,ca){var da=m.byClass(z,'emoticon');if(!da)return;var ea='emoticon_',fa=null;da.className.split(' ').forEach(function(ma){if(u(ma,ea))fa=ma.substring(ea.length);});if(!v[fa])return;if(!ca)return true;var ga=o.getInstance(aa),ha=ga.getValue(),ia=v[fa],ja=ha.substring(0,ba.start),ka=ha.substring(ba.end);if(ba.start>0&&!t(ja,' '))ia=' '+ia;if(!u(ka,' '))ia+=' ';var la=ja+ia+ka;ba.start+=ia.length;ba.end=ba.start;ga.setValue(la);k.set(aa,ba.start,ba.end);return true;}function y(z,aa){var ba={start:0,end:0};function ca(){ba=k.get(aa);}var da=g.find(z,'.uiToggleFlyout');this._subscriptions=new n();this._subscriptions.addSubscriptions(p.subscribe('show',function(ea,fa){if(fa.active&&g.contains(z,fa.active)){k.set(aa,ba.start,ba.end);var ga=g.scry(da,'a.emoticon')[0];ga&&j.setWithoutOutline(ga);}}),i.listen(da,'click',function(event){var ea=x(event.getTarget(),aa,ba,true);ea&&p.hide(z);}),i.listen(da,'keyup',function(event){if(event.keyCode===l.ESC){p.hide(z);k.set(aa,ba.start,ba.end);}}),i.listen(aa,'keyup',ca),i.listen(aa,'click',ca));if(q.chrome()||q.ie()||q.opera())this._subscriptions.addSubscriptions(i.listen(da,'mousedown',function(event){var ea=i.listen(document.documentElement,'click',function(event){var fa=event.getTarget(),ga=x(fa,aa,ba,false),ha=w(fa);!ga&&!ha&&p.show(z);ea.remove();});}.bind(this)));}r(y.prototype,{destroy:function(){this._subscriptions&&this._subscriptions.release();this._subscriptions=null;}});r(y,{create:function(z,aa){return new y(z,aa);}});e.exports=y;},null);
__d("PhotosUploadWaterfall",["AsyncSignal","Banzai","PhotosUploadWaterfallXConfig","randomInt"],function(a,b,c,d,e,f,g,h,i,j){var k={APP_FLASH:'flash_pro',APP_SIMPLE:'simple',APP_ARCHIVE:'archive',APP_COMPOSER:'composer',APP_MESSENGER:'messenger',APP_HTML5:'html5',APP_CHAT:'chat',INSTALL_CANCEL:1,INSTALL_INSTALL:2,INSTALL_UPDATE:3,INSTALL_REINSTALL:4,INSTALL_PERMA_CANCEL:5,INSTALL_SILENT_SKIP:6,INSTALL_DOWNLOAD:7,CERROR_RESIZING_FAILED:6,CERROR_MARKER_EXTRACTION_FAILED:9,BEGIN:1,UPLOAD_START:4,ALL_UPLOADS_DONE:6,CLIENT_ERROR:7,RECOVERABLE_CLIENT_ERROR:12,IMAGES_SELECTED:9,UPGRADE_REQUIRED:11,VERSION:15,SELECT_START:18,SELECT_CANCELED:19,CANCEL:22,CANCEL_DURING_UPLOAD:83,ONE_RESIZING_START:2,ONE_UPLOAD_START:10,ONE_UPLOAD_DONE:29,ONE_RESIZING_DONE:34,PROGRESS_BAR_STOPPED:44,MISSED_BEAT:45,HEART_ATTACK:46,PUBLISH_START:100,PUBLISH_SUCCESS:101,PUBLISH_FAILURE:102,CLUSTERING_START:103,CLUSTERING_SUCCESS:104,CLUSTERING_FAILURE:105,POST_BUTTON_CLICKED:110,PHOTO_DELETED:114,PUBLISH_CLIENT_SUCCESS:115,PHOTO_ROTATED:117,SAVE_DRAFT_BUTTON_CLICKED:123,EDITABLE_PHOTO_FETCH_START:106,EDITABLE_PHOTO_FETCH_SUCCESS:107,EDITABLE_PHOTO_FETCH_FAILURE:108,EDITABLE_PHOTO_FETCH_DELAY:116,CANCEL_INDIVIDUAL_UPLOAD:109,MISSING_OVERLAY_NODE:118,PUBLISH_RETRY_FAILURE:119,MISSING_UPLOAD_STATE:120,SESSION_POSTED:72,POST_PUBLISHED:80,ONE_UPLOAD_CANCELED:81,ONE_UPLOAD_CANCELED_DURING_UPLOAD:82,RESIZER_AVAILABLE:20,OVERLAY_FIRST:61,ASYNC_AVAILABLE:63,FALLBACK_TO_FLASH:13,RETRY_UPLOAD:17,TAGGED_ALL_FACES:14,VAULT_IMAGES_SELECTED:62,VAULT_CREATE_POST_CANCEL:65,VAULT_SEND_IN_MESSAGE_CLICKED:66,VAULT_DELETE_CANCEL:68,VAULT_ADD_TO_ALBUM_CANCEL:74,VAULT_SHARE_IN_AN_ALBUM_CLICKED:76,VAULT_SHARE_OWN_TIMELINE_CLICKED:77,VAULT_SHARE_FRIENDS_TIMELINE_CLICKED:78,VAULT_SHARE_IN_A_GROUP_CLICKED:79,VAULT_SYNCED_PAGED_LINK_CLICKED:84,VAULTBOX:'vaultbox',GRID:'grid',SPOTLIGHT_VAULT_VIEWER:'spotlight_vault_viewer',REF_VAULT_NOTIFICATION:'vault_notification',_checkRequiredFields:function(l){},sendBanzai:function(l,m){this._checkRequiredFields(l);var n={};l.scuba_ints=l.scuba_ints||{};l.scuba_ints.client_time=Math.round(Date.now()/1000);if(i.retryBanzai){n.retry=true;l.scuba_ints.nonce=j(4294967296);}h.post(i.deprecatedBanzaiRoute,l,n);if(m)setTimeout(m,0);},sendSignal:function(l,m){this._checkRequiredFields(l);if(i.useBanzai){this.sendBanzai(l,m);}else{var n=new g('/ajax/photos/waterfall.php',{data:JSON.stringify(l)}).setHandler(m);if(i.timeout)n.setTimeout(10*1000);n.send();}}};e.exports=k;},null);
__d("ChatTabController",["Arbiter","ChatActivity","ChatConfig","ChatNewMessageHandler","ChatTabLRUManager","ChatTabMessagesView","ChatTabModel","ChatTabPolicy","ChatTabView","ChatTabViewSelector","JSLogger","MercuryConfig","MercuryParticipants","StickerState","Style","UserAgent_DEPRECATED","VideoCallCore","ChatTabPresence","ChatTypeaheadBehavior","MercuryThreadInformer","MercuryThreads","MercuryUnseenState"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w){b('ChatTabPresence');b('ChatTypeaheadBehavior');var x=b('MercuryThreadInformer').get(),y=b('MercuryThreads').get(),z=b('MercuryUnseenState').get(),aa=i.get('tab_auto_close_timeout')||7200000,ba=q.create('tab_controller');function ca(qa){y.changeThreadReadStatus(qa,true);da(qa);}function da(qa){z.markThreadSeen(qa);}function ea(qa,ra,sa){var ta=m.get().tabs;qa+=ra?1:-1;while(qa>=0&&qa<ta.length){var ua=ta[qa],va=o.get(ua.id);if(va&&va.isVisible()&&(!sa||ua.raised)){va.focus();return true;}qa+=ra?1:-1;}return false;}function fa(qa,ra){var sa=ra&&ra.getRightmostHiddenTab();if(sa===qa)return null;return sa;}function ga(){return Math.floor(Math.random()*2147483648).toString(16);}function ha(qa,ra,sa,ta){m.raiseTab(qa,true,sa);var ua=ra&&ra.getLeftmostVisibleTab(),va=ra&&ra.getTabsToShow();if(va&&!va[qa]&&ua){m.promoteThreadInPlaceOfThread(qa,ua,fa(qa,ra),true);}else m.setPromotedTab(qa);g.inform('chat/open-tab',qa);var wa=o.get(qa);wa&&wa.focus();}function ia(qa,ra,sa){var ta=sa.forceDrop();if(!m.getTab(qa))m.raiseTab(qa,false);if(ta)return;var ua=ra&&k.getLRUVisibleTab(ra),va=ra&&ra.getTabsToShow();if(va&&!va[qa]&&ua)m.promoteThreadInPlaceOfThread(qa,ua,fa(qa,ra));}function ja(qa,ra){var sa=m.indexOf(qa);m.closeTab(qa,ra);return sa;}function ka(qa,ra){j.subscribe('chat/new-message-from-server',function(za,ab){ia(ab.thread_id,qa,ra);});p.subscribe('selected',function(za,ab){ha(ab,qa);});g.subscribe('chat/tabs-order-changed',function(za,ab){m.changeShowingTabs(ab);});g.subscribe('page_transition',function(za,ab){m.closeFragileTabs();});g.subscribe('chat/close-all-tabs',function(){m.closeAllTabs();});if(i.get('chat_close_all_tabs_when_offline'))g.subscribe('chat-visibility/go-offline',function(){m.closeAllTabs();});o.subscribe('read',function(event,za){ca(za);});h.subscribe('idle',function(za,ab){if(ab>aa){var bb=m.get().tabs;bb.forEach(function(cb){var db=cb.id;y.getThreadMeta(db,function(eb){if(!eb.unread_count){ba.log('autoclose_idle_seen',{thread_id:db,idleness:ab});m.closeTab(db,'autoclose_idle_seen');}});});}});o.subscribe('nub-activated',function(za,ab){ha(ab,qa);});o.subscribe('lower-activated',function(za,ab){m.lowerTab(ab);var bb=o.get(ab);bb&&bb.focus();});o.subscribe('focus-tab',function(za,ab){var bb=m.getTab(ab);if(bb&&bb.raised)ha(ab,qa,bb.signatureID,true);});function sa(za,ab){w.showOutgoingCallDialog(ab.userID,ab.clickSource);m.lowerTab(ab.threadID);}o.subscribe('video-call-clicked',sa);l.subscribe('video-call-clicked',sa);l.subscribe('interaction-with-tab',function(za,ab){var bb=m.getTab(ab);bb&&bb.raised&&da(ab);});o.subscribe('closed-tab',function(za,ab){ba.log('close_view',{thread_id:ab});ja(ab,'close_view');return false;});o.subscribe('thread-deleted',function(za,ab){ba.log('close_thread_deleted',{thread_id:ab});ja(ab,'close_thread_deleted');return false;});o.subscribe('unsubscribed',function(za,ab){ba.log('close_view_unsubscribed',{thread_id:ab});ja(ab,'close_view_unsubscribed');return false;});o.subscribe('esc-pressed',function(za,ab){ba.log('close_esc',{thread_id:ab});var bb=ja(ab,'close_esc');setTimeout(function(){ea(bb-1,true,true)||ea(bb,false,true);},0);});p.subscribe('selector/close-tab',function(za,ab){ba.log('close_chat_from_selector',{thread_id:ab});ja(ab,'close_chat_from_selector');});x.subscribe('messages-received',function(za,ab){for(var bb in ab){var cb=ab[bb];for(var db=0;db<cb.length;db++){var eb=cb[db];if(eb.author!=s.user){if(!eb.is_unread){ba.log('message_already_read',{action_id:eb.action_id,thread_id:eb.thread_id});continue;}y.getThreadMeta(bb,function(fb){n.messageIsAllowed(fb,eb,function(){j.newMessage(bb,eb,qa);});});}}}});x.subscribe('thread-read-changed',function(za,ab){for(var bb in ab)if(!ab[bb].mark_as_read){ba.log('autoclose_marked_unread',{thread_id:bb});m.closeTab(bb,'autoclose_marked_unread');}});o.subscribe('tab-pressed',function(za,ab){return !ea(m.indexOf(ab.id),ab.shiftPressed);});g.subscribe(q.DUMP_EVENT,function(za,ab){ab.chat_controller={auto_close_timeout:aa};});this.openTab=function(za,ab){ha(za,ab,ga());};var ta,ua,va,wa=[],xa;if(t.shouldShowStickerSearchNUXTooltip()){ua=qa.getRightmostRaisedTab();if(ua){xa=o.get(ua);xa.showStickerSearchNUXTooltip();}else g.subscribeOnce('chat/open-tab',function(za,ab){xa=o.get(ab);xa.showStickerSearchNUXTooltip();});}else if(r.ShowOrionNUXTooltip){wa=qa.getRaisedVisibleTabs();for(var ya=0;ya<wa.length;ya++){va=o.get(wa[ya]);if(va.isOrionNUXEligible()){xa=va;break;}}if(xa){xa.showOrionNUXTooltip();}else ta=g.subscribe('chat/open-tab',function(za,ab){xa=o.get(ab);if(xa.isOrionNUXEligible()){g.unsubscribe(ta);xa.showOrionNUXTooltip();}});}}if(v.firefox()){var la=function(){return u.get(document.body,'overflowX')+' '+u.get(document.body,'overflowY');},ma=la(),na=function(){var qa=la();if(qa!==ma){ma=qa;g.inform('overflow-applied-to-body');}};if('MutationObserver' in window){var oa=new MutationObserver(na),pa={attributes:true,attributeFilter:['class','style']};oa.observe(document.documentElement,pa);}else document.documentElement.addEventListener('DOMAttrModified',function(event){if(event.getTarget()===document.documentElement&&(event.attrName==='class'||event.attrName==='style'))na();},false);}e.exports=ka;},null);
__d("MercuryStateCheck",["Arbiter","ChannelConstants","MercuryFolders","MessagingTag","URI","copyProperties","MercuryServerRequests"],function(a,b,c,d,e,f,g,h,i,j,k,l){var m=b('MercuryServerRequests').get(),n=l(new g(),{initialize:function(){g.subscribe(h.ON_INVALID_HISTORY,o);d(['ChannelConnection'],function(p){p.subscribe(p.CONNECTED,function(q,r){if(!r.init)o();});});}});function o(){var p;if(k.getRequestURI().getPath().search(/messages/)!==-1){p=i.getSupportedFolders();}else p=[j.INBOX];m.fetchMissedMessages(p);}n.initialize();e.exports=n;},null);
__d("MercuryThreadSearchUtils",["escapeRegex","TokenizeUtil"],function(a,b,c,d,e,f,g,h){var i={wordsInString:function(j){return (j||'').split(/\s+/).filter(function(k){return k.trim().length>0;});},anyMatchPredicate:function(j,k){for(var l=0;l<j.length;l++)if(k(j[l]))return true;return false;},allMatchPredicate:function(j,k){for(var l=0;l<j.length;l++)if(!k(j[l]))return false;return true;},queryWordMatchesAnyNameWord:function(j,k){var l=new RegExp('\\b'+g(j),'i');return this.anyMatchPredicate(k,function(m){var n=h.parse(m).flatValue;return l.test(n);});},queryMatchesName:function(j,k){var l=this.wordsInString(j),m=this.wordsInString(k);return this.allMatchPredicate(l,function(n){return this.queryWordMatchesAnyNameWord(n,m);}.bind(this));}};e.exports=i;},null);